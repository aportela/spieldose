import{default as spieldoseAPI}from"../api.js";import{mixinAPIError,mixinPagination,mixinLiveSearches,mixinNavigation,mixinAlbums,mixinArtists,mixinPlayer}from"../mixins.js";import{default as inputTypeAHead}from"./input-typeahead.js";import{default as pagination}from"./pagination";import{default as apiError}from"./api-error.js";const template=function(){return'\n        <div class="container is-fluid box is-marginless">\n        <p class="title is-1 has-text-centered">{{ $t("browseAlbums.labels.sectionName") }}</p>\n            <div v-if="! hasAPIErrors">\n                <div class="field has-addons">\n                    <div class="control is-expanded has-icons-left" v-bind:class="{ \'is-loading\': loading }">\n                        <spieldose-input-typeahead v-if="liveSearch" v-bind:loading="loading" v-bind:placeholder="$t(\'browseAlbums.inputs.albumNamePlaceholder\')" v-on:on-value-change="onTypeahead"></spieldose-input-typeahead>\n                        <input type="text" class="input" v-bind:placeholder="$t(\'browseAlbums.inputs.albumNamePlaceholder\')" v-else v-bind:disabled="loading" v-model.trim="nameFilter" v-on:keyup.enter="search();">\n                        <span class="icon is-small is-left">\n                            <i class="fas fa-search"></i>\n                        </span>\n                    </div>\n                    <p class="control">\n                        <a class="button is-default" v-on:click.prevent="advancedSearch = ! advancedSearch;">\n                            <span class="icon">\n                                <i v-if="advancedSearch" class="fas fa-search-minus" aria-hidden="true"></i>\n                                <i v-else="advancedSearch" class="fas fa-search-plus" aria-hidden="true"></i>\n                            </span>\n                            <span>{{ $t("browseAlbums.buttons.toggleAdvancedSearch") }}</span>\n                        </a>\n                    </p>\n                    <p class="control" v-if="! liveSearch">\n                        <a class="button is-info" v-on:click.prevent="search();">\n                            <span class="icon">\n                                <i class="fas fa-search" aria-hidden="true"></i>\n                            </span>\n                            <span>{{ $t("browseAlbums.buttons.search") }}</span>\n                        </a>\n                    </p>\n                </div>\n                <div class="field has-addons" v-if="advancedSearch">\n                    <p class="control has-icons-left">\n                        <input class="input" type="text" pattern="[0-9]*" v-bind:placeholder="$t(\'browseAlbums.inputs.yearPlaceholder\')" maxlength="4" v-bind:disabled="loading" v-on:keyup.enter="search(true);" v-model.number="filterByYear" >\n                        <span class="icon is-small is-left">\n                            <i class="fas fa-calendar"></i>\n                        </span>\n                    </p>\n                    <p class="control is-expanded has-icons-left">\n                        <input class="input" type="text" v-bind:placeholder="$t(\'browseAlbums.inputs.artistNamePlaceholder\')" v-bind:disabled="loading" v-on:keyup.enter="search(true);" v-model.trim="filterByArtist">\n                        <span class="icon is-small is-left">\n                            <i class="fas fa-user"></i>\n                        </span>\n                    </p>\n                    <p class="control">\n                        <a class="button is-info" v-on:click="search(true);">\n                            <span class="icon">\n                                <i class="fas fa-search" aria-hidden="true"></i>\n                            </span>\n                            <span>{{ $t("browseAlbums.buttons.search") }}</span>\n                        </a>\n                    </p>\n                </div>\n                <spieldose-pagination v-bind:loading="loading" v-bind:data="pager" v-on:pagination-changed="onPaginationChanged"></spieldose-pagination>\n                <div class="browse-album-item" v-for="album in albums" v-show="! loading">\n                    <a class="play-album" v-bind:title="$t(\'commonLabels.playThisAlbum\')" v-on:click.prevent="playAlbumTracks(album.name, album.artist, album.year);">\n                        <img class="album-thumbnail" v-bind:src="album.image | getAlbumImageUrl" v-on:error="album.image = null;">\n                        <i class="fas fa-play fa-4x"></i>\n                        <img class="vinyl no-cover" src="images/vinyl.png" />\n                    </a>\n                    <div class="album-info">\n                        <p class="album-name">{{ album.name }}</p>\n                        <p v-if="album.artist" class="artist-name">{{ $t("commonLabels.by") }} <a v-bind:title="$t(\'commonLabels.navigateToArtistPage\')" v-on:click.prevent="navigateToArtistPage(album.artist);">{{ album.artist }}</a><span v-show="album.year"> ({{ album.year }})</span></p>\n                        <p v-else class="artist-name">{{ $t("commonLabels.by") }} {{ $t("browseAlbums.labels.unknownArtist") }} <span v-show="album.year"> ({{ album.year }})</span></p>\n                    </div>\n                </div>\n                <div class="is-clearfix"></div>\n            </div>\n            <spieldose-api-error-component v-else v-bind:apiError="apiError"></spieldose-api-error-component>\n        </div>\n    '};export default{name:"spieldose-browse-albums",template:'\n        <div class="container is-fluid box is-marginless">\n        <p class="title is-1 has-text-centered">{{ $t("browseAlbums.labels.sectionName") }}</p>\n            <div v-if="! hasAPIErrors">\n                <div class="field has-addons">\n                    <div class="control is-expanded has-icons-left" v-bind:class="{ \'is-loading\': loading }">\n                        <spieldose-input-typeahead v-if="liveSearch" v-bind:loading="loading" v-bind:placeholder="$t(\'browseAlbums.inputs.albumNamePlaceholder\')" v-on:on-value-change="onTypeahead"></spieldose-input-typeahead>\n                        <input type="text" class="input" v-bind:placeholder="$t(\'browseAlbums.inputs.albumNamePlaceholder\')" v-else v-bind:disabled="loading" v-model.trim="nameFilter" v-on:keyup.enter="search();">\n                        <span class="icon is-small is-left">\n                            <i class="fas fa-search"></i>\n                        </span>\n                    </div>\n                    <p class="control">\n                        <a class="button is-default" v-on:click.prevent="advancedSearch = ! advancedSearch;">\n                            <span class="icon">\n                                <i v-if="advancedSearch" class="fas fa-search-minus" aria-hidden="true"></i>\n                                <i v-else="advancedSearch" class="fas fa-search-plus" aria-hidden="true"></i>\n                            </span>\n                            <span>{{ $t("browseAlbums.buttons.toggleAdvancedSearch") }}</span>\n                        </a>\n                    </p>\n                    <p class="control" v-if="! liveSearch">\n                        <a class="button is-info" v-on:click.prevent="search();">\n                            <span class="icon">\n                                <i class="fas fa-search" aria-hidden="true"></i>\n                            </span>\n                            <span>{{ $t("browseAlbums.buttons.search") }}</span>\n                        </a>\n                    </p>\n                </div>\n                <div class="field has-addons" v-if="advancedSearch">\n                    <p class="control has-icons-left">\n                        <input class="input" type="text" pattern="[0-9]*" v-bind:placeholder="$t(\'browseAlbums.inputs.yearPlaceholder\')" maxlength="4" v-bind:disabled="loading" v-on:keyup.enter="search(true);" v-model.number="filterByYear" >\n                        <span class="icon is-small is-left">\n                            <i class="fas fa-calendar"></i>\n                        </span>\n                    </p>\n                    <p class="control is-expanded has-icons-left">\n                        <input class="input" type="text" v-bind:placeholder="$t(\'browseAlbums.inputs.artistNamePlaceholder\')" v-bind:disabled="loading" v-on:keyup.enter="search(true);" v-model.trim="filterByArtist">\n                        <span class="icon is-small is-left">\n                            <i class="fas fa-user"></i>\n                        </span>\n                    </p>\n                    <p class="control">\n                        <a class="button is-info" v-on:click="search(true);">\n                            <span class="icon">\n                                <i class="fas fa-search" aria-hidden="true"></i>\n                            </span>\n                            <span>{{ $t("browseAlbums.buttons.search") }}</span>\n                        </a>\n                    </p>\n                </div>\n                <spieldose-pagination v-bind:loading="loading" v-bind:data="pager" v-on:pagination-changed="onPaginationChanged"></spieldose-pagination>\n                <div class="browse-album-item" v-for="album in albums" v-show="! loading">\n                    <a class="play-album" v-bind:title="$t(\'commonLabels.playThisAlbum\')" v-on:click.prevent="playAlbumTracks(album.name, album.artist, album.year);">\n                        <img class="album-thumbnail" v-bind:src="album.image | getAlbumImageUrl" v-on:error="album.image = null;">\n                        <i class="fas fa-play fa-4x"></i>\n                        <img class="vinyl no-cover" src="images/vinyl.png" />\n                    </a>\n                    <div class="album-info">\n                        <p class="album-name">{{ album.name }}</p>\n                        <p v-if="album.artist" class="artist-name">{{ $t("commonLabels.by") }} <a v-bind:title="$t(\'commonLabels.navigateToArtistPage\')" v-on:click.prevent="navigateToArtistPage(album.artist);">{{ album.artist }}</a><span v-show="album.year"> ({{ album.year }})</span></p>\n                        <p v-else class="artist-name">{{ $t("commonLabels.by") }} {{ $t("browseAlbums.labels.unknownArtist") }} <span v-show="album.year"> ({{ album.year }})</span></p>\n                    </div>\n                </div>\n                <div class="is-clearfix"></div>\n            </div>\n            <spieldose-api-error-component v-else v-bind:apiError="apiError"></spieldose-api-error-component>\n        </div>\n    ',mixins:[mixinAPIError,mixinPagination,mixinLiveSearches,mixinNavigation,mixinAlbums,mixinArtists,mixinPlayer],data:function(){return{loading:!1,nameFilter:null,albums:[],advancedSearch:!1,filterByArtist:null,filterByYear:null}},components:{"spieldose-input-typeahead":inputTypeAHead,"spieldose-pagination":pagination,"spieldose-api-error-component":apiError},methods:{onPaginationChanged:function(a){this.$router.push({name:"albumsPaged",params:{page:a}})},onTypeahead:function(a){this.nameFilter=a,this.search()},search:function(a){this.loading=!0,this.clearAPIErrors(),a&&(this.pager.actualPage=1),spieldoseAPI.album.search(this.nameFilter,this.filterByArtist,this.filterByYear,this.pager.actualPage,this.pager.resultsPage,(a=>{a.ok?(this.pager.actualPage=a.body.pagination.actualPage,this.pager.totalPages=a.body.pagination.totalPages,this.pager.totalResults=a.body.pagination.totalResults,a.body.albums&&a.body.albums.length>0?this.albums=a.body.albums:this.albums=[]):this.setAPIError(a.getApiErrorData()),this.loading=!1}))}}};
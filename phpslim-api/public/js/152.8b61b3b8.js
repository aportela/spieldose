"use strict";(globalThis["webpackChunkspieldose"]=globalThis["webpackChunkspieldose"]||[]).push([[152],{2719:(e,t,l)=>{l.d(t,{d:()=>u});var s=l(1809),a=l(8612),n=l.n(a),r=l(4958);const i=(0,r.n)(),o={namespace:"spieldose",storages:["local","cookie","session","memory"],storage:"local",expireDays:3650},u=(0,s.Q_)("currentPlaylist",{state:()=>({elements:[],shuffleIndexes:[],currentIndex:-1,elementsLastChangeTimestamp:null}),getters:{hasElements:e=>e.elements&&e.elements.length>0,getElements:e=>e.elements,elementCount:e=>e.elements?e.elements.length:0,getElementsLastChangeTimestamp:e=>e.elementsLastChangeTimestamp,getCurrentIndex:e=>i.getShuffle?e.shuffleIndexes[e.currentIndex]:e.currentIndex,getCurrentElement:e=>e.currentIndex>=0&&e.elements.length>0?e.elements[e.currentIndex]:null,getCurrentElementURL:e=>e.currentIndex>=0&&e.elements.length>0?e.elements[e.currentIndex].url:null,allowSkipPrevious:e=>e.currentIndex>0&&e.elements.length>0,allowSkipNext:e=>e.currentIndex>=0&&e.elements.length>0&&e.currentIndex<e.elements.length-1,allowPlay:e=>!0,allowPause:e=>!0,allowResume:e=>!0,allowStop:e=>!0},actions:{load(){const e=n()(o),t=e.get("currentPlaylistElements");t&&(this.elements=t);const l=e.get("shuffleIndexes");l&&(this.shuffleIndexes=l);const s=e.get("currentPlaylistElementIndex");s>=0&&(this.currentIndex=s)},saveCurrentElements(){const e=n()(o);e.set("currentPlaylistElements",this.elements),e.set("currentPlaylistElementIndex",this.currentIndex),e.set("shuffleIndexes",this.shuffleIndexes),this.elementsLastChangeTimestamp=Date.now()},saveElements(e){this.elements=e,this.shuffleIndexes=[...Array(e.length).keys()].sort((function(){return.5-Math.random()})),this.currentIndex=e&&e.length>0?0:-1,this.saveCurrentElements()},appendElements(e){this.elements=this.elements.concat(e),this.saveCurrentElements()},saveCurrentTrackIndex(e){this.currentIndex=e>=0?e:-1;const t=n()(o);t.set("currentPlaylistElementIndex",this.currentIndex)},skipPrevious(){this.saveCurrentTrackIndex(--this.currentIndex)},skipNext(){this.saveCurrentTrackIndex(++this.currentIndex)},clear(){this.elements=[],this.currentIndex=-1;const e=n()(o);e.set("currentPlaylistElements",[]),e.set(-1),this.elementsLastChangeTimestamp=Date.now()},setFavoriteTrack(e,t){const l=this.elements.findIndex((t=>t.track&&t.track.id==e));-1!==l&&(this.elements[l].track.favorited=t,this.saveCurrentElements())},unSetFavoriteTrack(e){const t=this.elements.findIndex((t=>t.track&&t.track.id==e));-1!==t&&(this.elements[t].track.favorited=null,this.saveCurrentElements())}}})},4958:(e,t,l)=>{l.d(t,{n:()=>r});var s=l(1809),a=l(1320);const n=(0,a.l)(),r=(0,s.Q_)("player",{state:()=>({repeatMode:null,shuffle:!1,element:null,hasPreviousUserInteractions:!1,originalAudioMotionAnalyzerSource:null}),getters:{getRepeatMode:e=>e.repeatMode,getShuffle:e=>e.shuffle,getElement:e=>e.element,getDuration:e=>e.element.duration},actions:{interact(){this.hasPreviousUserInteractions=!0},create(){this.element=document.createElement("audio"),this.element.id="audio_player",this.element.crossOrigin="anonymous"},setVolume(e){this.element.volume=e},setCurrentTime(e){this.element.currentTime=e},stop(){this.element.pause(),n.setStatusStopped()},load(){},play(e){e?(this.element.play(),n.setStatusPlaying()):n.isPlaying?(this.element.pause(),n.setStatusPaused()):n.isPaused?(this.element.play(),n.setStatusPlaying()):(this.element.load(),this.element.play(),n.setStatusPlaying())},setRepeatMode(e){this.repeatMode=e},toggleShuffle(){this.shuffle=!this.shuffle},setAudioMotionAnalyzerSource:function(e){this.originalAudioMotionAnalyzerSource=e},getAudioMotionAnalyzerSource:function(){return this.originalAudioMotionAnalyzerSource}}})},1320:(e,t,l)=>{l.d(t,{l:()=>a});var s=l(1809);const a=(0,s.Q_)("playerStatus",{state:()=>({status:"stopped"}),getters:{getStatus(e){return e.status},isPlaying(e){return"playing"==e.status},isStopped(e){return"stopped"==e.status},isPaused(e){return"paused"==e.status}},actions:{setStatusPlaying(){this.status="playing"},setStatusStopped(){this.status="stopped"},setStatusPaused(){this.status="paused"}}})},152:(e,t,l)=>{l.r(t),l.d(t,{default:()=>ce});var s=l(9835),a=l(499),n=l(1957),r=l(6970),i=l(1569),o=l(9302);const u={class:"text-center"},c={class:"row"},d={class:"col-4"},m=["src"],p={class:"col-4"},v=["src"],h={class:"col-4"},g=["src"],y={class:"row"},_={class:"col-4"},f=["src"],w={class:"col-4"},x=["src"],k={class:"col-4"},I=["src"],b={class:"row"},C={class:"col-4"},S=["src"],P={class:"col-4"},q=["src"],W={class:"col-4"},E=["src"],Q=["src"],A="images/vinyl-small.png",Z={__name:"BrowsePlaylistItem",props:{playlist:Object,mode:String},emits:["play","delete"],setup(e,{emit:t}){const l=e,a=(0,s.Fl)((()=>"mosaic"==l.mode)),i=(0,s.Fl)((()=>"vinyls"==l.mode));function o(){t("play",l.playlist.id)}function Z(){t("delete",l.playlist.id)}function T(){const e="ABCDEF0123456789";let t="#";while(t.length<7)t+=e.charAt(Math.floor(16*Math.random()+1));return t}return(t,l)=>{const M=(0,s.up)("q-card-section"),D=(0,s.up)("q-separator"),V=(0,s.up)("q-avatar"),U=(0,s.up)("q-btn"),H=(0,s.up)("q-btn-group"),z=(0,s.up)("q-card");return(0,s.wg)(),(0,s.j4)(z,{class:"col-xl-2 col-lg-3 col-md-12 col-sm-12 col-xs-12 shadow-box shadow-10 q-mt-lg",bordered:""},{default:(0,s.w5)((()=>[(0,s.Wm)(M,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,r.zw)(e.playlist.name)+" ",1),(0,s._)("p",u,"("+(0,r.zw)(e.playlist.trackCount)+" track/s)",1)])),_:1}),(0,s.Wm)(D),a.value?((0,s.wg)(),(0,s.j4)(M,{key:0},{default:(0,s.w5)((()=>[(0,s._)("div",c,[(0,s._)("div",d,[(0,s._)("img",{class:"mosaic_cover_element",src:e.playlist.covers[0]||A},null,8,m)]),(0,s._)("div",p,[(0,s._)("img",{class:"mosaic_cover_element",src:e.playlist.covers[1]||A},null,8,v)]),(0,s._)("div",h,[(0,s._)("img",{class:"mosaic_cover_element",src:e.playlist.covers[2]||A},null,8,g)])]),(0,s._)("div",y,[(0,s._)("div",_,[(0,s._)("img",{class:"mosaic_cover_element",src:e.playlist.covers[3]||A},null,8,f)]),(0,s._)("div",w,[(0,s._)("img",{class:"mosaic_cover_element",src:e.playlist.covers[4]||A},null,8,x)]),(0,s._)("div",k,[(0,s._)("img",{class:"mosaic_cover_element",src:e.playlist.covers[5]||A},null,8,I)])]),(0,s._)("div",b,[(0,s._)("div",C,[(0,s._)("img",{class:"mosaic_cover_element",src:e.playlist.covers[6]||A},null,8,S)]),(0,s._)("div",P,[(0,s._)("img",{class:"mosaic_cover_element",src:e.playlist.covers[7]||A},null,8,q)]),(0,s._)("div",W,[(0,s._)("img",{class:"mosaic_cover_element",src:e.playlist.covers[8]||A},null,8,E)])])])),_:1})):i.value?((0,s.wg)(),(0,s.j4)(M,{key:1,style:{height:"140px"}},{default:(0,s.w5)((()=>[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(9,(t=>(0,s.Wm)(V,{key:t,size:"100px",class:"overlapping",style:(0,r.j5)(`left: ${25*t}px`)},{default:(0,s.w5)((()=>[e.playlist.covers[t]?((0,s.wg)(),(0,s.iD)("img",{key:0,src:e.playlist.covers[t],class:(0,r.C_)("mosaic_cover_element rotate-"+45*(t-1))},null,10,Q)):((0,s.wg)(),(0,s.iD)("div",{key:1,class:"no_cover",style:(0,r.j5)("background: "+T())},null,4))])),_:2},1032,["style"]))),64))])),_:1})):(0,s.kq)("",!0),(0,s.Wm)(D),(0,s.Wm)(M,null,{default:(0,s.w5)((()=>[(0,s.Wm)(H,{spread:"",outline:""},{default:(0,s.w5)((()=>[(0,s.Wm)(U,{label:"play",stack:"",icon:"play_arrow",onClick:(0,n.iM)(o,["prevent"])},null,8,["onClick"]),(0,s.Wm)(U,{label:"edit",stack:"",icon:"edit",disabled:""}),(0,s.Wm)(U,{label:"delete",stack:"",icon:"delete",onClick:(0,n.iM)(Z,["prevent"])},null,8,["onClick"])])),_:1})])),_:1}),(0,s.Wm)(D),(0,s.Wm)(M,{class:"text-right"},{default:(0,s.w5)((()=>[(0,s.Uk)(" by "+(0,r.zw)(e.playlist.owner.name),1)])),_:1})])),_:1})}}};var T=l(4458),M=l(3190),D=l(926),V=l(1357),U=l(7236),H=l(8879),z=l(9984),j=l.n(z);const B=Z,L=B;j()(Z,"components",{QCard:T.Z,QCardSection:M.Z,QSeparator:D.Z,QAvatar:V.Z,QBtnGroup:U.Z,QBtn:H.Z});var F=l(4958),R=l(2719);const K={class:"row q-gutter-xs"},N={class:"col"},Y={class:"col-xl-2 col-lg-2 col-md-3 col-sm-4 col-xs-4"},O={key:0,class:"q-pa-lg flex flex-center"},G={class:"q-gutter-sm row items-start"},$=(0,s._)("span",{class:"q-ml-sm"},"Delete playlist",-1),J=(0,s._)("p",null,"Are you sure ?",-1),X={__name:"BrowsePlaylistsPage",setup(e){const t=(0,o.Z)(),l=(0,a.iH)(null),u=(0,a.iH)(!1),c=(0,a.iH)(!1);let d=[];const m=(0,a.iH)(0),p=(0,a.iH)(1),v=[{label:"Mosaic",value:"mosaic"},{label:"Vinyl collection",value:"vinyls"}],h=(0,a.iH)(v[0]),g=(0,F.n)(),y=(0,R.d)(),_=(0,a.iH)(!1),f=(0,a.iH)(null);function w(e){e&&(p.value=1),u.value=!1,c.value=!0,i.api.playlist.search(p.value,32,{name:l.value}).then((e=>{d=e.data.data.items,m.value=e.data.data.pager.totalPages,l.value&&e.data.data.pager.totalResults<1&&(u.value=!0),c.value=!1})).catch((e=>{t.notify({type:"negative",message:"API Error: error loading playlists",caption:"API Error: fatal error details: HTTP {"+e.response.status+"} ({"+e.response.statusText+"})"}),c.value=!1}))}function x(e){p.value=e,w(!1)}function k(e){g.interact(),c.value=!0,i.api.track.search({playlistId:e},1,0,!1,"playListTrackIndex","ASC").then((e=>{y.saveElements(e.data.data.items.map((e=>({track:e})))),c.value=!1})).catch((e=>{c.value=!1}))}function I(e){_.value=!0,f.value=e}function b(){c.value=!0,i.api.playlist.delete(f.value).then((e=>{c.value=!1,_.value=!1,f.value=null,t.notify({type:"positive",message:"Playlist deleted"}),c.value=!1,w(!0)})).catch((e=>{c.value=!1}))}return w(!0),(e,t)=>{const i=(0,s.up)("q-breadcrumbs-el"),o=(0,s.up)("q-breadcrumbs"),g=(0,s.up)("q-icon"),y=(0,s.up)("q-input"),f=(0,s.up)("q-select"),C=(0,s.up)("q-pagination"),S=(0,s.up)("q-avatar"),P=(0,s.up)("q-card-section"),q=(0,s.up)("q-btn"),W=(0,s.up)("q-card-actions"),E=(0,s.up)("q-card"),Q=(0,s.up)("q-dialog"),A=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(E,{class:"q-pa-lg"},{default:(0,s.w5)((()=>[(0,s.Wm)(o,{class:"q-mb-lg"},{default:(0,s.w5)((()=>[(0,s.Wm)(i,{icon:"home",label:"Spieldose"}),(0,s.Wm)(i,{icon:"list",label:"Browse playlists"})])),_:1}),(0,a.SU)(d)?((0,s.wg)(),(0,s.j4)(P,{key:0},{default:(0,s.w5)((()=>[(0,s._)("div",K,[(0,s._)("div",N,[(0,s.Wm)(y,{modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e),clearable:"",type:"search",outlined:"",dense:"",placeholder:"Text condition",hint:"Search playlists with name",loading:c.value,disable:c.value,onKeydown:t[1]||(t[1]=(0,n.D2)((0,n.iM)((e=>w(!0)),["prevent"]),["enter"])),onClear:t[2]||(t[2]=e=>{u.value=!1,w(!0)}),error:u.value,errorMessage:"No playlists found with specified condition"},{prepend:(0,s.w5)((()=>[(0,s.Wm)(g,{name:"filter_alt"})])),append:(0,s.w5)((()=>[(0,s.Wm)(g,{name:"search",class:"cursor-pointer",onClick:w})])),_:1},8,["modelValue","loading","disable","error"])]),(0,s._)("div",Y,[(0,s.Wm)(f,{outlined:"",dense:"",modelValue:h.value,"onUpdate:modelValue":t[3]||(t[3]=e=>h.value=e),options:v,"options-dense":"",label:"Style",disable:c.value},{"selected-item":(0,s.w5)((e=>[(0,s.Uk)((0,r.zw)(e.opt.label),1)])),_:1},8,["modelValue","disable"])])]),m.value>1?((0,s.wg)(),(0,s.iD)("div",O,[(0,s.Wm)(C,{modelValue:p.value,"onUpdate:modelValue":[t[4]||(t[4]=e=>p.value=e),x],color:"dark",max:m.value,"max-pages":5,"boundary-numbers":"","direction-links":"","boundary-links":"",disable:c.value},null,8,["modelValue","max","disable"])])):(0,s.kq)("",!0),(0,s._)("div",G,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,a.SU)(d),(e=>((0,s.wg)(),(0,s.j4)(L,{key:e.id,playlist:e,mode:h.value.value,onPlay:t=>k(e.id),onDelete:t=>I(e.id)},null,8,["playlist","mode","onPlay","onDelete"])))),128))]),(0,s.Wm)(Q,{modelValue:_.value,"onUpdate:modelValue":t[5]||(t[5]=e=>_.value=e),persistent:""},{default:(0,s.w5)((()=>[(0,s.Wm)(E,null,{default:(0,s.w5)((()=>[(0,s.Wm)(P,{class:"row items-center"},{default:(0,s.w5)((()=>[(0,s.Wm)(S,{icon:"info"}),$])),_:1}),(0,s.Wm)(P,null,{default:(0,s.w5)((()=>[J])),_:1}),(0,s.Wm)(W,{align:"right"},{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(q,{flat:"",label:"Cancel",color:"primary"},null,512),[[A]]),(0,s.Wm)(q,{flat:"",label:"YES",color:"primary",onClick:b})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})):(0,s.kq)("",!0)])),_:1})}}};var ee=l(2605),te=l(8052),le=l(6611),se=l(2857),ae=l(6384),ne=l(996),re=l(2074),ie=l(1821),oe=l(2146);const ue=X,ce=ue;j()(X,"components",{QCard:T.Z,QBreadcrumbs:ee.Z,QBreadcrumbsEl:te.Z,QCardSection:M.Z,QInput:le.Z,QIcon:se.Z,QSelect:ae.Z,QPagination:ne.Z,QDialog:re.Z,QAvatar:V.Z,QCardActions:ie.Z,QBtn:H.Z}),j()(X,"directives",{ClosePopup:oe.Z})}}]);
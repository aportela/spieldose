"use strict";(globalThis["webpackChunkspieldose"]=globalThis["webpackChunkspieldose"]||[]).push([[151],{2719:(e,t,s)=>{s.d(t,{d:()=>o});var n=s(1809),a=s(8612),l=s.n(a),r=s(4958);const i=(0,r.n)(),u={namespace:"spieldose",storages:["local","cookie","session","memory"],storage:"local",expireDays:3650},o=(0,n.Q_)("currentPlaylist",{state:()=>({elements:[],shuffleIndexes:[],currentIndex:-1,elementsLastChangeTimestamp:null}),getters:{hasElements:e=>e.elements&&e.elements.length>0,getElements:e=>e.elements,elementCount:e=>e.elements?e.elements.length:0,getElementsLastChangeTimestamp:e=>e.elementsLastChangeTimestamp,getCurrentIndex:e=>i.getShuffle?e.shuffleIndexes[e.currentIndex]:e.currentIndex,getCurrentElement:e=>e.currentIndex>=0&&e.elements.length>0?e.elements[e.currentIndex]:null,getCurrentElementURL:e=>e.currentIndex>=0&&e.elements.length>0?e.elements[e.currentIndex].url:null,allowSkipPrevious:e=>e.currentIndex>0&&e.elements.length>0,allowSkipNext:e=>e.currentIndex>=0&&e.elements.length>0&&e.currentIndex<e.elements.length-1,allowPlay:e=>!0,allowPause:e=>!0,allowResume:e=>!0,allowStop:e=>!0},actions:{load(){const e=l()(u),t=e.get("currentPlaylistElements");t&&(this.elements=t);const s=e.get("shuffleIndexes");s&&(this.shuffleIndexes=s);const n=e.get("currentPlaylistElementIndex");n>=0&&(this.currentIndex=n)},saveCurrentElements(){const e=l()(u);e.set("currentPlaylistElements",this.elements),e.set("currentPlaylistElementIndex",this.currentIndex),e.set("shuffleIndexes",this.shuffleIndexes),this.elementsLastChangeTimestamp=Date.now()},saveElements(e){this.elements=e,this.shuffleIndexes=[...Array(e.length).keys()].sort((function(){return.5-Math.random()})),this.currentIndex=e&&e.length>0?0:-1,this.saveCurrentElements()},appendElements(e){this.elements=this.elements.concat(e),this.saveCurrentElements()},saveCurrentTrackIndex(e){this.currentIndex=e>=0?e:-1;const t=l()(u);t.set("currentPlaylistElementIndex",this.currentIndex)},skipPrevious(){this.saveCurrentTrackIndex(--this.currentIndex)},skipNext(){this.saveCurrentTrackIndex(++this.currentIndex)},clear(){this.elements=[],this.currentIndex=-1;const e=l()(u);e.set("currentPlaylistElements",[]),e.set(-1),this.elementsLastChangeTimestamp=Date.now()},setFavoriteTrack(e,t){const s=this.elements.findIndex((t=>t.track&&t.track.id==e));-1!==s&&(this.elements[s].track.favorited=t,this.saveCurrentElements())},unSetFavoriteTrack(e){const t=this.elements.findIndex((t=>t.track&&t.track.id==e));-1!==t&&(this.elements[t].track.favorited=null,this.saveCurrentElements())}}})},4958:(e,t,s)=>{s.d(t,{n:()=>r});var n=s(1809),a=s(1320);const l=(0,a.l)(),r=(0,n.Q_)("player",{state:()=>({repeatMode:null,shuffle:!1,element:null,hasPreviousUserInteractions:!1}),getters:{getRepeatMode:e=>e.repeatMode,getShuffle:e=>e.shuffle,getElement:e=>e.element,getDuration:e=>e.element.duration},actions:{interact(){this.hasPreviousUserInteractions=!0},create(){this.element=document.createElement("audio"),this.element.id="audio_player",this.element.crossOrigin="anonymous"},setVolume(e){this.element.volume=e},setCurrentTime(e){this.element.currentTime=e},stop(){this.element.pause(),l.setStatusStopped()},load(){},play(e){e?(this.element.play(),l.setStatusPlaying()):l.isPlaying?(this.element.pause(),l.setStatusPaused()):l.isPaused?(this.element.play(),l.setStatusPlaying()):(this.element.load(),this.element.play(),l.setStatusPlaying())},setRepeatMode(e){this.repeatMode=e},toggleShuffle(){this.shuffle=!this.shuffle}}})},1320:(e,t,s)=>{s.d(t,{l:()=>a});var n=s(1809);const a=(0,n.Q_)("playerStatus",{state:()=>({status:"stopped"}),getters:{getStatus(e){return e.status},isPlaying(e){return"playing"==e.status},isStopped(e){return"stopped"==e.status},isPaused(e){return"paused"==e.status}},actions:{setStatusPlaying(){this.status="playing"},setStatusStopped(){this.status="stopped"},setStatusPaused(){this.status="paused"}}})},4151:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var n=s(9835),a=s(6970),l=s(499),r=s(1569),i=s(9302),u=s(4958),o=s(2719);const d={key:0},c={key:0},h={key:1},m={__name:"BrowsePathsPage",setup(e){const t=(0,i.Z)(),s=(0,u.n)(),m=(0,o.d)(),p=(0,l.iH)(!1),g=(0,l.iH)(!1),f=(0,l.iH)([]),v=(0,l.iH)(null);function y(){p.value=!1,g.value=!0,r.api.path.getTree().then((e=>{f.value=e.data.items,g.value=!1})).catch((e=>{t.notify({type:"negative",message:"API Error: error loading paths",caption:"API Error: fatal error details: HTTP {"+e.response.status+"} ({"+e.response.statusText+"})"}),g.value=!1}))}function I(e,t){var s,n,a;if(e==t.hash)return t;for(s=0;s<t.children.length;s+=1)if(n=t.children[s],a=I(e,n),!1!==a)return a;return!1}function x(e){s.interact();let t=I(e,f.value[0]);return t&&t.id&&(g.value=!0,r.api.track.search({path:t.id},1,0,!1,"title","ASC").then((e=>{m.saveElements(e.data.data.items.map((e=>({track:e})))),g.value=!1})).catch((e=>{g.value=!1}))),!0}return y(),(e,t)=>{const s=(0,n.up)("q-breadcrumbs-el"),l=(0,n.up)("q-breadcrumbs"),r=(0,n.up)("q-icon"),i=(0,n.up)("q-tree"),u=(0,n.up)("q-card-section"),o=(0,n.up)("q-card");return(0,n.wg)(),(0,n.j4)(o,{class:"q-pa-lg"},{default:(0,n.w5)((()=>[(0,n.Wm)(l,{class:"q-mb-lg"},{default:(0,n.w5)((()=>[(0,n.Wm)(s,{icon:"home",label:"Spieldose"}),(0,n.Wm)(s,{icon:"person",label:"Browse paths"})])),_:1}),f.value&&f.value.length>0?((0,n.wg)(),(0,n.j4)(u,{key:0},{default:(0,n.w5)((()=>[(0,n._)("div",null,[(0,n.Wm)(i,{nodes:f.value,selected:v.value,"onUpdate:selected":[t[0]||(t[0]=e=>v.value=e),x],"node-key":"hash","label-key":"name","children-key":"children","no-transition":""},{"default-header":(0,n.w5)((e=>[e.node.totalFiles>0||e.node.children?((0,n.wg)(),(0,n.iD)("div",d,[(0,n.Wm)(r,{name:"playlist_play"}),(0,n.Uk)(" "+(0,a.zw)(e.node.name)+" ",1),e.node.totalFiles>0?((0,n.wg)(),(0,n.iD)("span",c,"("+(0,a.zw)(e.node.totalFiles)+" total tracks)",1)):(0,n.kq)("",!0)])):((0,n.wg)(),(0,n.iD)("span",h,(0,a.zw)(e.node.name),1))])),_:1},8,["nodes","selected"])])])),_:1})):(0,n.kq)("",!0)])),_:1})}}};var p=s(4458),g=s(2605),f=s(8052),v=s(3190),y=s(1893),I=s(2857),x=s(9984),k=s.n(x);const P=m,w=P;k()(m,"components",{QCard:p.Z,QBreadcrumbs:g.Z,QBreadcrumbsEl:f.Z,QCardSection:v.Z,QTree:y.Z,QIcon:I.Z})}}]);
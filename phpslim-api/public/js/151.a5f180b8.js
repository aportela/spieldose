"use strict";(globalThis["webpackChunkspieldose"]=globalThis["webpackChunkspieldose"]||[]).push([[151],{8106:(e,t,n)=>{n.d(t,{dC:()=>o,oS:()=>u});var s=n(6223),a=n(2719),l=n(1569),r=n(4867);const i=(0,a.d)(),o={setFavorite:function(e){return new Promise(((t,n)=>{l.api.track.setFavorite(e).then((n=>{r.spieldoseEvents.emit.track.setFavorite(e,n.data.favorited),t(n)})).catch((e=>{n(e)}))}))},unSetFavorite:function(e){return new Promise(((t,n)=>{l.api.track.unSetFavorite(e).then((n=>{r.spieldoseEvents.emit.track.unSetFavorite(e),t(n)})).catch((e=>{n(e)}))}))},play:function(e){s.spieldosePlayer.interact(),s.spieldosePlayer.isStopped()||s.spieldosePlayer.actions.stop(),i.saveElements(Array.isArray(e)?e:[{track:e}]),s.spieldosePlayer.actions.play(!0)},enqueue:function(e){player.interact(),i.appendElements(Array.isArray(e)?e:[{track:e}])}},u={saveElements:function(e){i.saveElements(e)},appendElements:function(e){i.appendElements(e)},clear:function(){i.clear()},skipPrevious:function(){i.skipPrevious()},skipNext:function(){i.skipNext()}}},2719:(e,t,n)=>{n.d(t,{d:()=>o});var s=n(1809),a=n(8612),l=n.n(a),r=n(6223);const i={namespace:"spieldose",storages:["local","cookie","session","memory"],storage:"local",expireDays:3650},o=(0,s.Q_)("currentPlaylist",{state:()=>({elements:[],shuffleIndexes:[],currentIndex:-1,elementsLastChangeTimestamp:null}),getters:{hasElements:e=>e.elements&&e.elements.length>0,getElements:e=>e.elements,elementCount:e=>e.elements?e.elements.length:0,getElementsLastChangeTimestamp:e=>e.elementsLastChangeTimestamp,getCurrentIndex:e=>r.spieldosePlayer.getShuffle()?e.shuffleIndexes[e.currentIndex]:e.currentIndex,getCurrentElement:e=>e.currentIndex>=0&&e.elements.length>0?e.elements[e.currentIndex]:null,getCurrentElementURL:e=>e.currentIndex>=0&&e.elements.length>0?e.elements[e.currentIndex].url:null,allowSkipPrevious:e=>e.currentIndex>0&&e.elements.length>0,allowSkipNext:e=>e.currentIndex>=0&&e.elements.length>0&&e.currentIndex<e.elements.length-1,allowPlay:e=>!0,allowPause:e=>!0,allowResume:e=>!0,allowStop:e=>!0},actions:{load(){const e=l()(i),t=e.get("currentPlaylistElements");t&&(this.elements=t);const n=e.get("shuffleIndexes");n&&(this.shuffleIndexes=n);const s=e.get("currentPlaylistElementIndex");s>=0&&(this.currentIndex=s)},saveCurrentElements(){const e=l()(i);e.set("currentPlaylistElements",this.elements),e.set("currentPlaylistElementIndex",this.currentIndex),e.set("shuffleIndexes",this.shuffleIndexes),this.elementsLastChangeTimestamp=Date.now()},saveElements(e){this.elements=e,this.shuffleIndexes=[...Array(e.length).keys()].sort((function(){return.5-Math.random()})),this.currentIndex=e&&e.length>0?0:-1,this.saveCurrentElements()},appendElements(e){this.elements=this.elements.concat(e),this.saveCurrentElements()},saveCurrentTrackIndex(e){this.currentIndex=e>=0?e:-1;const t=l()(i);t.set("currentPlaylistElementIndex",this.currentIndex)},skipPrevious(){this.saveCurrentTrackIndex(--this.currentIndex)},skipNext(){this.saveCurrentTrackIndex(++this.currentIndex)},clear(){this.elements=[],this.saveCurrentElements()}}})},4151:(e,t,n)=>{n.r(t),n.d(t,{default:()=>E});var s=n(9835),a=n(6970),l=n(499),r=n(1569),i=n(9302),o=n(8106);const u={key:0},c={key:0},d={key:1},m={__name:"BrowsePathsPage",setup(e){const t=(0,i.Z)(),n=(0,s.f3)("spieldosePlayer"),m=(0,l.iH)(!1),h=(0,l.iH)(!1),p=(0,l.iH)([]),v=(0,l.iH)(null);function f(){m.value=!1,h.value=!0,r.api.path.getTree().then((e=>{p.value=e.data.items,h.value=!1})).catch((e=>{t.notify({type:"negative",message:"API Error: error loading paths",caption:"API Error: fatal error details: HTTP {"+e.response.status+"} ({"+e.response.statusText+"})"}),h.value=!1}))}function g(e,t){var n,s,a;if(e==t.hash)return t;for(n=0;n<t.children.length;n+=1)if(s=t.children[n],a=g(e,s),!1!==a)return a;return!1}function x(e){n.interact();let t=g(e,p.value[0]);return t&&t.id&&t.totalFiles>0&&(h.value=!0,r.api.track.search({path:t.id},1,0,!1,"filename","ASC").then((e=>{o.oS.saveElements(e.data.data.items.map((e=>({track:e})))),h.value=!1})).catch((e=>{h.value=!1}))),!0}return f(),(e,t)=>{const n=(0,s.up)("q-breadcrumbs-el"),l=(0,s.up)("q-breadcrumbs"),r=(0,s.up)("q-icon"),i=(0,s.up)("q-tree"),o=(0,s.up)("q-card-section"),m=(0,s.up)("q-card");return(0,s.wg)(),(0,s.j4)(m,{class:"q-pa-lg"},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{class:"q-mb-lg"},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{icon:"home",label:"Spieldose"}),(0,s.Wm)(n,{icon:"person",label:"Browse paths"})])),_:1}),p.value&&p.value.length>0?((0,s.wg)(),(0,s.j4)(o,{key:0},{default:(0,s.w5)((()=>[(0,s._)("div",null,[(0,s.Wm)(i,{nodes:p.value,selected:v.value,"onUpdate:selected":[t[0]||(t[0]=e=>v.value=e),x],"node-key":"hash","label-key":"name","children-key":"children","no-transition":""},{"default-header":(0,s.w5)((e=>[e.node.totalFiles>0||e.node.children?((0,s.wg)(),(0,s.iD)("div",u,[(0,s.Wm)(r,{name:"playlist_play"}),(0,s.Uk)(" "+(0,a.zw)(e.node.name)+" ",1),e.node.totalFiles>0?((0,s.wg)(),(0,s.iD)("span",c,"("+(0,a.zw)(e.node.totalFiles)+" total tracks)",1)):(0,s.kq)("",!0)])):((0,s.wg)(),(0,s.iD)("span",d,(0,a.zw)(e.node.name),1))])),_:1},8,["nodes","selected"])])])),_:1})):(0,s.kq)("",!0)])),_:1})}}};var h=n(4458),p=n(2605),v=n(8052),f=n(3190),g=n(1893),x=n(2857),k=n(9984),y=n.n(k);const I=m,E=I;y()(m,"components",{QCard:h.Z,QBreadcrumbs:p.Z,QBreadcrumbsEl:v.Z,QCardSection:f.Z,QTree:g.Z,QIcon:x.Z})}}]);
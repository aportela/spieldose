"use strict";(globalThis["webpackChunkspieldose"]=globalThis["webpackChunkspieldose"]||[]).push([[164],{8106:(e,t,a)=>{a.d(t,{dC:()=>u});var s=a(4958),l=a(2719),n=a(1569),r=a(8514);const o=(0,s.n)(),i=(0,l.d)(),u={setFavorite:function(e){return new Promise(((t,a)=>{n.api.track.setFavorite(e).then((a=>{r.bus.emit("setFavoriteTrack",{trackId:e,timestamp:a.data.favorited}),i.setFavoriteTrack(e,a.data.favorited),t(a)})).catch((e=>{a(e)}))}))},unSetFavorite:function(e){return new Promise(((t,a)=>{n.api.track.unSetFavorite(e).then((a=>{r.bus.emit("unSetFavoriteTrack",{trackId:e}),i.unSetFavoriteTrack(e),t(a)})).catch((e=>{a(e)}))}))},play:function(e){o.stop(),i.saveElements(Array.isArray(e)?e:[{track:e}]),o.interact(),o.play(!0)},enqueue:function(e){i.appendElements(Array.isArray(e)?e:[{track:e}]),o.interact()}}},2719:(e,t,a)=>{a.d(t,{d:()=>u});var s=a(1809),l=a(8612),n=a.n(l),r=a(4958);const o=(0,r.n)(),i={namespace:"spieldose",storages:["local","cookie","session","memory"],storage:"local",expireDays:3650},u=(0,s.Q_)("currentPlaylist",{state:()=>({elements:[],shuffleIndexes:[],currentIndex:-1,elementsLastChangeTimestamp:null}),getters:{hasElements:e=>e.elements&&e.elements.length>0,getElements:e=>e.elements,elementCount:e=>e.elements?e.elements.length:0,getElementsLastChangeTimestamp:e=>e.elementsLastChangeTimestamp,getCurrentIndex:e=>o.getShuffle?e.shuffleIndexes[e.currentIndex]:e.currentIndex,getCurrentElement:e=>e.currentIndex>=0&&e.elements.length>0?e.elements[e.currentIndex]:null,getCurrentElementURL:e=>e.currentIndex>=0&&e.elements.length>0?e.elements[e.currentIndex].url:null,allowSkipPrevious:e=>e.currentIndex>0&&e.elements.length>0,allowSkipNext:e=>e.currentIndex>=0&&e.elements.length>0&&e.currentIndex<e.elements.length-1,allowPlay:e=>!0,allowPause:e=>!0,allowResume:e=>!0,allowStop:e=>!0},actions:{load(){const e=n()(i),t=e.get("currentPlaylistElements");t&&(this.elements=t);const a=e.get("shuffleIndexes");a&&(this.shuffleIndexes=a);const s=e.get("currentPlaylistElementIndex");s>=0&&(this.currentIndex=s)},saveCurrentElements(){const e=n()(i);e.set("currentPlaylistElements",this.elements),e.set("currentPlaylistElementIndex",this.currentIndex),e.set("shuffleIndexes",this.shuffleIndexes),this.elementsLastChangeTimestamp=Date.now()},saveElements(e){this.elements=e,this.shuffleIndexes=[...Array(e.length).keys()].sort((function(){return.5-Math.random()})),this.currentIndex=e&&e.length>0?0:-1,this.saveCurrentElements()},appendElements(e){this.elements=this.elements.concat(e),this.saveCurrentElements()},saveCurrentTrackIndex(e){this.currentIndex=e>=0?e:-1;const t=n()(i);t.set("currentPlaylistElementIndex",this.currentIndex)},skipPrevious(){this.saveCurrentTrackIndex(--this.currentIndex)},skipNext(){this.saveCurrentTrackIndex(++this.currentIndex)},clear(){this.elements=[],this.currentIndex=-1;const e=n()(i);e.set("currentPlaylistElements",[]),e.set(-1),this.elementsLastChangeTimestamp=Date.now()},setFavoriteTrack(e,t){const a=this.elements.findIndex((t=>t.track&&t.track.id==e));-1!==a&&(this.elements[a].track.favorited=t,this.saveCurrentElements())},unSetFavoriteTrack(e){const t=this.elements.findIndex((t=>t.track&&t.track.id==e));-1!==t&&(this.elements[t].track.favorited=null,this.saveCurrentElements())}}})},4958:(e,t,a)=>{a.d(t,{n:()=>r});var s=a(1809),l=a(1320);const n=(0,l.l)(),r=(0,s.Q_)("player",{state:()=>({repeatMode:null,shuffle:!1,element:null,hasPreviousUserInteractions:!1,originalAudioMotionAnalyzerSource:null}),getters:{getRepeatMode:e=>e.repeatMode,getShuffle:e=>e.shuffle,getElement:e=>e.element,getDuration:e=>e.element.duration},actions:{interact(){this.hasPreviousUserInteractions=!0},create(){this.element=document.createElement("audio"),this.element.id="audio_player",this.element.crossOrigin="anonymous"},setVolume(e){this.element.volume=e},setCurrentTime(e){this.element.currentTime=e},stop(){this.element.pause(),n.setStatusStopped()},load(){},play(e){e?(this.element.play(),n.setStatusPlaying()):n.isPlaying?(this.element.pause(),n.setStatusPaused()):n.isPaused?(this.element.play(),n.setStatusPlaying()):(this.element.load(),this.element.play(),n.setStatusPlaying())},setRepeatMode(e){this.repeatMode=e},toggleShuffle(){this.shuffle=!this.shuffle},setAudioMotionAnalyzerSource:function(e){this.originalAudioMotionAnalyzerSource=e},getAudioMotionAnalyzerSource:function(){return this.originalAudioMotionAnalyzerSource}}})},1320:(e,t,a)=>{a.d(t,{l:()=>l});var s=a(1809);const l=(0,s.Q_)("playerStatus",{state:()=>({status:"stopped"}),getters:{getStatus(e){return e.status},isPlaying(e){return"playing"==e.status},isStopped(e){return"stopped"==e.status},isPaused(e){return"paused"==e.status}},actions:{setStatusPlaying(){this.status="playing"},setStatusStopped(){this.status="stopped"},setStatusPaused(){this.status="paused"}}})},5164:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Ee});var s=a(9835),l=a(499),n=a(6970),r=a(9302),o=a(6647),i=a(4376);const u={class:"text-h6 row"},m={class:"col text-left"},c={class:"col text-right"},p={key:1},d={__name:"DashboardBaseBlock",props:{className:{type:String},loading:{type:Boolean},icon:{type:String},title:{type:String}},emits:["refresh"],setup(e,{emit:t}){const{t:a}=(0,o.QT)();function r(){t("refresh")}return(t,o)=>{const i=(0,s.up)("q-icon"),d=(0,s.up)("q-spinner"),g=(0,s.up)("q-card-section"),y=(0,s.up)("q-skeleton"),k=(0,s.up)("q-card");return(0,s.wg)(),(0,s.j4)(k,{class:"my-card q-ma-md"},{default:(0,s.w5)((()=>[(0,s.Wm)(g,{class:"bg-grey-3 text-black"},{default:(0,s.w5)((()=>[(0,s._)("div",u,[(0,s._)("div",m,[(0,s.Wm)(i,{name:e.icon,class:"cursor-pointer q-mr-sm"},null,8,["name"]),(0,s.Uk)((0,n.zw)(e.title),1)]),(0,s._)("div",c,[e.loading?((0,s.wg)(),(0,s.j4)(d,{key:0,color:"pink",size:"sm",class:"q-ml-sm",thickness:8})):((0,s.wg)(),(0,s.j4)(i,{key:1,name:"refresh",class:"cursor-pointer",onClick:r,title:(0,l.SU)(a)("reload")},null,8,["title"]))])])])),_:1}),(0,s.Wm)(g,{class:"bg-white text-black",style:{"min-height":"17em"}},{default:(0,s.w5)((()=>[(0,s.WI)(t.$slots,"body",{},(()=>[e.loading?((0,s.wg)(),(0,s.j4)(y,{key:0,type:"text",square:"",animation:"blink",height:"198px"})):((0,s.wg)(),(0,s.iD)("div",p,[(0,s.WI)(t.$slots,"tabs"),(0,s.WI)(t.$slots,"list"),(0,s.WI)(t.$slots,"chart")]))]))])),_:3})])),_:3})}}};var g=a(4458),y=a(3190),k=a(2857),v=a(3902),w=a(7133),b=a(9984),h=a.n(b);const f=d,D=f;h()(d,"components",{QCard:g.Z,QCardSection:y.Z,QIcon:k.Z,QSpinner:v.Z,QSkeleton:w.ZP});var S=a(8106);const _={key:0,class:"is-size-6-5 dashboard_list_item"},q={key:0},x={__name:"DashboardBaseBlockListElementTrack",props:{track:{type:Object}},setup(e){const{t}=(0,o.QT)();return(a,r)=>{const o=(0,s.up)("q-icon"),i=(0,s.up)("router-link");return e.track?((0,s.wg)(),(0,s.iD)("li",_,[(0,s.WI)(a.$slots,"prepend"),(0,s.Wm)(o,{name:"play_arrow",size:"sm",title:(0,l.SU)(t)("play track"),class:"cursor-pointer q-mr-xs",onClick:r[0]||(r[0]=t=>(0,l.SU)(S.dC).play(e.track))},null,8,["title"]),(0,s.Wm)(o,{name:"add_box",size:"sm",title:(0,l.SU)(t)("enqueue track"),class:"cursor-pointer q-mr-xs",onClick:r[1]||(r[1]=t=>(0,l.SU)(S.dC).enqueue(e.track))},null,8,["title"]),(0,s._)("span",null,(0,n.zw)(e.track.title),1),e.track.artist.name?((0,s.wg)(),(0,s.iD)("span",q,[(0,s.Uk)(" / "),(0,s.Wm)(i,{to:{name:"artist",params:{name:e.track.artist.name}}},{default:(0,s.w5)((()=>[(0,s.Uk)((0,n.zw)(e.track.artist.name),1)])),_:1},8,["to"])])):(0,s.kq)("",!0),(0,s.WI)(a.$slots,"append")])):(0,s.kq)("",!0)}}},P=x,I=P;h()(x,"components",{QIcon:k.Z});const T={key:0,class:"is-size-6-5 dashboard_list_item"},W={key:0},U={__name:"DashboardBaseBlockListElementArtist",props:{artist:{type:Object}},setup(e){return(t,a)=>{const l=(0,s.up)("q-icon"),r=(0,s.up)("router-link");return e.artist?((0,s.wg)(),(0,s.iD)("li",T,[(0,s.WI)(t.$slots,"prepend"),(0,s.Wm)(l,{name:"link",size:"sm",class:"q-mr-xs"}),e.artist.name?((0,s.wg)(),(0,s.iD)("span",W,[(0,s.Wm)(r,{to:{name:"artist",params:{name:e.artist.name}}},{default:(0,s.w5)((()=>[(0,s.Uk)((0,n.zw)(e.artist.name),1)])),_:1},8,["to"])])):(0,s.kq)("",!0),(0,s.WI)(t.$slots,"append")])):(0,s.kq)("",!0)}}},Y=U,C=Y;h()(U,"components",{QIcon:k.Z});const A={key:0,class:"is-size-6-5 dashboard_list_item"},z={key:0},Z={key:1},Q={__name:"DashboardBaseBlockListElementAlbum",props:{album:{type:Object}},setup(e){return(t,a)=>{const l=(0,s.up)("q-icon"),r=(0,s.up)("router-link");return e.album?((0,s.wg)(),(0,s.iD)("li",A,[(0,s.WI)(t.$slots,"prepend"),(0,s.Wm)(l,{name:"album",size:"sm",class:"q-mr-xs"}),(0,s._)("span",null,(0,n.zw)(e.album.title),1),e.album.year?((0,s.wg)(),(0,s.iD)("span",z," ("+(0,n.zw)(e.album.year)+") ",1)):(0,s.kq)("",!0),e.album.albumArtistName?((0,s.wg)(),(0,s.iD)("span",Z,[(0,s.Uk)(" / "),(0,s.Wm)(r,{to:{name:"artist",params:{name:e.album.albumArtistName}}},{default:(0,s.w5)((()=>[(0,s.Uk)((0,n.zw)(e.album.albumArtistName),1)])),_:1},8,["to"])])):(0,s.kq)("",!0),(0,s.WI)(t.$slots,"append")])):(0,s.kq)("",!0)}}},E=Q,M=E;h()(Q,"components",{QIcon:k.Z});const H={key:0,class:"is-size-6-5 dashboard_list_item"},N={__name:"DashboardBaseBlockListElementGenre",props:{genre:{type:Object}},setup(e){return(t,a)=>{const l=(0,s.up)("q-icon");return e.genre?((0,s.wg)(),(0,s.iD)("li",H,[(0,s.WI)(t.$slots,"prepend"),(0,s.Wm)(l,{name:"tag",size:"sm"}),(0,s._)("span",null,(0,n.zw)(e.genre.name),1),(0,s.WI)(t.$slots,"append")])):(0,s.kq)("",!0)}}},B=N,j=B;h()(N,"components",{QIcon:k.Z});var L=a(1569);const F={key:0,class:"q-px-sm"},$={class:"q-ml-sm"},V={key:1,class:"q-px-sm"},K={class:"q-ml-sm"},R={key:2,class:"q-px-sm"},O={class:"q-ml-sm"},G={key:3,class:"q-px-sm"},J={class:"q-ml-sm"},X={key:4},ee={key:0,class:"text-h5 text-center q-py-sm q-mt-xl q-mt-sm"},te={key:1,class:"text-h5 text-center q-py-sm q-mt-xl q-mt-sm"},ae=5,se={__name:"DashboardBaseBlockTop",props:{icon:{type:String},entity:{type:String},globalStats:Boolean},setup(e){const t=e,a=(0,r.Z)(),{t:u}=(0,o.QT)(),m=(0,l.iH)(!1),c=(0,l.iH)([]),p=(0,l.iH)(null),d=(0,s.Fl)((()=>t.globalStats||!1));(0,s.YP)(d,(e=>{g.global=d.value,h()}));let g={fromDate:null,toDate:null,global:d.value};(0,s.YP)(p,(e=>{switch(g={fromDate:null,toDate:null,global:d.value},e){case"today":g.fromDate=i.ZP.formatDate(Date.now(),"YYYYMMDD"),g.toDate=i.ZP.formatDate(Date.now(),"YYYYMMDD");break;case"lastWeek":g.fromDate=i.ZP.formatDate(i.ZP.addToDate(Date.now(),{days:-7}),"YYYYMMDD"),g.toDate=i.ZP.formatDate(Date.now(),"YYYYMMDD");break;case"lastMonth":g.fromDate=i.ZP.formatDate(i.ZP.addToDate(Date.now(),{months:-1}),"YYYYMMDD"),g.toDate=i.ZP.formatDate(Date.now(),"YYYYMMDD");break;case"lastYear":g.fromDate=i.ZP.formatDate(i.ZP.addToDate(Date.now(),{years:-1}),"YYYYMMDD"),g.toDate=i.ZP.formatDate(Date.now(),"YYYYMMDD");break;case"always":break}h()}));const y=[{label:"Today",value:"today"},{label:"Last week",value:"lastWeek"},{label:"Last month",value:"lastMonth"},{label:"Last year",value:"lastYear"},{label:"Always",value:"always"}],k=(0,s.Fl)((()=>{switch(t.entity){case"tracks":return u("Top played tracks");case"artists":return u("Top played artists");case"albums":return u("Top played albums");case"genres":return u("Top played genres");default:return null}}));let v=null;switch(t.entity){case"tracks":v=L.api.metrics.getTracks;break;case"artists":v=L.api.metrics.getArtists;break;case"albums":v=L.api.metrics.getAlbums;break;case"genres":v=L.api.metrics.getGenres;break}const w=(0,l.iH)(Date.now()),b=(0,l.iH)(!1);function h(){b.value=!1,p.value&&(m.value=!0,v(g,"playCount",ae).then((e=>{c.value=e.data.data,w.value=Date.now(),m.value=!1})).catch((e=>{b.value=!0,m.value=!1,a.notify({type:"negative",message:"API Error: error loading metrics",caption:u("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})})})))}return p.value="lastWeek",(t,a)=>{const r=(0,s.up)("q-tab"),o=(0,s.up)("q-tabs"),i=(0,s.up)("q-icon");return(0,s.wg)(),(0,s.j4)((0,s.LL)(D),{icon:e.icon||"format_list_numbered",title:k.value,loading:m.value,onRefresh:h},{tabs:(0,s.w5)((()=>[(0,s.Wm)(o,{modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=e=>p.value=e),"no-caps":"",class:"text-pink-7 q-mb-md"},{default:(0,s.w5)((()=>[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(y,(e=>(0,s.Wm)(r,{key:e.value,name:e.value,label:(0,l.SU)(u)(e.label)},null,8,["name","label"]))),64))])),_:1},8,["modelValue"])])),list:(0,s.w5)((()=>["tracks"==e.entity?((0,s.wg)(),(0,s.iD)("ol",F,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.value,((e,t,a,r)=>{const o=w.value;if(r&&r.key===e.id&&(0,s.nQ)(r,o))return r;const i=((0,s.wg)(),(0,s.j4)(I,{key:e.id,track:e.track},{append:(0,s.w5)((()=>[(0,s._)("span",$,(0,n.zw)(e.playCount)+" "+(0,n.zw)((0,l.SU)(u)(e.playCount>1?"nPlayCounts":"onePlayCount")),1)])),_:2},1032,["track"]));return i.memo=o,i}),a,1),128))])):"artists"==e.entity?((0,s.wg)(),(0,s.iD)("ol",V,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.value,((e,t,a,r)=>{const o=w.value;if(r&&r.key===e.id&&(0,s.nQ)(r,o))return r;const i=((0,s.wg)(),(0,s.j4)(C,{key:e.id,artist:e},{append:(0,s.w5)((()=>[(0,s._)("span",K,(0,n.zw)(e.playCount)+" "+(0,n.zw)((0,l.SU)(u)(e.playCount>1?"nPlayCounts":"onePlayCount")),1)])),_:2},1032,["artist"]));return i.memo=o,i}),a,3),128))])):"albums"==e.entity?((0,s.wg)(),(0,s.iD)("ol",R,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.value,((e,t,a,r)=>{const o=w.value;if(r&&r.key===e.id&&(0,s.nQ)(r,o))return r;const i=((0,s.wg)(),(0,s.j4)(M,{key:e.id,album:e},{append:(0,s.w5)((()=>[(0,s._)("span",O,(0,n.zw)(e.playCount)+" "+(0,n.zw)((0,l.SU)(u)(e.playCount>1?"nPlayCounts":"onePlayCount")),1)])),_:2},1032,["album"]));return i.memo=o,i}),a,5),128))])):"genres"==e.entity?((0,s.wg)(),(0,s.iD)("ol",G,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.value,((e,t,a,r)=>{const o=w.value;if(r&&r.key===e.id&&(0,s.nQ)(r,o))return r;const i=((0,s.wg)(),(0,s.j4)(j,{key:e.id,genre:e},{append:(0,s.w5)((()=>[(0,s._)("span",J,(0,n.zw)(e.playCount)+" "+(0,n.zw)((0,l.SU)(u)(e.playCount>1?"nPlayCounts":"onePlayCount")),1)])),_:2},1032,["genre"]));return i.memo=o,i}),a,7),128))])):(0,s.kq)("",!0),m.value?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",X,[b.value?((0,s.wg)(),(0,s.iD)("h5",ee,[(0,s.Wm)(i,{name:"error",size:"xl"}),(0,s.Uk)(" "+(0,n.zw)((0,l.SU)(u)("Error loading data")),1)])):c.value&&c.value.length>0?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("h5",te,[(0,s.Wm)(i,{name:"warning",size:"xl"}),(0,s.Uk)(" "+(0,n.zw)((0,l.SU)(u)("No enought data")),1)]))]))])),_:1},40,["icon","title","loading"])}}};var le=a(7817),ne=a(7661);const re=se,oe=re;h()(se,"components",{QTabs:le.Z,QTab:ne.Z,QIcon:k.Z});const ie={__name:"LabelTimestampAgo",props:{className:{type:String},timestamp:{type:Number}},setup(e){const t=e,{t:a}=(0,o.QT)();let r="",u=i.ZP.getDateDiff(Date.now(),t.timestamp,"years");return u<1?(u=i.ZP.getDateDiff(Date.now(),t.timestamp,"months"),u<1?(u=i.ZP.getDateDiff(Date.now(),t.timestamp,"days"),u<1?(u=i.ZP.getDateDiff(Date.now(),t.timestamp,"hours"),u<1?(u=i.ZP.getDateDiff(Date.now(),t.timestamp,"minutes"),u<1?(u=i.ZP.getDateDiff(Date.now(),t.timestamp,"seconds"),r=a(u>1?"nSecondsAgo":"oneSecondAgo",{count:u})):r=a(u>1?"nMinutesAgo":"oneMinuteAgo",{count:u})):r=a(u>1?"nHoursAgo":"oneHourAgo",{count:u})):r=a(u>1?"nDaysAgo":"oneDayAgo",{count:u})):r=a(u>1?"nMonthsAgo":"oneMonthAgo",{count:u})):r=a(u>1?"nYearsAgo":"oneYearAgo",{count:u}),(t,a)=>((0,s.wg)(),(0,s.iD)("span",{class:(0,n.C_)(e.className)},[(0,s.WI)(t.$slots,"prepend"),(0,s.Uk)((0,n.zw)((0,l.SU)(r)),1),(0,s.WI)(t.$slots,"append")],2))}},ue=ie,me=ue,ce={key:0,class:"q-px-sm"},pe={key:1,class:"q-px-sm"},de={key:2,class:"q-px-sm"},ge={key:3,class:"q-px-sm"},ye={key:4},ke={key:0,class:"text-h5 text-center q-py-sm q-mt-xl q-mt-sm"},ve={key:1,class:"text-h5 text-center q-py-sm q-mt-xl q-mt-sm"},we=5,be={__name:"DashboardBaseBlockRecently",props:{icon:{type:String},played:{type:Boolean},added:{type:Boolean},globalStats:Boolean},setup(e){const t=e,a=(0,r.Z)(),{t:i}=(0,o.QT)(),u=(0,l.iH)(!1),m=(0,l.iH)([]),c=(0,s.Fl)((()=>{let e=null;return t.played?e=i("Recently played"):t.added&&(e=i("Recently added")),e})),p=(0,l.iH)(null);(0,s.YP)(p,(()=>{y={global:g.value},w()}));const d=[{label:"Tracks",value:"tracks",function:L.api.metrics.getTracks,listItemType:""},{label:"Artists",value:"artists",function:L.api.metrics.getArtists},{label:"Albums",value:"albums",function:L.api.metrics.getAlbums},{label:"Genres",value:"genres",function:L.api.metrics.getGenres}],g=(0,s.Fl)((()=>t.globalStats||!1));(0,s.YP)(g,(e=>{t.played&&(y.global=g.value,w())}));let y={global:g.value};const k=(0,l.iH)(Date.now()),v=(0,l.iH)(!1);function w(){if(v.value=!1,p.value){m.value=[];const e=d.filter((e=>e.value==p.value))[0].function;u.value=!0;let s=null;t.played?s="recentlyPlayed":t.added&&(s="recentlyAdded"),e(y,s,we).then((e=>{m.value=e.data.data,k.value=Date.now(),u.value=!1})).catch((e=>{v.value=!0,u.value=!1,a.notify({type:"negative",message:"API Error: error loading metrics",caption:i("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})})}))}}return p.value="tracks",(t,a)=>{const r=(0,s.up)("q-tab"),o=(0,s.up)("q-tabs"),g=(0,s.up)("q-icon");return(0,s.wg)(),(0,s.j4)((0,s.LL)(D),{icon:e.icon||"format_list_numbered",title:c.value,loading:u.value,onRefresh:w},{tabs:(0,s.w5)((()=>[(0,s.Wm)(o,{modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=e=>p.value=e),"no-caps":"",class:"text-pink-7 q-mb-md"},{default:(0,s.w5)((()=>[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(d,(e=>(0,s.Wm)(r,{key:e.value,name:e.value,label:(0,l.SU)(i)(e.label)},null,8,["name","label"]))),64))])),_:1},8,["modelValue"])])),list:(0,s.w5)((()=>["tracks"==p.value?((0,s.wg)(),(0,s.iD)("ol",ce,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(m.value,((t,a,l,n)=>{const r=k.value;if(n&&n.key===t.id&&(0,s.nQ)(n,r))return n;const o=((0,s.wg)(),(0,s.j4)(I,{key:t.id,track:t.track},(0,s.Nv)({_:2},[e.played?{name:"append",fn:(0,s.w5)((()=>[(0,s.Wm)(me,{className:"q-ml-sm",timestamp:1e3*t.lastPlayTimestamp},{prepend:(0,s.w5)((()=>[(0,s.Uk)("(")])),append:(0,s.w5)((()=>[(0,s.Uk)(")")])),_:2},1032,["timestamp"])])),key:"0"}:e.added?{name:"append",fn:(0,s.w5)((()=>[(0,s.Wm)(me,{className:"q-ml-sm",timestamp:1e3*t.addedTimestamp},{prepend:(0,s.w5)((()=>[(0,s.Uk)("(")])),append:(0,s.w5)((()=>[(0,s.Uk)(")")])),_:2},1032,["timestamp"])])),key:"1"}:void 0]),1032,["track"]));return o.memo=r,o}),a,1),128))])):"artists"==p.value?((0,s.wg)(),(0,s.iD)("ol",pe,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(m.value,((t,a,l,n)=>{const r=k.value;if(n&&n.key===t.id&&(0,s.nQ)(n,r))return n;const o=((0,s.wg)(),(0,s.j4)(C,{key:t.id,artist:t},(0,s.Nv)({_:2},[e.played?{name:"append",fn:(0,s.w5)((()=>[(0,s.Wm)(me,{className:"q-ml-sm",timestamp:1e3*t.lastPlayTimestamp},{prepend:(0,s.w5)((()=>[(0,s.Uk)("(")])),append:(0,s.w5)((()=>[(0,s.Uk)(")")])),_:2},1032,["timestamp"])])),key:"0"}:e.added?{name:"append",fn:(0,s.w5)((()=>[(0,s.Wm)(me,{className:"q-ml-sm",timestamp:1e3*t.addedTimestamp},{prepend:(0,s.w5)((()=>[(0,s.Uk)("(")])),append:(0,s.w5)((()=>[(0,s.Uk)(")")])),_:2},1032,["timestamp"])])),key:"1"}:void 0]),1032,["artist"]));return o.memo=r,o}),a,3),128))])):"albums"==p.value?((0,s.wg)(),(0,s.iD)("ol",de,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(m.value,((t,a,l,n)=>{const r=k.value;if(n&&n.key===t.id&&(0,s.nQ)(n,r))return n;const o=((0,s.wg)(),(0,s.j4)(M,{key:t.id,album:t},(0,s.Nv)({_:2},[e.played?{name:"append",fn:(0,s.w5)((()=>[(0,s.Wm)(me,{className:"q-ml-sm",timestamp:1e3*t.lastPlayTimestamp},{prepend:(0,s.w5)((()=>[(0,s.Uk)("(")])),append:(0,s.w5)((()=>[(0,s.Uk)(")")])),_:2},1032,["timestamp"])])),key:"0"}:e.added?{name:"append",fn:(0,s.w5)((()=>[(0,s.Wm)(me,{className:"q-ml-sm",timestamp:1e3*t.addedTimestamp},{prepend:(0,s.w5)((()=>[(0,s.Uk)("(")])),append:(0,s.w5)((()=>[(0,s.Uk)(")")])),_:2},1032,["timestamp"])])),key:"1"}:void 0]),1032,["album"]));return o.memo=r,o}),a,5),128))])):"genres"==p.value?((0,s.wg)(),(0,s.iD)("ol",ge,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(m.value,((t,a,l,n)=>{const r=k.value;if(n&&n.key===t.name&&(0,s.nQ)(n,r))return n;const o=((0,s.wg)(),(0,s.j4)(j,{key:t.name,genre:t},(0,s.Nv)({_:2},[e.played?{name:"append",fn:(0,s.w5)((()=>[(0,s.Wm)(me,{className:"q-ml-sm",timestamp:1e3*t.lastPlayTimestamp},{prepend:(0,s.w5)((()=>[(0,s.Uk)("(")])),append:(0,s.w5)((()=>[(0,s.Uk)(")")])),_:2},1032,["timestamp"])])),key:"0"}:e.added?{name:"append",fn:(0,s.w5)((()=>[(0,s.Wm)(me,{className:"q-ml-sm",timestamp:1e3*t.addedTimestamp},{prepend:(0,s.w5)((()=>[(0,s.Uk)("(")])),append:(0,s.w5)((()=>[(0,s.Uk)(")")])),_:2},1032,["timestamp"])])),key:"1"}:void 0]),1032,["genre"]));return o.memo=r,o}),a,7),128))])):(0,s.kq)("",!0),u.value?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",ye,[v.value?((0,s.wg)(),(0,s.iD)("h5",ke,[(0,s.Wm)(g,{name:"error",size:"xl"}),(0,s.Uk)(" "+(0,n.zw)((0,l.SU)(i)("Error loading data")),1)])):m.value&&m.value.length>0?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("h5",ve,[(0,s.Wm)(g,{name:"warning",size:"xl"}),(0,s.Uk)(" "+(0,n.zw)((0,l.SU)(i)("No enought data")),1)]))]))])),_:1},40,["icon","title","loading"])}}},he=be,fe=he;h()(be,"components",{QTabs:le.Z,QTab:ne.Z,QIcon:k.Z});var De=a(1957),Se=a(9844);const _e={class:"ct-chart"},qe={key:0},xe={key:0,class:"text-h5 text-center q-py-sm q-mt-xl q-mt-sm"},Pe={key:1,class:"text-h5 text-center q-py-sm q-mt-xl q-mt-sm"},Ie={__name:"DashboardBaseBlockChart",props:{icon:{type:String},globalStats:Boolean},setup(e){const t=e,a=(0,r.Z)(),{t:i}=(0,o.QT)(),u=(0,l.iH)(!1);let m=[];const c=(0,l.iH)(null);(0,s.YP)(c,(e=>{v()}));const p=[{label:"Hour",value:"hour"},{label:"Weekday",value:"weekday"},{label:"Month",value:"month"},{label:"Year",value:"year"}],d=(0,s.Fl)((()=>t.globalStats||!1));(0,s.YP)(d,(e=>{v()}));const g={low:0,showArea:!0,fullWidth:!0,chartPadding:{left:48,right:48}};function y(){let e=[],t=[];switch(c.value){case"hour":e=["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],t=new Array(24).fill(0),m.forEach((e=>{t[new Number(e.hour)]=e.total}));break;case"weekday":e=[i("Sunday"),i("Monday"),i("Tuesday"),i("Wednesday"),i("Thursday"),i("Friday"),i("Saturday")],t=new Array(7).fill(0),m.forEach((e=>{t[new Number(e.weekday)]=e.total}));break;case"month":e=[i("January"),i("February"),i("March"),i("April"),i("May"),i("June"),i("July"),i("August"),i("September"),i("October"),i("November"),i("December")],t=new Array(12).fill(0),m.forEach((e=>{t[new Number(e.month)]=e.total}));break;case"year":e=m.map((e=>e.year)),t=m.map((e=>e.total));break}e.length>1?new Se.wW(".ct-chart",{labels:e,series:[t]},g):new Se.vz(".ct-chart",{labels:e,series:[t]},g)}const k=(0,l.iH)(!1);function v(){k.value=!1,c.value&&(u.value=!0,L.api.metrics.getDataRanges({dateRange:c.value,global:d.value}).then((e=>{m=e.data.data,u.value=!1,(0,s.Y3)((()=>{y()}))})).catch((e=>{k.value=!0,u.value=!1,a.notify({type:"negative",message:"API Error: error loading metrics",caption:i("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})})})))}return c.value="hour",(t,a)=>{const r=(0,s.up)("q-tab"),o=(0,s.up)("q-tabs"),d=(0,s.up)("q-icon");return(0,s.wg)(),(0,s.j4)((0,s.LL)(D),{icon:e.icon||"analytics",title:(0,l.SU)(i)("Play stats"),loading:u.value,onRefresh:v},{tabs:(0,s.w5)((()=>[(0,s.Wm)(o,{modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=e=>c.value=e),"no-caps":"",class:"text-pink-7 q-mb-md"},{default:(0,s.w5)((()=>[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(p,(e=>(0,s.Wm)(r,{key:e.value,name:e.value,label:(0,l.SU)(i)(e.label)},null,8,["name","label"]))),64))])),_:1},8,["modelValue"])])),chart:(0,s.w5)((()=>[(0,s.wy)((0,s._)("div",_e,null,512),[[De.F8,(0,l.SU)(m)&&(0,l.SU)(m).length>0]]),u.value?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",qe,[k.value?((0,s.wg)(),(0,s.iD)("h5",xe,[(0,s.Wm)(d,{name:"error",size:"xl"}),(0,s.Uk)(" "+(0,n.zw)((0,l.SU)(i)("Error loading data")),1)])):(0,l.SU)(m)&&(0,l.SU)(m).length>0?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("h5",Pe,[(0,s.Wm)(d,{name:"warning",size:"xl"}),(0,s.Uk)(" "+(0,n.zw)((0,l.SU)(i)("No enought data")),1)]))]))])),_:1},40,["icon","title","loading"])}}},Te=Ie,We=Te;h()(Ie,"components",{QTabs:le.Z,QTab:ne.Z,QIcon:k.Z});const Ue={class:"row"},Ye={class:"row"},Ce={class:"col-12"},Ae={__name:"DashboardPage",setup(e){const t=(0,r.Z)(),{t:a}=(0,o.QT)(),i=(0,l.iH)([{label:"My stats",value:"myStats",icon:"person"},{label:"Global stats",value:"globalStats",icon:"public"}]),u=(0,l.iH)(i.value[0].value),m=(0,s.Fl)((()=>t.screen.width>=2560?"col-xl-4":"col-xl-6"));return(e,t)=>{const r=(0,s.up)("q-breadcrumbs-el"),o=(0,s.up)("q-breadcrumbs"),c=(0,s.up)("q-tab"),p=(0,s.up)("q-tabs"),d=(0,s.up)("q-card");return(0,s.wg)(),(0,s.j4)(d,{class:"q-pa-lg"},{default:(0,s.w5)((()=>[(0,s.Wm)(o,{class:"q-mb-lg"},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{icon:"home",label:"Spieldose"}),(0,s.Wm)(r,{icon:"analytics",label:(0,l.SU)(a)("Dashboard")},null,8,["label"])])),_:1}),(0,s.Wm)(p,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),"inline-label":"","no-caps":"",dense:"",class:"text-pink-7 q-mb-md shadow-2"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.value,(e=>((0,s.wg)(),(0,s.j4)(c,{key:e.value,name:e.value,icon:e.icon,label:(0,l.SU)(a)(e.label)},null,8,["name","icon","label"])))),128))])),_:1},8,["modelValue"]),(0,s._)("div",Ue,[(0,s._)("div",{class:(0,n.C_)(["col-lg-6 col-12",m.value])},[(0,s.Wm)(oe,{entity:"tracks",globalStats:"globalStats"==u.value},null,8,["globalStats"])],2),(0,s._)("div",{class:(0,n.C_)(["col-lg-6 col-12",m.value])},[(0,s.Wm)(oe,{entity:"artists",globalStats:"globalStats"==u.value},null,8,["globalStats"])],2),(0,s._)("div",{class:(0,n.C_)(["col-lg-6 col-12",m.value])},[(0,s.Wm)(oe,{entity:"albums",globalStats:"globalStats"==u.value},null,8,["globalStats"])],2),(0,s._)("div",{class:(0,n.C_)(["col-lg-6 col-12",m.value])},[(0,s.Wm)(oe,{entity:"genres",globalStats:"globalStats"==u.value},null,8,["globalStats"])],2),(0,s._)("div",{class:(0,n.C_)(["col-lg-6 col-12",m.value])},[(0,s.Wm)(fe,{played:!0,globalStats:"globalStats"==u.value},null,8,["globalStats"])],2),(0,s._)("div",{class:(0,n.C_)(["col-lg-6 col-12",m.value])},[(0,s.Wm)(fe,{added:!0,globalStats:"globalStats"==u.value},null,8,["globalStats"])],2)]),(0,s._)("div",Ye,[(0,s._)("div",Ce,[(0,s.Wm)(We,{globalStats:"globalStats"==u.value},null,8,["globalStats"])])])])),_:1})}}};var ze=a(2605),Ze=a(8052);const Qe=Ae,Ee=Qe;h()(Ae,"components",{QCard:g.Z,QBreadcrumbs:ze.Z,QBreadcrumbsEl:Ze.Z,QTabs:le.Z,QTab:ne.Z})}}]);
"use strict";(globalThis["webpackChunkspieldose"]=globalThis["webpackChunkspieldose"]||[]).push([[677],{2719:(e,t,a)=>{a.d(t,{d:()=>o});var l=a(1809),n=a(8612),s=a.n(n),r=a(4958);const u=(0,r.n)(),i={namespace:"spieldose",storages:["local","cookie","session","memory"],storage:"local",expireDays:3650},o=(0,l.Q_)("currentPlaylist",{state:()=>({elements:[],shuffleIndexes:[],currentIndex:-1,elementsLastChangeTimestamp:null}),getters:{hasElements:e=>e.elements&&e.elements.length>0,getElements:e=>e.elements,elementCount:e=>e.elements?e.elements.length:0,getElementsLastChangeTimestamp:e=>e.elementsLastChangeTimestamp,getCurrentIndex:e=>u.getShuffle?e.shuffleIndexes[e.currentIndex]:e.currentIndex,getCurrentElement:e=>e.currentIndex>=0&&e.elements.length>0?e.elements[e.currentIndex]:null,getCurrentElementURL:e=>e.currentIndex>=0&&e.elements.length>0?e.elements[e.currentIndex].url:null,allowSkipPrevious:e=>e.currentIndex>0&&e.elements.length>0,allowSkipNext:e=>e.currentIndex>=0&&e.elements.length>0&&e.currentIndex<e.elements.length-1,allowPlay:e=>!0,allowPause:e=>!0,allowResume:e=>!0,allowStop:e=>!0},actions:{load(){const e=s()(i),t=e.get("currentPlaylistElements");t&&(this.elements=t);const a=e.get("shuffleIndexes");a&&(this.shuffleIndexes=a);const l=e.get("currentPlaylistElementIndex");l>=0&&(this.currentIndex=l)},saveCurrentElements(){const e=s()(i);e.set("currentPlaylistElements",this.elements),e.set("currentPlaylistElementIndex",this.currentIndex),e.set("shuffleIndexes",this.shuffleIndexes),this.elementsLastChangeTimestamp=Date.now()},saveElements(e){this.elements=e,this.shuffleIndexes=[...Array(e.length).keys()].sort((function(){return.5-Math.random()})),this.currentIndex=e&&e.length>0?0:-1,this.saveCurrentElements()},appendElements(e){this.elements=this.elements.concat(e),this.saveCurrentElements()},saveCurrentTrackIndex(e){this.currentIndex=e>=0?e:-1;const t=s()(i);t.set("currentPlaylistElementIndex",this.currentIndex)},skipPrevious(){this.saveCurrentTrackIndex(--this.currentIndex)},skipNext(){this.saveCurrentTrackIndex(++this.currentIndex)},clear(){this.elements=[],this.currentIndex=-1;const e=s()(i);e.set("currentPlaylistElements",[]),e.set(-1),this.elementsLastChangeTimestamp=Date.now()},setFavoriteTrack(e,t){const a=this.elements.findIndex((t=>t.track&&t.track.id==e));-1!==a&&(this.elements[a].track.favorited=t,this.saveCurrentElements())},unSetFavoriteTrack(e){const t=this.elements.findIndex((t=>t.track&&t.track.id==e));-1!==t&&(this.elements[t].track.favorited=null,this.saveCurrentElements())}}})},4958:(e,t,a)=>{a.d(t,{n:()=>r});var l=a(1809),n=a(1320);const s=(0,n.l)(),r=(0,l.Q_)("player",{state:()=>({repeatMode:null,shuffle:!1,element:null,hasPreviousUserInteractions:!1,originalAudioMotionAnalyzerSource:null}),getters:{getRepeatMode:e=>e.repeatMode,getShuffle:e=>e.shuffle,getElement:e=>e.element,getDuration:e=>e.element.duration},actions:{interact(){this.hasPreviousUserInteractions=!0},create(){this.element=document.createElement("audio"),this.element.id="audio_player",this.element.crossOrigin="anonymous"},setVolume(e){this.element.volume=e},setCurrentTime(e){this.element.currentTime=e},stop(){this.element.pause(),s.setStatusStopped()},load(){},play(e){e?(this.element.play(),s.setStatusPlaying()):s.isPlaying?(this.element.pause(),s.setStatusPaused()):s.isPaused?(this.element.play(),s.setStatusPlaying()):(this.element.load(),this.element.play(),s.setStatusPlaying())},setRepeatMode(e){this.repeatMode=e},toggleShuffle(){this.shuffle=!this.shuffle},setAudioMotionAnalyzerSource:function(e){this.originalAudioMotionAnalyzerSource=e},getAudioMotionAnalyzerSource:function(){return this.originalAudioMotionAnalyzerSource}}})},1320:(e,t,a)=>{a.d(t,{l:()=>n});var l=a(1809);const n=(0,l.Q_)("playerStatus",{state:()=>({status:"stopped"}),getters:{getStatus(e){return e.status},isPlaying(e){return"playing"==e.status},isStopped(e){return"stopped"==e.status},isPaused(e){return"paused"==e.status}},actions:{setStatusPlaying(){this.status="playing"},setStatusStopped(){this.status="stopped"},setStatusPaused(){this.status="paused"}}})},6677:(e,a,l)=>{l.r(a),l.d(a,{default:()=>F});var n=l(9835),s=l(1957),r=l(6970),u=l(499),i=l(9302),o=l(1569),c=l(4958),d=l(1320),m=l(2719);const p=["onSubmit"],h={key:0},v={key:0,class:"q-pa-lg flex flex-center"},k={class:"q-pa-sm bg-grey-2"},g={class:"bg-grey-2 text-grey-10"},b=(0,n._)("th",{class:"text-center"},"Actions",-1),f={class:"text-left"},x={class:"text-left"},y={class:"text-left"},w={class:"text-left"},_=(0,n._)("span",{class:"is-clickable"},[(0,n._)("i",{class:"fas fa-link ml-1"})],-1),S={class:"text-right"},I={class:"text-right"},C={class:"text-center"},E={__name:"SearchPage",setup(e){const a=(0,i.Z)(),l=(0,m.d)(),E=(0,c.n)(),P=(0,d.l)(),q=(0,u.iH)(null),T=(0,u.iH)(""),W=(0,u.iH)([]),A=(0,u.iH)(!1),V=(0,u.iH)("global"),z=((0,u.iH)(!1),(0,u.iH)(!1)),U=(0,u.iH)(0),Q=(0,u.iH)(1),D=(0,u.iH)("title"),Z=[{label:"Ascending",value:"ASC"},{label:"Descending",value:"DESC"}],H=(0,u.iH)(Z[0]);function M(e){Q.value=e,N(!1)}function j(e){e==D.value?H.value="DESC"==H.value.value?Z[0]:Z[1]:(H.value=Z[0],D.value=e),N()}function N(e){e&&(Q.value=1),z.value=!1,T.value&&T.value.trim().length>0&&(A.value=!0,o.api.track.search({text:T.value},Q.value,16,!1,D.value,H.value.value).then((e=>{U.value=e.data.data.pager.totalPages,W.value=e.data.data.items.map((e=>({track:e}))),z.value=!0,A.value=!1,(0,n.Y3)((()=>{q.value.$el.focus()}))})).catch((e=>{A.value=!1,a.notify({type:"negative",message:"API Error: error searching tracks",caption:"API Error: fatal error details: HTTP {"+e.response.status+"} ({"+e.response.statusText+"})"})})))}function L(e){E.interact(),l.saveElements([e])}function Y(){E.interact(),P.isStopped||E.stop(),l.saveElements(W.value),z.value=!1,(0,n.Y3)((()=>{E.play(!0)}))}function R(e){if(e&&e.id){const l=e.favorited?o.api.track.unSetFavorite:o.api.track.setFavorite;l(e.id).then((t=>{e.favorited=t.data.favorited})).catch((e=>{switch(e.response.status){default:a.notify({type:"negative",message:t("API Error: fatal error"),caption:t("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})});break}}))}}return(0,n.bv)((()=>{(0,n.Y3)((()=>{q.value.$el.focus()}))})),(e,t)=>{const a=(0,n.up)("q-breadcrumbs-el"),l=(0,n.up)("q-breadcrumbs"),u=(0,n.up)("q-tab"),i=(0,n.up)("q-tabs"),o=(0,n.up)("q-separator"),c=(0,n.up)("q-icon"),d=(0,n.up)("q-btn"),m=(0,n.up)("q-input"),E=(0,n.up)("q-tab-panel"),P=(0,n.up)("q-tab-panels"),Z=(0,n.up)("q-card"),B=(0,n.up)("q-pagination"),F=(0,n.up)("router-link"),G=(0,n.up)("q-btn-group"),K=(0,n.up)("q-spinner-gears"),$=(0,n.up)("q-inner-loading"),O=(0,n.up)("q-markup-table");return(0,n.wg)(),(0,n.j4)(Z,{class:"q-pa-lg"},{default:(0,n.w5)((()=>[(0,n.Wm)(l,{class:"q-mb-lg"},{default:(0,n.w5)((()=>[(0,n.Wm)(a,{icon:"home",label:"Spieldose"}),(0,n.Wm)(a,{icon:"search",label:"Search"})])),_:1}),(0,n.Wm)(Z,null,{default:(0,n.w5)((()=>[(0,n.Wm)(i,{modelValue:V.value,"onUpdate:modelValue":t[0]||(t[0]=e=>V.value=e),dense:"",class2:"text-grey","active-color2":"primary","indicator-color2":"primary",align:"justify","narrow-indicator":""},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{name:"global",label:"Global search"}),(0,n.Wm)(u,{name:"advanced",label:"Advanced search"})])),_:1},8,["modelValue"]),(0,n.Wm)(o),(0,n.Wm)(P,{modelValue:V.value,"onUpdate:modelValue":t[8]||(t[8]=e=>V.value=e),animated:""},{default:(0,n.w5)((()=>[(0,n.Wm)(E,{name:"global"},{default:(0,n.w5)((()=>[(0,n._)("form",{onSubmit:(0,s.iM)(N,["prevent","stop"]),autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false"},[(0,n.Wm)(m,{clearable:"","clear-icon":"close",dense:"",outlined:"",type:"text",name:"searchText",label:"Search text on all fields...",modelValue:T.value,"onUpdate:modelValue":t[1]||(t[1]=e=>T.value=e),"onKey:modelValue":t[2]||(t[2]=e=>N(!0)),disable:A.value,ref_key:"inputSearchTextRef",ref:q},{prepend:(0,n.w5)((()=>[(0,n.Wm)(c,{name:"filter_alt"})])),after:(0,n.w5)((()=>[(0,n.Wm)(d,{type:"submit",label:"launch search",outline:"",icon:"search",loading:A.value,disable:A.value||!T.value,class:"q-pa-sm",onClick:N},null,8,["loading","disable"])])),_:1},8,["modelValue","disable"])],40,p)])),_:1}),(0,n.Wm)(E,{name:"advanced"},{default:(0,n.w5)((()=>[(0,n._)("form",null,[(0,n.Wm)(m,{outlined:"",modelValue:e.text,"onUpdate:modelValue":t[3]||(t[3]=t=>e.text=t),label:"Track title",placeholder:"type text condition",hint:"Search on track title",dense:"",clearable:"","clear-icon":"close",disable:A.value},null,8,["modelValue","disable"]),(0,n.Wm)(m,{outlined:"",modelValue:e.text,"onUpdate:modelValue":t[4]||(t[4]=t=>e.text=t),label:"Artist name",placeholder:"type text condition",hint:"Search on artist name",dense:"",clearable:"","clear-icon":"close",disable:A.value},null,8,["modelValue","disable"]),(0,n.Wm)(m,{outlined:"",modelValue:e.text,"onUpdate:modelValue":t[5]||(t[5]=t=>e.text=t),label:"Album name",placeholder:"type text condition",hint:"Search on album name",dense:"",clearable:"","clear-icon":"close",disable:A.value},null,8,["modelValue","disable"]),(0,n.Wm)(m,{outlined:"",modelValue:e.text,"onUpdate:modelValue":t[6]||(t[6]=t=>e.text=t),label:"Album artist",placeholder:"type text condition",hint:"Search on album artist",dense:"",clearable:"","clear-icon":"close",disable:A.value},null,8,["modelValue","disable"]),(0,n.Wm)(m,{outlined:"",modelValue:e.text,"onUpdate:modelValue":t[7]||(t[7]=t=>e.text=t),label:"Year",placeholder:"type year condition",hint:"Search on track year",dense:"",clearable:"","clear-icon":"close",disable:A.value},null,8,["modelValue","disable"])])])),_:1})])),_:1},8,["modelValue"])])),_:1}),W.value&&W.value.length>0?((0,n.wg)(),(0,n.iD)("div",h,[U.value>1?((0,n.wg)(),(0,n.iD)("div",v,[(0,n.Wm)(B,{modelValue:Q.value,"onUpdate:modelValue":[t[9]||(t[9]=e=>Q.value=e),M],color:"dark",max:U.value,"max-pages":5,"boundary-numbers":"","direction-links":"","boundary-links":"",disable:A.value},null,8,["modelValue","max","disable"])])):(0,n.kq)("",!0),(0,n.Wm)(O,{flat:"",bordered:""},{default:(0,n.w5)((()=>[(0,n._)("caption",k,[(0,n.Wm)(d,{outline:"",onClick:Y,disable:!z.value,class:"full-width"},{default:(0,n.w5)((()=>[(0,n.Uk)("Send results to playlist")])),_:1},8,["disable"])]),(0,n._)("thead",null,[(0,n._)("tr",g,[(0,n._)("th",{class:"text-left cursor-pointer",onClick:t[10]||(t[10]=e=>j("title"))},[(0,n.Uk)("Title "),"title"==D.value?((0,n.wg)(),(0,n.j4)(c,{key:0,size:"xl",name:"DESC"==H.value.value?"arrow_drop_down":"arrow_drop_up"},null,8,["name"])):(0,n.kq)("",!0)]),(0,n._)("th",{class:"text-left cursor-pointer",onClick:t[11]||(t[11]=e=>j("artistName"))},[(0,n.Uk)("Artist "),"artistName"==D.value?((0,n.wg)(),(0,n.j4)(c,{key:0,size:"xl",name:"DESC"==H.value.value?"arrow_drop_down":"arrow_drop_up"},null,8,["name"])):(0,n.kq)("",!0)]),(0,n._)("th",{class:"text-left cursor-pointer",onClick:t[12]||(t[12]=e=>j("albumArtistName"))},[(0,n.Uk)("Album Artist "),"albumArtistName"==D.value?((0,n.wg)(),(0,n.j4)(c,{key:0,size:"xl",name:"DESC"==H.value.value?"arrow_drop_down":"arrow_drop_up"},null,8,["name"])):(0,n.kq)("",!0)]),(0,n._)("th",{class:"text-left cursor-pointer",onClick:t[13]||(t[13]=e=>j("releaseTitle"))},[(0,n.Uk)("Album "),"releaseTitle"==D.value?((0,n.wg)(),(0,n.j4)(c,{key:0,size:"xl",name:"DESC"==H.value.value?"arrow_drop_down":"arrow_drop_up"},null,8,["name"])):(0,n.kq)("",!0)]),(0,n._)("th",{class:"text-right cursor-pointer",onClick:t[14]||(t[14]=e=>j("trackNumber"))},["trackNumber"==D.value?((0,n.wg)(),(0,n.j4)(c,{key:0,size:"xl",name:"DESC"==H.value.value?"arrow_drop_down":"arrow_drop_up"},null,8,["name"])):(0,n.kq)("",!0),(0,n.Uk)(" Album Track nº")]),(0,n._)("th",{class:"text-right cursor-pointer",onClick:t[15]||(t[15]=e=>j("year"))},["year"==D.value?((0,n.wg)(),(0,n.j4)(c,{key:0,size:"xl",name:"DESC"==H.value.value?"arrow_drop_down":"arrow_drop_up"},null,8,["name"])):(0,n.kq)("",!0),(0,n.Uk)(" Year")]),b])]),(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(W.value,(e=>((0,n.wg)(),(0,n.iD)("tr",{key:e.track.id,class:"non-selectable"},[(0,n._)("td",f,(0,r.zw)(e.track.title),1),(0,n._)("td",x,[e.track.artist&&e.track.artist.name?((0,n.wg)(),(0,n.j4)(F,{key:0,to:{name:"artist",params:{name:e.track.artist.name}}},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{name:"link",class:"q-mr-sm"}),(0,n.Uk)((0,r.zw)(e.track.artist.name),1)])),_:2},1032,["to"])):(0,n.kq)("",!0)]),(0,n._)("td",y,[e.track.album&&e.track.album.artist.name?((0,n.wg)(),(0,n.j4)(F,{key:0,to:{name:"artist",params:{name:e.track.album.artist.name}}},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{name:"link",class:"q-mr-sm"}),(0,n.Uk)((0,r.zw)(e.track.album.artist.name),1)])),_:2},1032,["to"])):(0,n.kq)("",!0)]),(0,n._)("td",w,[(0,n.Uk)((0,r.zw)(e.track.album?e.track.album.title:null),1),_]),(0,n._)("td",S,(0,r.zw)(e.track.trackNumber),1),(0,n._)("td",I,(0,r.zw)(e.track.album?e.track.album.year:null),1),(0,n._)("td",C,[(0,n.Wm)(G,{outline:""},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{size:"sm",color:"white","text-color":"grey-5",icon:"play_arrow",title:"Play",disable:A.value,onClick:t=>L(e)},null,8,["disable","onClick"]),(0,n.Wm)(d,{size:"sm",color:"white","text-color":"grey-5",icon:"download",title:"Download",disable:A.value,href:e.track.url},null,8,["disable","href"]),(0,n.Wm)(d,{size:"sm",color:"white","text-color":e.track.favorited?"pink":"grey-5",icon:"favorite",title:"Toggle favorite",disable:A.value,onClick:t=>R(e.track)},null,8,["text-color","disable","onClick"])])),_:2},1024)])])))),128))]),(0,n.Wm)($,{showing:A.value},{default:(0,n.w5)((()=>[(0,n.Wm)(K,{size:"50px",color:"pink"})])),_:1},8,["showing"])])),_:1})])):(0,n.kq)("",!0)])),_:1})}}};var P=l(4458),q=l(2605),T=l(8052),W=l(7817),A=l(7661),V=l(926),z=l(9800),U=l(4106),Q=l(6611),D=l(2857),Z=l(8879),H=l(996),M=l(6933),j=l(7236),N=l(854),L=l(9120),Y=l(9984),R=l.n(Y);const B=E,F=B;R()(E,"components",{QCard:P.Z,QBreadcrumbs:q.Z,QBreadcrumbsEl:T.Z,QTabs:W.Z,QTab:A.Z,QSeparator:V.Z,QTabPanels:z.Z,QTabPanel:U.Z,QInput:Q.Z,QIcon:D.Z,QBtn:Z.Z,QPagination:H.Z,QMarkupTable:M.Z,QBtnGroup:j.Z,QInnerLoading:N.Z,QSpinnerGears:L.Z})}}]);
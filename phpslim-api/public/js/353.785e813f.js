"use strict";(globalThis["webpackChunkspieldose"]=globalThis["webpackChunkspieldose"]||[]).push([[353],{2719:(e,t,l)=>{l.d(t,{d:()=>i});var a=l(1809),s=l(8612),n=l.n(s);const r={namespace:"spieldose",storages:["local","cookie","session","memory"],storage:"local",expireDays:3650},i=(0,a.Q_)("currentPlaylist",{state:()=>({elements:[],currentIndex:-1}),getters:{hasElements:e=>e.elements&&e.elements.length>0,getElements:e=>e.elements,getCurrentIndex:e=>e.currentIndex,getCurrentElement:e=>e.currentIndex>=0&&e.elements.length>0?e.elements[e.currentIndex]:null,getCurrentElementURL:e=>e.currentIndex>=0&&e.elements.length>0?e.elements[e.currentIndex].url:null,allowSkipPrevious:e=>e.currentIndex>0&&e.elements.length>0,allowSkipNext:e=>e.currentIndex>=0&&e.elements.length>0&&e.currentIndex<e.elements.length-1,allowPlay:e=>!0,allowPause:e=>!0,allowResume:e=>!0,allowStop:e=>!0},actions:{load(){const e=n()(r),t=e.get("currentPlaylistElements");t&&(this.elements=t);const l=e.get("currentPlaylistElementIndex");l>=0&&(this.currentIndex=l)},saveElements(e){this.elements=e,this.currentIndex=e&&e.length>0?0:-1;const t=n()(r);t.set("currentPlaylistElements",e),t.set("currentPlaylistElementIndex",e&&e.length>0?0:-1)},saveCurrentTrackIndex(e){this.currentIndex=e>=0?e:-1;const t=n()(r);t.set("currentPlaylistElementIndex",this.currentIndex)},skipPrevious(){this.currentIndex--},skipNext(){this.currentIndex++}}})},4958:(e,t,l)=>{l.d(t,{n:()=>r});var a=l(1809),s=l(1320);const n=(0,s.l)(),r=(0,a.Q_)("player",{state:()=>({element:null,hasPreviousUserInteractions:!1}),getters:{getElement:e=>e.element,getDuration:e=>e.element.duration},actions:{interact(){this.hasPreviousUserInteractions=!0},create(){this.element=document.createElement("audio"),this.element.id="audio_player"},setVolume(e){this.element.volume=e},setCurrentTime(e){this.element.currentTime=e},stop(){this.element.pause(),n.setStatusStopped()},load(){},play(e){e?(this.element.play(),n.setStatusPlaying()):n.isPlaying?(this.element.pause(),n.setStatusPaused()):n.isPaused?(this.element.play(),n.setStatusPlaying()):(this.element.load(),this.element.play(),n.setStatusPlaying())}}})},1320:(e,t,l)=>{l.d(t,{l:()=>s});var a=l(1809);const s=(0,a.Q_)("playerStatus",{state:()=>({status:"stopped"}),getters:{getStatus(e){return e.status},isPlaying(e){return"playing"==e.status},isStopped(e){return"stopped"==e.status},isPaused(e){return"paused"==e.status}},actions:{setStatusPlaying(){this.status="playing"},setStatusStopped(){this.status="stopped"},setStatusPaused(){this.status="paused"}}})},353:(e,t,l)=>{l.r(t),l.d(t,{default:()=>M});var a=l(9835),s=l(499),n=l(6970),r=l(1957),i=l(9302),o=l(7712),u=l(1569),c=l(4958),d=l(1320),m=l(2719);const p={class:"text-left"},b={class:"text-left"},g={class:"text-left"},k=(0,a._)("span",{class:"is-clickable"},[(0,a._)("i",{class:"fas fa-link ml-1"})],-1),x={class:"text-right"},h={class:"text-right"},v={class:"text-center"},w={__name:"CurrentPlaylistTableRow",props:{disabled:Boolean,index:Number,lastIndex:Number,selected:Boolean,isPlaying:Boolean,isPaused:Boolean,isStopped:Boolean,element:Object},emits:["setcurrentIndex","up","down","toggleFavorite"],setup(e,{emit:t}){const l=e,{t:r}=(0,o.QT)(),i=(0,a.Fl)((()=>l.isPlaying?"play_arrow":l.isPaused?"pause":l.isStopped?"stop":"play_arrow"));function u(){t("setcurrentIndex",l.index)}function c(){t("up",l.index)}function d(){t("down",l.index)}function m(){t("toggleFavorite",l.index)}return(t,l)=>{const o=(0,a.up)("q-icon"),w=(0,a.up)("router-link"),y=(0,a.up)("q-btn"),S=(0,a.up)("q-btn-group");return e.element.track?((0,a.wg)(),(0,a.iD)("tr",{key:0,class:(0,n.C_)(["non-selectable",{"bg-pink text-white":e.selected}])},[(0,a._)("td",{class:"text-right cursor-pointer",onClick:u},[e.selected?((0,a.wg)(),(0,a.j4)(o,{key:0,name:i.value,size:"sm",class:"q-mr-sm"},null,8,["name"])):(0,a.kq)("",!0),(0,a.Uk)((0,n.zw)(e.index+1)+"/32 ",1)]),(0,a._)("td",{class:"text-left cursor-pointer",onClick:u},(0,n.zw)(e.element.track.title),1),(0,a._)("td",p,[e.element.track.artist&&e.element.track.artist.name?((0,a.wg)(),(0,a.j4)(w,{key:0,class:(0,n.C_)({"text-white text-bold":e.selected}),to:{name:"artist",params:{name:e.element.track.artist.name}}},{default:(0,a.w5)((()=>[(0,a.Wm)(o,{name:"link",class:"q-mr-sm"}),(0,a.Uk)((0,n.zw)(e.element.track.artist.name),1)])),_:1},8,["class","to"])):(0,a.kq)("",!0)]),(0,a._)("td",b,[e.element.track.album&&e.element.track.album.artist.name?((0,a.wg)(),(0,a.j4)(w,{key:0,class:(0,n.C_)({"text-white text-bold":e.selected}),to:{name:"artist",params:{name:e.element.track.album.artist.name}}},{default:(0,a.w5)((()=>[(0,a.Wm)(o,{name:"link",class:"q-mr-sm"}),(0,a.Uk)((0,n.zw)(e.element.track.album.artist.name),1)])),_:1},8,["class","to"])):(0,a.kq)("",!0)]),(0,a._)("td",g,[(0,a.Uk)((0,n.zw)(e.element.track.album?e.element.track.album.title:null),1),k]),(0,a._)("td",x,(0,n.zw)(e.element.track.trackNumber),1),(0,a._)("td",h,(0,n.zw)(e.element.track.album?e.element.track.album.year:null),1),(0,a._)("td",v,[(0,a.Wm)(S,{outline:""},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{size:"sm",color:"white","text-color":"grey-5",icon:"north",title:(0,s.SU)(r)("Up"),disable:e.disabled||0==e.index,onClick:c},null,8,["title","disable"]),(0,a.Wm)(y,{size:"sm",color:"white","text-color":"grey-5",icon:"south",title:(0,s.SU)(r)("Down"),disable:e.disabled||e.index==e.lastIndex-1,onClick:d},null,8,["title","disable"]),(0,a.Wm)(y,{size:"sm",color:"white","text-color":e.element.favorited?"pink":"grey-5",icon:"favorite",title:(0,s.SU)(r)("Toggle favorite"),disable:e.disabled,onClick:m},null,8,["text-color","title","disable"]),(0,a.Wm)(y,{size:"sm",color:"white","text-color":"grey-5",icon:"download",title:(0,s.SU)(r)("Download"),disable:e.disabled,href:e.element.track.url},null,8,["title","disable","href"])])),_:1})])],2)):(0,a.kq)("",!0)}}};var y=l(2857),S=l(7236),f=l(8879),P=l(9984),_=l.n(P);const U=w,I=U;_()(w,"components",{QIcon:y.Z,QBtnGroup:S.Z,QBtn:f.Z});const C={class:"bg-grey-2 text-grey-10"},E={class:"text-right"},q={class:"text-left"},z={class:"text-left"},T={class:"text-left"},W={class:"text-left"},Q={class:"text-right"},Z={class:"text-right"},B={class:"text-center"},D={key:0},A={key:1},j={colspan:"8",class:"text-center"},F={__name:"CurrentPlaylistPage",setup(e){const t=(0,i.Z)(),{t:l}=(0,o.QT)(),p=(0,c.n)(),b=(0,m.d)(),g=(0,d.l)(),k=(0,s.iH)([]),x=(0,s.iH)(0),h=(0,s.iH)(!1);function v(){p.stop(),k.value=[],b.saveElements([])}function w(e){p.interact(),b.saveCurrentTrackIndex(e),g.isPlaying||p.play()}function y(e){const t=k.value[e];k.value.splice(e,1),k.value.splice(e-1,0,t)}function S(e){const t=k.value[e];k.value.splice(e,1),k.value.splice(e+1,0,t)}function f(e){const a=k.value[e];if(a){const e=a.favorited?u.api.track.unSetFavorite:u.api.track.setFavorite;e(a.id).then((e=>{a.favorited=e.data.favorited,b.saveElements(k.value)})).catch((e=>{switch(e.response.status){default:t.notify({type:"negative",message:l("API Error: fatal error"),caption:l("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})});break}}))}}function P(){p.interact(),h.value=!0,x.value=0,u.api.track.search({},1,32,!0,null,null).then((e=>{k.value=e.data.data.items.map((e=>({track:e}))),b.saveElements(k.value),h.value=!1})).catch((e=>{t.notify({type:"negative",message:l("API Error: error loading random tracks"),caption:l("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})}),h.value=!1}))}const _=(0,a.Fl)((()=>b.getCurrentIndex));function U(){p.stop(),P()}function F(){p.interact(),b.skipPrevious()}function N(){p.interact(),p.play()}function R(){p.interact(),p.play()}function H(){p.interact(),p.play()}function L(){p.stop(),p.setCurrentTime(0)}function Y(){p.interact(),b.skipNext()}return(0,a.YP)(_,(e=>{x.value=e})),k.value=b.getElements,x.value=b.getCurrentIndex,(e,t)=>{const i=(0,a.up)("q-breadcrumbs-el"),o=(0,a.up)("q-breadcrumbs"),u=(0,a.up)("q-btn"),c=(0,a.up)("q-btn-group"),d=(0,a.up)("q-spinner"),m=(0,a.up)("q-markup-table"),p=(0,a.up)("q-card"),P=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(P,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"q-pa-lg"},{default:(0,a.w5)((()=>[(0,a.Wm)(o,{class:"q-mb-lg"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{icon:"home",label:"Spieldose"}),(0,a.Wm)(i,{icon:"list_alt",label:(0,s.SU)(l)("Current playlist")},null,8,["label"])])),_:1}),(0,a.Wm)(c,{spread:"",class:"q-mb-md"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{outline:"",color:"dark",label:(0,s.SU)(l)("Clear"),icon:"clear",onClick:v,disable:h.value||!(k.value&&k.value.length>0)},null,8,["label","disable"]),(0,a.Wm)(u,{outline:"",color:"dark",label:(0,s.SU)(l)("Randomize"),icon:"bolt",onClick:U,disable:h.value},null,8,["label","disable"]),(0,a.Wm)(u,{outline:"",color:"dark",label:(0,s.SU)(l)("Previous"),icon:"skip_previous",onClick:F,disable:h.value||!(0,s.SU)(b).allowSkipPrevious},null,8,["label","disable"]),(0,s.SU)(g).isStopped?((0,a.wg)(),(0,a.j4)(u,{key:0,outline:"",color:"dark",label:(0,s.SU)(l)("Play"),icon:"play_arrow",onClick:N,disable:h.value||!(0,s.SU)(b).hasElements},null,8,["label","disable"])):(0,s.SU)(g).isPlaying?((0,a.wg)(),(0,a.j4)(u,{key:1,outline:"",color:"dark",label:(0,s.SU)(l)("Pause"),icon:"pause",onClick:R,disable:h.value},null,8,["label","disable"])):(0,s.SU)(g).isPaused?((0,a.wg)(),(0,a.j4)(u,{key:2,outline:"",color:"dark",label:(0,s.SU)(l)("Resume"),icon:"play_arrow",onClick:H,disable:h.value},null,8,["label","disable"])):(0,a.kq)("",!0),(0,a.Wm)(u,{outline:"",color:"dark",label:(0,s.SU)(l)("Stop"),icon:"stop",onClick:L,disable:h.value||(0,s.SU)(g).isStopped},null,8,["label","disable"]),(0,a.Wm)(u,{outline:"",color:"dark",label:(0,s.SU)(l)("Next"),icon:"skip_next",onClick:Y,disable:h.value||!(0,s.SU)(b).allowSkipNext},null,8,["label","disable"]),(0,a.Wm)(u,{outline:"",color:"dark",label:(0,s.SU)(l)("Download"),icon:"save_alt",disable:h.value||!(0,s.SU)(b).getCurrentElementURL,href:(0,s.SU)(b).getCurrentElementURL},null,8,["label","disable","href"])])),_:1}),(0,a.Wm)(m,{flat:"",bordered:""},{default:(0,a.w5)((()=>[(0,a._)("thead",null,[(0,a._)("tr",C,[(0,a._)("th",E,(0,n.zw)((0,s.SU)(l)("Index")),1),(0,a._)("th",q,(0,n.zw)((0,s.SU)(l)("Title")),1),(0,a._)("th",z,(0,n.zw)((0,s.SU)(l)("Artist")),1),(0,a._)("th",T,(0,n.zw)((0,s.SU)(l)("Album Artist")),1),(0,a._)("th",W,(0,n.zw)((0,s.SU)(l)("Album")),1),(0,a._)("th",Q,(0,n.zw)((0,s.SU)(l)("Album Track nÂº")),1),(0,a._)("th",Z,(0,n.zw)((0,s.SU)(l)("Year")),1),(0,a._)("th",B,(0,n.zw)((0,s.SU)(l)("Actions")),1)])]),h.value?((0,a.wg)(),(0,a.iD)("tbody",A,[(0,a._)("tr",null,[(0,a._)("td",j,[(0,a.wy)((0,a.Wm)(d,{color:"pink",size:"xl",class:"q-ml-sm",thickness:10},null,512),[[r.F8,h.value]])])])])):((0,a.wg)(),(0,a.iD)("tbody",D,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(k.value,((e,t)=>((0,a.wg)(),(0,a.j4)(I,{key:e.id,element:e,index:t,lastIndex:k.value.length,selected:x.value==t,onSetcurrentIndex:e=>w(t),onUp:e=>y(t),onDown:e=>S(t),onToggleFavorite:e=>f(t),disabled:h.value,isPlaying:(0,s.SU)(g).isPlaying,isPaused:(0,s.SU)(g).isPaused,isStopped:(0,s.SU)(g).isStopped},null,8,["element","index","lastIndex","selected","onSetcurrentIndex","onUp","onDown","onToggleFavorite","disabled","isPlaying","isPaused","isStopped"])))),128))]))])),_:1})])),_:1})])),_:1})}}};var N=l(9885),R=l(4458),H=l(2605),L=l(8052),Y=l(6933),G=l(3902);const K=F,M=K;_()(F,"components",{QPage:N.Z,QCard:R.Z,QBreadcrumbs:H.Z,QBreadcrumbsEl:L.Z,QBtnGroup:S.Z,QBtn:f.Z,QMarkupTable:Y.Z,QSpinner:G.Z})}}]);
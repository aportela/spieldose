"use strict";(globalThis["webpackChunkspieldose"]=globalThis["webpackChunkspieldose"]||[]).push([[353],{2719:(e,t,l)=>{l.d(t,{d:()=>r});var a=l(1809),s=l(8612),n=l.n(s);const i={namespace:"spieldose",storages:["local","cookie","session","memory"],storage:"local",expireDays:3650},r=(0,a.Q_)("currentPlaylist",{state:()=>({elements:[],currentIndex:-1,elementsLastChangeTimestamp:null}),getters:{hasElements:e=>e.elements&&e.elements.length>0,getElements:e=>e.elements,getElementsLastChangeTimestamp:e=>e.elementsLastChangeTimestamp,getCurrentIndex:e=>e.currentIndex,getCurrentElement:e=>e.currentIndex>=0&&e.elements.length>0?e.elements[e.currentIndex]:null,getCurrentElementURL:e=>e.currentIndex>=0&&e.elements.length>0?e.elements[e.currentIndex].url:null,allowSkipPrevious:e=>e.currentIndex>0&&e.elements.length>0,allowSkipNext:e=>e.currentIndex>=0&&e.elements.length>0&&e.currentIndex<e.elements.length-1,allowPlay:e=>!0,allowPause:e=>!0,allowResume:e=>!0,allowStop:e=>!0},actions:{load(){const e=n()(i),t=e.get("currentPlaylistElements");t&&(this.elements=t);const l=e.get("currentPlaylistElementIndex");l>=0&&(this.currentIndex=l)},saveElements(e){this.elements=e,this.currentIndex=e&&e.length>0?0:-1;const t=n()(i);t.set("currentPlaylistElements",e),t.set("currentPlaylistElementIndex",e&&e.length>0?0:-1),this.elementsLastChangeTimestamp=Date.now()},saveCurrentTrackIndex(e){this.currentIndex=e>=0?e:-1;const t=n()(i);t.set("currentPlaylistElementIndex",this.currentIndex)},skipPrevious(){this.currentIndex--},skipNext(){this.currentIndex++}}})},4958:(e,t,l)=>{l.d(t,{n:()=>i});var a=l(1809),s=l(1320);const n=(0,s.l)(),i=(0,a.Q_)("player",{state:()=>({element:null,hasPreviousUserInteractions:!1}),getters:{getElement:e=>e.element,getDuration:e=>e.element.duration},actions:{interact(){this.hasPreviousUserInteractions=!0},create(){this.element=document.createElement("audio"),this.element.id="audio_player"},setVolume(e){this.element.volume=e},setCurrentTime(e){this.element.currentTime=e},stop(){this.element.pause(),n.setStatusStopped()},load(){},play(e){e?(this.element.play(),n.setStatusPlaying()):n.isPlaying?(this.element.pause(),n.setStatusPaused()):n.isPaused?(this.element.play(),n.setStatusPlaying()):(this.element.load(),this.element.play(),n.setStatusPlaying())}}})},1320:(e,t,l)=>{l.d(t,{l:()=>s});var a=l(1809);const s=(0,a.Q_)("playerStatus",{state:()=>({status:"stopped"}),getters:{getStatus(e){return e.status},isPlaying(e){return"playing"==e.status},isStopped(e){return"stopped"==e.status},isPaused(e){return"paused"==e.status}},actions:{setStatusPlaying(){this.status="playing"},setStatusStopped(){this.status="stopped"},setStatusPaused(){this.status="paused"}}})},353:(e,t,l)=>{l.r(t),l.d(t,{default:()=>M});var a=l(9835),s=l(499),n=l(6970),i=l(1957),r=l(9302),o=l(7712),u=l(1569),c=l(4958),d=l(1320),m=l(2719);const p={class:"text-left"},g={class:"text-left"},b={class:"text-left"},k=(0,a._)("span",{class:"is-clickable"},[(0,a._)("i",{class:"fas fa-link ml-1"})],-1),h={class:"text-right"},x={class:"text-right"},v={class:"text-center"},w={__name:"CurrentPlaylistTableRow",props:{disabled:Boolean,index:Number,lastIndex:Number,selected:Boolean,isPlaying:Boolean,isPaused:Boolean,isStopped:Boolean,element:Object},emits:["setcurrentIndex","up","down","toggleFavorite"],setup(e,{emit:t}){const l=e,{t:i}=(0,o.QT)(),r=(0,a.Fl)((()=>l.isPlaying?"play_arrow":l.isPaused?"pause":l.isStopped?"stop":"play_arrow"));function u(){t("setcurrentIndex",l.index)}function c(){t("up",l.index)}function d(){t("down",l.index)}function m(){t("toggleFavorite",l.index)}return(t,l)=>{const o=(0,a.up)("q-icon"),w=(0,a.up)("router-link"),y=(0,a.up)("q-btn"),S=(0,a.up)("q-btn-group");return e.element.track?((0,a.wg)(),(0,a.iD)("tr",{key:0,class:(0,n.C_)(["non-selectable",{"bg-pink text-white":e.selected}])},[(0,a._)("td",{class:"text-right cursor-pointer",onClick:u},[e.selected?((0,a.wg)(),(0,a.j4)(o,{key:0,name:r.value,size:"sm",class:"q-mr-sm"},null,8,["name"])):(0,a.kq)("",!0),(0,a.Uk)((0,n.zw)(e.index+1)+"/32 ",1)]),(0,a._)("td",{class:"text-left cursor-pointer",onClick:u},(0,n.zw)(e.element.track.title),1),(0,a._)("td",p,[e.element.track.artist&&e.element.track.artist.name?((0,a.wg)(),(0,a.j4)(w,{key:0,class:(0,n.C_)({"text-white text-bold":e.selected}),to:{name:"artist",params:{name:e.element.track.artist.name}}},{default:(0,a.w5)((()=>[(0,a.Wm)(o,{name:"link",class:"q-mr-sm"}),(0,a.Uk)((0,n.zw)(e.element.track.artist.name),1)])),_:1},8,["class","to"])):(0,a.kq)("",!0)]),(0,a._)("td",g,[e.element.track.album&&e.element.track.album.artist.name?((0,a.wg)(),(0,a.j4)(w,{key:0,class:(0,n.C_)({"text-white text-bold":e.selected}),to:{name:"artist",params:{name:e.element.track.album.artist.name}}},{default:(0,a.w5)((()=>[(0,a.Wm)(o,{name:"link",class:"q-mr-sm"}),(0,a.Uk)((0,n.zw)(e.element.track.album.artist.name),1)])),_:1},8,["class","to"])):(0,a.kq)("",!0)]),(0,a._)("td",b,[(0,a.Uk)((0,n.zw)(e.element.track.album?e.element.track.album.title:null),1),k]),(0,a._)("td",h,(0,n.zw)(e.element.track.trackNumber),1),(0,a._)("td",x,(0,n.zw)(e.element.track.album?e.element.track.album.year:null),1),(0,a._)("td",v,[(0,a.Wm)(S,{outline:""},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{size:"sm",color:"white","text-color":"grey-5",icon:"north",title:(0,s.SU)(i)("Up"),disable:e.disabled||0==e.index,onClick:c},null,8,["title","disable"]),(0,a.Wm)(y,{size:"sm",color:"white","text-color":"grey-5",icon:"south",title:(0,s.SU)(i)("Down"),disable:e.disabled||e.index==e.lastIndex-1,onClick:d},null,8,["title","disable"]),(0,a.Wm)(y,{size:"sm",color:"white","text-color":e.element.favorited?"pink":"grey-5",icon:"favorite",title:(0,s.SU)(i)("Toggle favorite"),disable:e.disabled,onClick:m},null,8,["text-color","title","disable"]),(0,a.Wm)(y,{size:"sm",color:"white","text-color":"grey-5",icon:"download",title:(0,s.SU)(i)("Download"),disable:e.disabled,href:e.element.track.url},null,8,["title","disable","href"])])),_:1})])],2)):(0,a.kq)("",!0)}}};var y=l(2857),S=l(7236),f=l(8879),P=l(9984),_=l.n(P);const U=w,C=U;_()(w,"components",{QIcon:y.Z,QBtnGroup:S.Z,QBtn:f.Z});const I={class:"bg-grey-2 text-grey-10"},E={class:"text-right"},T={class:"text-left"},q={class:"text-left"},z={class:"text-left"},W={class:"text-left"},Q={class:"text-right"},D={class:"text-right"},Z={class:"text-center"},B={key:0},A={key:1},F={colspan:"8",class:"text-center"},j={__name:"CurrentPlaylistPage",setup(e){const t=(0,r.Z)(),{t:l}=(0,o.QT)(),p=(0,c.n)(),g=(0,m.d)(),b=(0,a.Fl)((()=>g.getElementsLastChangeTimestamp));(0,a.YP)(b,(e=>{h.value=g.getElements,x.value=g.getCurrentIndex}));const k=(0,d.l)(),h=(0,s.iH)([]),x=(0,s.iH)(0),v=(0,s.iH)(!1);function w(){p.stop(),h.value=[],g.saveElements([])}function y(e){p.interact(),g.saveCurrentTrackIndex(e),k.isPlaying||p.play()}function S(e){const t=h.value[e];h.value.splice(e,1),h.value.splice(e-1,0,t)}function f(e){const t=h.value[e];h.value.splice(e,1),h.value.splice(e+1,0,t)}function P(e){const a=h.value[e];if(a){const e=a.favorited?u.api.track.unSetFavorite:u.api.track.setFavorite;e(a.id).then((e=>{a.favorited=e.data.favorited,g.saveElements(h.value)})).catch((e=>{switch(e.response.status){default:t.notify({type:"negative",message:l("API Error: fatal error"),caption:l("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})});break}}))}}function _(){p.interact(),v.value=!0,x.value=0,u.api.track.search({},1,32,!0,null,null).then((e=>{h.value=e.data.data.items.map((e=>({track:e}))),g.saveElements(h.value),v.value=!1})).catch((e=>{t.notify({type:"negative",message:l("API Error: error loading random tracks"),caption:l("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})}),v.value=!1}))}const U=(0,a.Fl)((()=>g.getCurrentIndex));function j(){p.stop(),_()}function L(){p.interact(),g.skipPrevious()}function N(){p.interact(),p.play()}function R(){p.interact(),p.play()}function H(){p.interact(),p.play()}function Y(){p.stop(),p.setCurrentTime(0)}function G(){p.interact(),g.skipNext()}return(0,a.YP)(U,(e=>{x.value=e})),h.value=g.getElements,x.value=g.getCurrentIndex,(e,t)=>{const r=(0,a.up)("q-breadcrumbs-el"),o=(0,a.up)("q-breadcrumbs"),u=(0,a.up)("q-btn"),c=(0,a.up)("q-btn-group"),d=(0,a.up)("q-spinner"),m=(0,a.up)("q-markup-table"),p=(0,a.up)("q-card"),b=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(b,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"q-pa-lg"},{default:(0,a.w5)((()=>[(0,a.Wm)(o,{class:"q-mb-lg"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{icon:"home",label:"Spieldose"}),(0,a.Wm)(r,{icon:"list_alt",label:(0,s.SU)(l)("Current playlist")},null,8,["label"])])),_:1}),(0,a.Wm)(c,{spread:"",class:"q-mb-md"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{outline:"",color:"dark",label:(0,s.SU)(l)("Clear"),icon:"clear",onClick:w,disable:v.value||!(h.value&&h.value.length>0)},null,8,["label","disable"]),(0,a.Wm)(u,{outline:"",color:"dark",label:(0,s.SU)(l)("Randomize"),icon:"bolt",onClick:j,disable:v.value},null,8,["label","disable"]),(0,a.Wm)(u,{outline:"",color:"dark",label:(0,s.SU)(l)("Previous"),icon:"skip_previous",onClick:L,disable:v.value||!(0,s.SU)(g).allowSkipPrevious},null,8,["label","disable"]),(0,s.SU)(k).isStopped?((0,a.wg)(),(0,a.j4)(u,{key:0,outline:"",color:"dark",label:(0,s.SU)(l)("Play"),icon:"play_arrow",onClick:N,disable:v.value||!(0,s.SU)(g).hasElements},null,8,["label","disable"])):(0,s.SU)(k).isPlaying?((0,a.wg)(),(0,a.j4)(u,{key:1,outline:"",color:"dark",label:(0,s.SU)(l)("Pause"),icon:"pause",onClick:R,disable:v.value||!(h.value&&h.value.length>0)},null,8,["label","disable"])):(0,s.SU)(k).isPaused?((0,a.wg)(),(0,a.j4)(u,{key:2,outline:"",color:"dark",label:(0,s.SU)(l)("Resume"),icon:"play_arrow",onClick:H,disable:v.value||!(h.value&&h.value.length>0)},null,8,["label","disable"])):(0,a.kq)("",!0),(0,a.Wm)(u,{outline:"",color:"dark",label:(0,s.SU)(l)("Stop"),icon:"stop",onClick:Y,disable:v.value||(0,s.SU)(k).isStopped||!(h.value&&h.value.length>0)},null,8,["label","disable"]),(0,a.Wm)(u,{outline:"",color:"dark",label:(0,s.SU)(l)("Next"),icon:"skip_next",onClick:G,disable:v.value||!(0,s.SU)(g).allowSkipNext},null,8,["label","disable"]),(0,a.Wm)(u,{outline:"",color:"dark",label:(0,s.SU)(l)("Download"),icon:"save_alt",disable:v.value||!(0,s.SU)(g).getCurrentElementURL,href:(0,s.SU)(g).getCurrentElementURL},null,8,["label","disable","href"])])),_:1}),(0,a.Wm)(m,{flat:"",bordered:""},{default:(0,a.w5)((()=>[(0,a._)("thead",null,[(0,a._)("tr",I,[(0,a._)("th",E,(0,n.zw)((0,s.SU)(l)("Index")),1),(0,a._)("th",T,(0,n.zw)((0,s.SU)(l)("Title")),1),(0,a._)("th",q,(0,n.zw)((0,s.SU)(l)("Artist")),1),(0,a._)("th",z,(0,n.zw)((0,s.SU)(l)("Album Artist")),1),(0,a._)("th",W,(0,n.zw)((0,s.SU)(l)("Album")),1),(0,a._)("th",Q,(0,n.zw)((0,s.SU)(l)("Album Track nÂº")),1),(0,a._)("th",D,(0,n.zw)((0,s.SU)(l)("Year")),1),(0,a._)("th",Z,(0,n.zw)((0,s.SU)(l)("Actions")),1)])]),v.value?((0,a.wg)(),(0,a.iD)("tbody",A,[(0,a._)("tr",null,[(0,a._)("td",F,[(0,a.wy)((0,a.Wm)(d,{color:"pink",size:"xl",class:"q-ml-sm",thickness:10},null,512),[[i.F8,v.value]])])])])):((0,a.wg)(),(0,a.iD)("tbody",B,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(h.value,((e,t)=>((0,a.wg)(),(0,a.j4)(C,{key:e.id,element:e,index:t,lastIndex:h.value.length,selected:x.value==t,onSetcurrentIndex:e=>y(t),onUp:e=>S(t),onDown:e=>f(t),onToggleFavorite:e=>P(t),disabled:v.value,isPlaying:(0,s.SU)(k).isPlaying,isPaused:(0,s.SU)(k).isPaused,isStopped:(0,s.SU)(k).isStopped},null,8,["element","index","lastIndex","selected","onSetcurrentIndex","onUp","onDown","onToggleFavorite","disabled","isPlaying","isPaused","isStopped"])))),128))]))])),_:1})])),_:1})])),_:1})}}};var L=l(9885),N=l(4458),R=l(2605),H=l(8052),Y=l(6933),G=l(3902);const K=j,M=K;_()(j,"components",{QPage:L.Z,QCard:N.Z,QBreadcrumbs:R.Z,QBreadcrumbsEl:H.Z,QBtnGroup:S.Z,QBtn:f.Z,QMarkupTable:Y.Z,QSpinner:G.Z})}}]);
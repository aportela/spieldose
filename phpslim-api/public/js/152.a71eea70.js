"use strict";(globalThis["webpackChunkspieldose"]=globalThis["webpackChunkspieldose"]||[]).push([[152],{152:(l,e,a)=>{a.r(e),a.d(e,{default:()=>vl});var s=a(9835),t=a(499),o=a(1957),i=a(6970),c=a(1569),n=a(9302),r=a(6647),u=a(8339),d=a(8442);const m={class:"row"},p={class:"col-4"},v=["src"],_={class:"col-4"},y=["src"],g={class:"col-4"},w=["src"],b={class:"row"},f={class:"col-4"},k=["src"],h={class:"col-4"},W=["src"],q={class:"col-4"},x=["src"],C={class:"row"},Z={class:"col-4"},Q=["src"],V={class:"col-4"},S=["src"],P={class:"col-4"},U=["src"],H=["src"],A={class:"q-mr-sm"},D="images/vinyl-small.png",B={__name:"BrowsePlaylistItem",props:{playlist:Object,mode:String},emits:["play","delete"],setup(l,{emit:e}){const a=l,t=(0,s.Fl)((()=>"mosaic"==a.mode)),c=(0,s.Fl)((()=>"vinyls"==a.mode));function n(){e("play",a.playlist.id)}function r(){e("delete",a.playlist.id)}function u(){const l="ABCDEF0123456789";let e="#";while(e.length<7)e+=l.charAt(Math.floor(16*Math.random()+1));return e}return(e,a)=>{const B=(0,s.up)("q-card-section"),I=(0,s.up)("q-separator"),j=(0,s.up)("q-avatar"),T=(0,s.up)("q-btn"),E=(0,s.up)("q-btn-group"),z=(0,s.up)("router-link"),M=(0,s.up)("q-card");return(0,s.wg)(),(0,s.j4)(M,{class:"col-xl-2 col-lg-3 col-md-12 col-sm-12 col-xs-12 shadow-box shadow-10 q-mt-lg",bordered:""},{default:(0,s.w5)((()=>[(0,s.Wm)(B,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(l.playlist.name),1)])),_:1}),(0,s.Wm)(I),t.value?((0,s.wg)(),(0,s.j4)(B,{key:0},{default:(0,s.w5)((()=>[(0,s._)("div",m,[(0,s._)("div",p,[(0,s._)("img",{class:"mosaic_cover_element",src:l.playlist.covers[0]||D},null,8,v)]),(0,s._)("div",_,[(0,s._)("img",{class:"mosaic_cover_element",src:l.playlist.covers[1]||D},null,8,y)]),(0,s._)("div",g,[(0,s._)("img",{class:"mosaic_cover_element",src:l.playlist.covers[2]||D},null,8,w)])]),(0,s._)("div",b,[(0,s._)("div",f,[(0,s._)("img",{class:"mosaic_cover_element",src:l.playlist.covers[3]||D},null,8,k)]),(0,s._)("div",h,[(0,s._)("img",{class:"mosaic_cover_element",src:l.playlist.covers[4]||D},null,8,W)]),(0,s._)("div",q,[(0,s._)("img",{class:"mosaic_cover_element",src:l.playlist.covers[5]||D},null,8,x)])]),(0,s._)("div",C,[(0,s._)("div",Z,[(0,s._)("img",{class:"mosaic_cover_element",src:l.playlist.covers[6]||D},null,8,Q)]),(0,s._)("div",V,[(0,s._)("img",{class:"mosaic_cover_element",src:l.playlist.covers[7]||D},null,8,S)]),(0,s._)("div",P,[(0,s._)("img",{class:"mosaic_cover_element",src:l.playlist.covers[8]||D},null,8,U)])])])),_:1})):c.value?((0,s.wg)(),(0,s.j4)(B,{key:1,style:{height:"140px"}},{default:(0,s.w5)((()=>[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(9,(e=>(0,s.Wm)(j,{key:e,size:"100px",class:"overlapping",style:(0,i.j5)(`left: ${25*e}px`)},{default:(0,s.w5)((()=>[l.playlist.covers[e]?((0,s.wg)(),(0,s.iD)("img",{key:0,src:l.playlist.covers[e],class:(0,i.C_)("mosaic_cover_element rotate-"+45*(e-1))},null,10,H)):((0,s.wg)(),(0,s.iD)("div",{key:1,class:"no_cover",style:(0,i.j5)("background: "+u())},null,4))])),_:2},1032,["style"]))),64))])),_:1})):(0,s.kq)("",!0),(0,s.Wm)(I),(0,s.Wm)(B,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,{spread:"",outline:""},{default:(0,s.w5)((()=>[(0,s.Wm)(T,{label:"play",stack:"",icon:"play_arrow",onClick:(0,o.iM)(n,["prevent"])},null,8,["onClick"]),(0,s.Wm)(T,{label:"edit",stack:"",icon:"edit",disabled:""}),(0,s.Wm)(T,{label:"delete",stack:"",icon:"delete",onClick:(0,o.iM)(r,["prevent"])},null,8,["onClick"])])),_:1})])),_:1}),(0,s.Wm)(I),(0,s.Wm)(B,{class:"text-right"},{default:(0,s.w5)((()=>[(0,s._)("span",A,(0,i.zw)(l.playlist.trackCount)+" track/s",1),(0,s.Wm)(z,{to:{name:"playlistsByUserId",params:{id:l.playlist.owner.id}}},{default:(0,s.w5)((()=>[(0,s.Uk)("by "+(0,i.zw)(l.playlist.owner.name),1)])),_:1},8,["to"]),(0,s.Wm)(d.Z,{className:"q-ml-sm",timestamp:1e3*l.playlist.updated},null,8,["timestamp"])])),_:1})])),_:1})}}};var I=a(4458),j=a(3190),T=a(926),E=a(1357),z=a(7236),M=a(8879),F=a(9984),K=a.n(F);const N=B,Y=N;K()(B,"components",{QCard:I.Z,QCardSection:j.Z,QSeparator:T.Z,QAvatar:E.Z,QBtnGroup:z.Z,QBtn:M.Z});var L=a(8106);const G={class:"row q-gutter-xs"},O={class:"col"},R={class:"col-xl-1 col-lg-2 col-md-3 col-sm-4 col-xs-4"},$={class:"col-xl-1 col-lg-2 col-md-3 col-sm-4 col-xs-4"},J={class:"col-xl-2 col-lg-2 col-md-3 col-sm-4 col-xs-4"},X={key:0,class:"q-pa-lg flex flex-center"},ll={class:"q-gutter-sm row items-start"},el=(0,s._)("span",{class:"q-ml-sm"},"Delete playlist",-1),al=(0,s._)("p",null,"Are you sure ?",-1),sl={__name:"BrowsePlaylistsPage",setup(l){const e=(0,n.Z)(),{t:a}=(0,r.QT)(),d=(0,t.iH)(null),m=(0,t.iH)(!1),p=(0,t.iH)(!1);let v=[];const _=(0,u.yj)(),y=((0,t.iH)("playlistsByUserId"==_.name&&_.params.id?_.params.id:null),(0,t.iH)(0)),g=(0,t.iH)(1),w=[{label:"Name",value:"name"},{label:"Last update",value:"updated"}],b=(0,t.iH)(w[0]),f=[{label:"Ascending",value:"ASC"},{label:"Descending",value:"DESC"}],k=(0,t.iH)(f[0]),h=[{label:"Mosaic",value:"mosaic"},{label:"Vinyl collection",value:"vinyls"}],W=(0,t.iH)(h[0]),q=(0,t.iH)(!1),x=(0,t.iH)(null);function C(l){l&&(g.value=1),m.value=!1,p.value=!0,c.api.playlist.search({name:d.value},g.value,32,b.value.value,k.value.value).then((l=>{v=l.data.data.items,y.value=l.data.data.pager.totalPages,d.value&&l.data.data.pager.totalResults<1&&(m.value=!0),p.value=!1})).catch((l=>{e.notify({type:"negative",message:"API Error: error loading playlists",caption:"API Error: fatal error details: HTTP {"+l.response.status+"} ({"+l.response.statusText+"})"}),p.value=!1}))}function Z(l){g.value=l,C(!1)}function Q(l){L.oS.loadPlaylist(l).then((l=>{})).catch((l=>{e.notify({type:"negative",message:a("API Error: error loading playlist"),caption:a("API Error: fatal error details",{status:l.response.status,statusText:l.response.statusText})})})),p.value=!0,c.api.track.search({playlistId:l},1,0,!1,"playListTrackIndex","ASC").then((l=>{L.oS.saveElements(l.data.data.items.map((l=>({track:l})))),p.value=!1})).catch((l=>{p.value=!1}))}function V(l){q.value=!0,x.value=l}function S(){p.value=!0,c.api.playlist.delete(x.value).then((l=>{p.value=!1,q.value=!1,x.value=null,e.notify({type:"positive",message:"Playlist deleted"}),p.value=!1,C(!0)})).catch((l=>{p.value=!1}))}return C(!0),(l,e)=>{const a=(0,s.up)("q-breadcrumbs-el"),c=(0,s.up)("q-breadcrumbs"),n=(0,s.up)("q-icon"),r=(0,s.up)("q-input"),u=(0,s.up)("q-select"),_=(0,s.up)("q-pagination"),x=(0,s.up)("q-avatar"),P=(0,s.up)("q-card-section"),U=(0,s.up)("q-btn"),H=(0,s.up)("q-card-actions"),A=(0,s.up)("q-card"),D=(0,s.up)("q-dialog"),B=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(A,{class:"q-pa-lg"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"q-mb-lg"},{default:(0,s.w5)((()=>[(0,s.Wm)(a,{icon:"home",label:"Spieldose"}),(0,s.Wm)(a,{icon:"list",label:"Browse playlists"})])),_:1}),(0,t.SU)(v)?((0,s.wg)(),(0,s.j4)(P,{key:0},{default:(0,s.w5)((()=>[(0,s._)("div",G,[(0,s._)("div",O,[(0,s.Wm)(r,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=l=>d.value=l),clearable:"",type:"search",outlined:"",dense:"",placeholder:"Text condition",hint:"Search playlists with name",loading:p.value,disable:p.value,onKeydown:e[1]||(e[1]=(0,o.D2)((0,o.iM)((l=>C(!0)),["prevent"]),["enter"])),onClear:e[2]||(e[2]=l=>{m.value=!1,C(!0)}),error:m.value,errorMessage:"No playlists found with specified condition"},{prepend:(0,s.w5)((()=>[(0,s.Wm)(n,{name:"filter_alt"})])),append:(0,s.w5)((()=>[(0,s.Wm)(n,{name:"search",class:"cursor-pointer",onClick:C})])),_:1},8,["modelValue","loading","disable","error"])]),(0,s._)("div",R,[(0,s.Wm)(u,{outlined:"",dense:"",modelValue:b.value,"onUpdate:modelValue":[e[3]||(e[3]=l=>b.value=l),e[4]||(e[4]=l=>C(!0))],options:w,"options-dense":"",label:"Sort field",disable:p.value},{"selected-item":(0,s.w5)((l=>[(0,s.Uk)((0,i.zw)(l.opt.label),1)])),_:1},8,["modelValue","disable"])]),(0,s._)("div",$,[(0,s.Wm)(u,{outlined:"",dense:"",modelValue:k.value,"onUpdate:modelValue":[e[5]||(e[5]=l=>k.value=l),e[6]||(e[6]=l=>C(!0))],options:f,"options-dense":"",label:"Sort order",disable:p.value},{"selected-item":(0,s.w5)((l=>[(0,s.Uk)((0,i.zw)(l.opt.label),1)])),_:1},8,["modelValue","disable"])]),(0,s._)("div",J,[(0,s.Wm)(u,{outlined:"",dense:"",modelValue:W.value,"onUpdate:modelValue":e[7]||(e[7]=l=>W.value=l),options:h,"options-dense":"",label:"Style",disable:p.value},{"selected-item":(0,s.w5)((l=>[(0,s.Uk)((0,i.zw)(l.opt.label),1)])),_:1},8,["modelValue","disable"])])]),y.value>1?((0,s.wg)(),(0,s.iD)("div",X,[(0,s.Wm)(_,{modelValue:g.value,"onUpdate:modelValue":[e[8]||(e[8]=l=>g.value=l),Z],color:"dark",max:y.value,"max-pages":5,"boundary-numbers":"","direction-links":"","boundary-links":"",disable:p.value},null,8,["modelValue","max","disable"])])):(0,s.kq)("",!0),(0,s._)("div",ll,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,t.SU)(v),(l=>((0,s.wg)(),(0,s.j4)(Y,{key:l.id,playlist:l,mode:W.value.value,onPlay:e=>Q(l.id),onDelete:e=>V(l.id)},null,8,["playlist","mode","onPlay","onDelete"])))),128))]),(0,s.Wm)(D,{modelValue:q.value,"onUpdate:modelValue":e[9]||(e[9]=l=>q.value=l),persistent:""},{default:(0,s.w5)((()=>[(0,s.Wm)(A,null,{default:(0,s.w5)((()=>[(0,s.Wm)(P,{class:"row items-center"},{default:(0,s.w5)((()=>[(0,s.Wm)(x,{icon:"info"}),el])),_:1}),(0,s.Wm)(P,null,{default:(0,s.w5)((()=>[al])),_:1}),(0,s.Wm)(H,{align:"right"},{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(U,{flat:"",label:"Cancel",color:"primary"},null,512),[[B]]),(0,s.Wm)(U,{flat:"",label:"YES",color:"primary",onClick:S})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})):(0,s.kq)("",!0)])),_:1})}}};var tl=a(2605),ol=a(8052),il=a(6611),cl=a(2857),nl=a(6384),rl=a(996),ul=a(2074),dl=a(1821),ml=a(2146);const pl=sl,vl=pl;K()(sl,"components",{QCard:I.Z,QBreadcrumbs:tl.Z,QBreadcrumbsEl:ol.Z,QCardSection:j.Z,QInput:il.Z,QIcon:cl.Z,QSelect:nl.Z,QPagination:rl.Z,QDialog:ul.Z,QAvatar:E.Z,QCardActions:dl.Z,QBtn:M.Z}),K()(sl,"directives",{ClosePopup:ml.Z})}}]);
"use strict";(globalThis["webpackChunkspieldose"]=globalThis["webpackChunkspieldose"]||[]).push([[152],{8106:(e,l,a)=>{a.d(l,{dC:()=>r,oS:()=>c});var t=a(6223),s=a(2719),n=a(1569),o=a(4867);const i=(0,s.d)(),r={setFavorite:function(e){return new Promise(((l,a)=>{n.api.track.setFavorite(e).then((a=>{o.spieldoseEvents.emit.track.setFavorite(e,a.data.favorited),l(a)})).catch((e=>{a(e)}))}))},unSetFavorite:function(e){return new Promise(((l,a)=>{n.api.track.unSetFavorite(e).then((a=>{o.spieldoseEvents.emit.track.unSetFavorite(e),l(a)})).catch((e=>{a(e)}))}))},play:function(e){t.spieldosePlayer.interact(),t.spieldosePlayer.isStopped()||t.spieldosePlayer.actions.stop(),i.saveElements(Array.isArray(e)?e:[{track:e}]),t.spieldosePlayer.actions.play(!0)},enqueue:function(e){player.interact(),i.appendElements(Array.isArray(e)?e:[{track:e}])}},c={saveElements:function(e){i.saveElements(e)},appendElements:function(e){i.appendElements(e)},clear:function(){i.clear()},skipPrevious:function(){i.skipPrevious()},skipNext:function(){i.skipNext()}}},2719:(e,l,a)=>{a.d(l,{d:()=>r});var t=a(1809),s=a(8612),n=a.n(s),o=a(6223);const i={namespace:"spieldose",storages:["local","cookie","session","memory"],storage:"local",expireDays:3650},r=(0,t.Q_)("currentPlaylist",{state:()=>({elements:[],shuffleIndexes:[],currentIndex:-1,elementsLastChangeTimestamp:null}),getters:{hasElements:e=>e.elements&&e.elements.length>0,getElements:e=>e.elements,elementCount:e=>e.elements?e.elements.length:0,getElementsLastChangeTimestamp:e=>e.elementsLastChangeTimestamp,getCurrentIndex:e=>o.spieldosePlayer.getShuffle()?e.shuffleIndexes[e.currentIndex]:e.currentIndex,getCurrentElement:e=>e.currentIndex>=0&&e.elements.length>0?e.elements[e.currentIndex]:null,getCurrentElementURL:e=>e.currentIndex>=0&&e.elements.length>0?e.elements[e.currentIndex].url:null,allowSkipPrevious:e=>e.currentIndex>0&&e.elements.length>0,allowSkipNext:e=>e.currentIndex>=0&&e.elements.length>0&&e.currentIndex<e.elements.length-1,allowPlay:e=>!0,allowPause:e=>!0,allowResume:e=>!0,allowStop:e=>!0},actions:{load(){const e=n()(i),l=e.get("currentPlaylistElements");l&&(this.elements=l);const a=e.get("shuffleIndexes");a&&(this.shuffleIndexes=a);const t=e.get("currentPlaylistElementIndex");t>=0&&(this.currentIndex=t)},saveCurrentElements(){const e=n()(i);e.set("currentPlaylistElements",this.elements),e.set("currentPlaylistElementIndex",this.currentIndex),e.set("shuffleIndexes",this.shuffleIndexes),this.elementsLastChangeTimestamp=Date.now()},saveElements(e){this.elements=e,this.shuffleIndexes=[...Array(e.length).keys()].sort((function(){return.5-Math.random()})),this.currentIndex=e&&e.length>0?0:-1,this.saveCurrentElements()},appendElements(e){this.elements=this.elements.concat(e),this.saveCurrentElements()},saveCurrentTrackIndex(e){this.currentIndex=e>=0?e:-1;const l=n()(i);l.set("currentPlaylistElementIndex",this.currentIndex)},skipPrevious(){this.saveCurrentTrackIndex(--this.currentIndex)},skipNext(){this.saveCurrentTrackIndex(++this.currentIndex)},clear(){this.elements=[],this.saveCurrentElements()}}})},152:(e,l,a)=>{a.r(l),a.d(l,{default:()=>pe});var t=a(9835),s=a(499),n=a(1957),o=a(6970),i=a(1569),r=a(9302),c=a(8339),u=a(4376);const d={class:"text-center"},m={class:"row"},p={class:"col-4"},v=["src"],y={class:"col-4"},g=["src"],h={class:"col-4"},_=["src"],f={class:"row"},w={class:"col-4"},x=["src"],k={class:"col-4"},b=["src"],I={class:"col-4"},C=["src"],P={class:"row"},E={class:"col-4"},W=["src"],q={class:"col-4"},S=["src"],Z={class:"col-4"},Q=["src"],V=["src"],D="images/vinyl-small.png",U={__name:"BrowsePlaylistItem",props:{playlist:Object,mode:String},emits:["play","delete"],setup(e,{emit:l}){const a=e,i=(0,t.Fl)((()=>"mosaic"==a.mode)),r=(0,t.Fl)((()=>"vinyls"==a.mode));function c(){l("play",a.playlist.id)}function U(){l("delete",a.playlist.id)}function A(){const e="ABCDEF0123456789";let l="#";while(l.length<7)l+=e.charAt(Math.floor(16*Math.random()+1));return l}return(l,a)=>{const H=(0,t.up)("q-card-section"),T=(0,t.up)("q-separator"),B=(0,t.up)("q-avatar"),j=(0,t.up)("q-btn"),M=(0,t.up)("q-btn-group"),F=(0,t.up)("router-link"),z=(0,t.up)("q-icon"),L=(0,t.up)("q-card");return(0,t.wg)(),(0,t.j4)(L,{class:"col-xl-2 col-lg-3 col-md-12 col-sm-12 col-xs-12 shadow-box shadow-10 q-mt-lg",bordered:""},{default:(0,t.w5)((()=>[(0,t.Wm)(H,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.playlist.name)+" ",1),(0,t._)("p",d,"("+(0,o.zw)(e.playlist.trackCount)+" track/s)",1)])),_:1}),(0,t.Wm)(T),i.value?((0,t.wg)(),(0,t.j4)(H,{key:0},{default:(0,t.w5)((()=>[(0,t._)("div",m,[(0,t._)("div",p,[(0,t._)("img",{class:"mosaic_cover_element",src:e.playlist.covers[0]||D},null,8,v)]),(0,t._)("div",y,[(0,t._)("img",{class:"mosaic_cover_element",src:e.playlist.covers[1]||D},null,8,g)]),(0,t._)("div",h,[(0,t._)("img",{class:"mosaic_cover_element",src:e.playlist.covers[2]||D},null,8,_)])]),(0,t._)("div",f,[(0,t._)("div",w,[(0,t._)("img",{class:"mosaic_cover_element",src:e.playlist.covers[3]||D},null,8,x)]),(0,t._)("div",k,[(0,t._)("img",{class:"mosaic_cover_element",src:e.playlist.covers[4]||D},null,8,b)]),(0,t._)("div",I,[(0,t._)("img",{class:"mosaic_cover_element",src:e.playlist.covers[5]||D},null,8,C)])]),(0,t._)("div",P,[(0,t._)("div",E,[(0,t._)("img",{class:"mosaic_cover_element",src:e.playlist.covers[6]||D},null,8,W)]),(0,t._)("div",q,[(0,t._)("img",{class:"mosaic_cover_element",src:e.playlist.covers[7]||D},null,8,S)]),(0,t._)("div",Z,[(0,t._)("img",{class:"mosaic_cover_element",src:e.playlist.covers[8]||D},null,8,Q)])])])),_:1})):r.value?((0,t.wg)(),(0,t.j4)(H,{key:1,style:{height:"140px"}},{default:(0,t.w5)((()=>[((0,t.wg)(),(0,t.iD)(t.HY,null,(0,t.Ko)(9,(l=>(0,t.Wm)(B,{key:l,size:"100px",class:"overlapping",style:(0,o.j5)(`left: ${25*l}px`)},{default:(0,t.w5)((()=>[e.playlist.covers[l]?((0,t.wg)(),(0,t.iD)("img",{key:0,src:e.playlist.covers[l],class:(0,o.C_)("mosaic_cover_element rotate-"+45*(l-1))},null,10,V)):((0,t.wg)(),(0,t.iD)("div",{key:1,class:"no_cover",style:(0,o.j5)("background: "+A())},null,4))])),_:2},1032,["style"]))),64))])),_:1})):(0,t.kq)("",!0),(0,t.Wm)(T),(0,t.Wm)(H,null,{default:(0,t.w5)((()=>[(0,t.Wm)(M,{spread:"",outline:""},{default:(0,t.w5)((()=>[(0,t.Wm)(j,{label:"play",stack:"",icon:"play_arrow",onClick:(0,n.iM)(c,["prevent"])},null,8,["onClick"]),(0,t.Wm)(j,{label:"edit",stack:"",icon:"edit",disabled:""}),(0,t.Wm)(j,{label:"delete",stack:"",icon:"delete",onClick:(0,n.iM)(U,["prevent"])},null,8,["onClick"])])),_:1})])),_:1}),(0,t.Wm)(T),(0,t.Wm)(H,{class:"text-right"},{default:(0,t.w5)((()=>[(0,t.Wm)(F,{to:{name:"playlistsByUserId",params:{id:e.playlist.owner.id}}},{default:(0,t.w5)((()=>[(0,t.Uk)("by "+(0,o.zw)(e.playlist.owner.name),1)])),_:1},8,["to"]),(0,t.Wm)(z,{name:"clock",size:"xs",title:"last update: "+(0,s.SU)(u.ZP).formatDate(1e3*e.playlist.updated,"YYYY-MM-DD HH:mm:ss Z")},null,8,["title"])])),_:1})])),_:1})}}};var A=a(4458),H=a(3190),T=a(926),B=a(1357),j=a(7236),M=a(8879),F=a(2857),z=a(9984),L=a.n(z);const Y=U,N=Y;L()(U,"components",{QCard:A.Z,QCardSection:H.Z,QSeparator:T.Z,QAvatar:B.Z,QBtnGroup:j.Z,QBtn:M.Z,QIcon:F.Z});var K=a(8106);const R={class:"row q-gutter-xs"},G={class:"col"},O={class:"col-xl-1 col-lg-2 col-md-3 col-sm-4 col-xs-4"},$={class:"col-xl-1 col-lg-2 col-md-3 col-sm-4 col-xs-4"},J={class:"col-xl-2 col-lg-2 col-md-3 col-sm-4 col-xs-4"},X={key:0,class:"q-pa-lg flex flex-center"},ee={class:"q-gutter-sm row items-start"},le=(0,t._)("span",{class:"q-ml-sm"},"Delete playlist",-1),ae=(0,t._)("p",null,"Are you sure ?",-1),te={__name:"BrowsePlaylistsPage",setup(e){const l=(0,r.Z)(),a=(0,t.f3)("spieldosePlayer"),u=(0,s.iH)(null),d=(0,s.iH)(!1),m=(0,s.iH)(!1);let p=[];const v=(0,c.yj)(),y=((0,s.iH)("playlistsByUserId"==v.name&&v.params.id?v.params.id:null),(0,s.iH)(0)),g=(0,s.iH)(1),h=[{label:"Name",value:"name"},{label:"Last update",value:"updated"}],_=(0,s.iH)(h[0]),f=[{label:"Ascending",value:"ASC"},{label:"Descending",value:"DESC"}],w=(0,s.iH)(f[0]),x=[{label:"Mosaic",value:"mosaic"},{label:"Vinyl collection",value:"vinyls"}],k=(0,s.iH)(x[0]),b=(0,s.iH)(!1),I=(0,s.iH)(null);function C(e){e&&(g.value=1),d.value=!1,m.value=!0,i.api.playlist.search({name:u.value},g.value,32,_.value.value,w.value.value).then((e=>{p=e.data.data.items,y.value=e.data.data.pager.totalPages,u.value&&e.data.data.pager.totalResults<1&&(d.value=!0),m.value=!1})).catch((e=>{l.notify({type:"negative",message:"API Error: error loading playlists",caption:"API Error: fatal error details: HTTP {"+e.response.status+"} ({"+e.response.statusText+"})"}),m.value=!1}))}function P(e){g.value=e,C(!1)}function E(e){a.interact(),m.value=!0,i.api.track.search({playlistId:e},1,0,!1,"playListTrackIndex","ASC").then((e=>{K.oS.saveElements(e.data.data.items.map((e=>({track:e})))),m.value=!1})).catch((e=>{m.value=!1}))}function W(e){b.value=!0,I.value=e}function q(){m.value=!0,i.api.playlist.delete(I.value).then((e=>{m.value=!1,b.value=!1,I.value=null,l.notify({type:"positive",message:"Playlist deleted"}),m.value=!1,C(!0)})).catch((e=>{m.value=!1}))}return C(!0),(e,l)=>{const a=(0,t.up)("q-breadcrumbs-el"),i=(0,t.up)("q-breadcrumbs"),r=(0,t.up)("q-icon"),c=(0,t.up)("q-input"),v=(0,t.up)("q-select"),I=(0,t.up)("q-pagination"),S=(0,t.up)("q-avatar"),Z=(0,t.up)("q-card-section"),Q=(0,t.up)("q-btn"),V=(0,t.up)("q-card-actions"),D=(0,t.up)("q-card"),U=(0,t.up)("q-dialog"),A=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(D,{class:"q-pa-lg"},{default:(0,t.w5)((()=>[(0,t.Wm)(i,{class:"q-mb-lg"},{default:(0,t.w5)((()=>[(0,t.Wm)(a,{icon:"home",label:"Spieldose"}),(0,t.Wm)(a,{icon:"list",label:"Browse playlists"})])),_:1}),(0,s.SU)(p)?((0,t.wg)(),(0,t.j4)(Z,{key:0},{default:(0,t.w5)((()=>[(0,t._)("div",R,[(0,t._)("div",G,[(0,t.Wm)(c,{modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=e=>u.value=e),clearable:"",type:"search",outlined:"",dense:"",placeholder:"Text condition",hint:"Search playlists with name",loading:m.value,disable:m.value,onKeydown:l[1]||(l[1]=(0,n.D2)((0,n.iM)((e=>C(!0)),["prevent"]),["enter"])),onClear:l[2]||(l[2]=e=>{d.value=!1,C(!0)}),error:d.value,errorMessage:"No playlists found with specified condition"},{prepend:(0,t.w5)((()=>[(0,t.Wm)(r,{name:"filter_alt"})])),append:(0,t.w5)((()=>[(0,t.Wm)(r,{name:"search",class:"cursor-pointer",onClick:C})])),_:1},8,["modelValue","loading","disable","error"])]),(0,t._)("div",O,[(0,t.Wm)(v,{outlined:"",dense:"",modelValue:_.value,"onUpdate:modelValue":[l[3]||(l[3]=e=>_.value=e),l[4]||(l[4]=e=>C(!0))],options:h,"options-dense":"",label:"Sort field",disable:m.value},{"selected-item":(0,t.w5)((e=>[(0,t.Uk)((0,o.zw)(e.opt.label),1)])),_:1},8,["modelValue","disable"])]),(0,t._)("div",$,[(0,t.Wm)(v,{outlined:"",dense:"",modelValue:w.value,"onUpdate:modelValue":[l[5]||(l[5]=e=>w.value=e),l[6]||(l[6]=e=>C(!0))],options:f,"options-dense":"",label:"Sort order",disable:m.value},{"selected-item":(0,t.w5)((e=>[(0,t.Uk)((0,o.zw)(e.opt.label),1)])),_:1},8,["modelValue","disable"])]),(0,t._)("div",J,[(0,t.Wm)(v,{outlined:"",dense:"",modelValue:k.value,"onUpdate:modelValue":l[7]||(l[7]=e=>k.value=e),options:x,"options-dense":"",label:"Style",disable:m.value},{"selected-item":(0,t.w5)((e=>[(0,t.Uk)((0,o.zw)(e.opt.label),1)])),_:1},8,["modelValue","disable"])])]),y.value>1?((0,t.wg)(),(0,t.iD)("div",X,[(0,t.Wm)(I,{modelValue:g.value,"onUpdate:modelValue":[l[8]||(l[8]=e=>g.value=e),P],color:"dark",max:y.value,"max-pages":5,"boundary-numbers":"","direction-links":"","boundary-links":"",disable:m.value},null,8,["modelValue","max","disable"])])):(0,t.kq)("",!0),(0,t._)("div",ee,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,s.SU)(p),(e=>((0,t.wg)(),(0,t.j4)(N,{key:e.id,playlist:e,mode:k.value.value,onPlay:l=>E(e.id),onDelete:l=>W(e.id)},null,8,["playlist","mode","onPlay","onDelete"])))),128))]),(0,t.Wm)(U,{modelValue:b.value,"onUpdate:modelValue":l[9]||(l[9]=e=>b.value=e),persistent:""},{default:(0,t.w5)((()=>[(0,t.Wm)(D,null,{default:(0,t.w5)((()=>[(0,t.Wm)(Z,{class:"row items-center"},{default:(0,t.w5)((()=>[(0,t.Wm)(S,{icon:"info"}),le])),_:1}),(0,t.Wm)(Z,null,{default:(0,t.w5)((()=>[ae])),_:1}),(0,t.Wm)(V,{align:"right"},{default:(0,t.w5)((()=>[(0,t.wy)((0,t.Wm)(Q,{flat:"",label:"Cancel",color:"primary"},null,512),[[A]]),(0,t.Wm)(Q,{flat:"",label:"YES",color:"primary",onClick:q})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})):(0,t.kq)("",!0)])),_:1})}}};var se=a(2605),ne=a(8052),oe=a(6611),ie=a(6384),re=a(996),ce=a(2074),ue=a(1821),de=a(2146);const me=te,pe=me;L()(te,"components",{QCard:A.Z,QBreadcrumbs:se.Z,QBreadcrumbsEl:ne.Z,QCardSection:H.Z,QInput:oe.Z,QIcon:F.Z,QSelect:ie.Z,QPagination:re.Z,QDialog:ce.Z,QAvatar:B.Z,QCardActions:ue.Z,QBtn:M.Z}),L()(te,"directives",{ClosePopup:de.Z})}}]);
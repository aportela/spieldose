"use strict";(globalThis["webpackChunkspieldose"]=globalThis["webpackChunkspieldose"]||[]).push([[891],{8106:(e,t,a)=>{a.d(t,{dC:()=>o});var l=a(4958),n=a(2719),s=a(1569);const i=(0,l.n)(),r=(0,n.d)(),o={setFavorite:function(e){return new Promise(((t,a)=>{s.api.track.setFavorite(e).then((a=>{r.setFavoriteTrack(e,a.data.favorited),t(a)})).catch((e=>{a(e)}))}))},unSetFavorite:function(e){return new Promise(((t,a)=>{s.api.track.unSetFavorite(e).then((a=>{r.unSetFavoriteTrack(e),t(a)})).catch((e=>{a(e)}))}))},play:function(e){i.stop(),r.saveElements(Array.isArray(e)?e:[{track:e}]),i.interact(),i.play(!0)},enqueue:function(e){r.appendElements(Array.isArray(e)?e:[{track:e}]),i.interact()}}},2719:(e,t,a)=>{a.d(t,{d:()=>r});var l=a(1809),n=a(8612),s=a.n(n);const i={namespace:"spieldose",storages:["local","cookie","session","memory"],storage:"local",expireDays:3650},r=(0,l.Q_)("currentPlaylist",{state:()=>({elements:[],currentIndex:-1,elementsLastChangeTimestamp:null}),getters:{hasElements:e=>e.elements&&e.elements.length>0,getElements:e=>e.elements,getElementsLastChangeTimestamp:e=>e.elementsLastChangeTimestamp,getCurrentIndex:e=>e.currentIndex,getCurrentElement:e=>e.currentIndex>=0&&e.elements.length>0?e.elements[e.currentIndex]:null,getCurrentElementURL:e=>e.currentIndex>=0&&e.elements.length>0?e.elements[e.currentIndex].url:null,allowSkipPrevious:e=>e.currentIndex>0&&e.elements.length>0,allowSkipNext:e=>e.currentIndex>=0&&e.elements.length>0&&e.currentIndex<e.elements.length-1,allowPlay:e=>!0,allowPause:e=>!0,allowResume:e=>!0,allowStop:e=>!0},actions:{load(){const e=s()(i),t=e.get("currentPlaylistElements");t&&(this.elements=t);const a=e.get("currentPlaylistElementIndex");a>=0&&(this.currentIndex=a)},saveCurrentElements(){const e=s()(i);e.set("currentPlaylistElements",this.elements),e.set("currentPlaylistElementIndex",this.currentIndex),this.elementsLastChangeTimestamp=Date.now()},saveElements(e){this.elements=e,this.currentIndex=e&&e.length>0?0:-1,this.saveCurrentElements()},appendElements(e){this.elements=this.elements.concat(e),this.saveCurrentElements()},saveCurrentTrackIndex(e){this.currentIndex=e>=0?e:-1;const t=s()(i);t.set("currentPlaylistElementIndex",this.currentIndex)},skipPrevious(){this.currentIndex--},skipNext(){this.currentIndex++},clear(){this.elements=[],this.currentIndex=-1;const e=s()(i);e.set("currentPlaylistElements",[]),e.set(-1),this.elementsLastChangeTimestamp=Date.now()},setFavoriteTrack(e,t){const a=this.elements.findIndex((t=>t.track&&t.track.id==e));-1!==a&&(this.elements[a].track.favorited=t,this.saveCurrentElements())},unSetFavoriteTrack(e){const t=this.elements.findIndex((t=>t.track&&t.track.id==e));-1!==t&&(this.elements[t].track.favorited=null,this.saveCurrentElements())}}})},4958:(e,t,a)=>{a.d(t,{n:()=>i});var l=a(1809),n=a(1320);const s=(0,n.l)(),i=(0,l.Q_)("player",{state:()=>({element:null,hasPreviousUserInteractions:!1}),getters:{getElement:e=>e.element,getDuration:e=>e.element.duration},actions:{interact(){this.hasPreviousUserInteractions=!0},create(){this.element=document.createElement("audio"),this.element.id="audio_player",this.element.crossOrigin="anonymous"},setVolume(e){this.element.volume=e},setCurrentTime(e){this.element.currentTime=e},stop(){this.element.pause(),s.setStatusStopped()},load(){},play(e){e?(this.element.play(),s.setStatusPlaying()):s.isPlaying?(this.element.pause(),s.setStatusPaused()):s.isPaused?(this.element.play(),s.setStatusPlaying()):(this.element.load(),this.element.play(),s.setStatusPlaying())}}})},1320:(e,t,a)=>{a.d(t,{l:()=>n});var l=a(1809);const n=(0,l.Q_)("playerStatus",{state:()=>({status:"stopped"}),getters:{getStatus(e){return e.status},isPlaying(e){return"playing"==e.status},isStopped(e){return"stopped"==e.status},isPaused(e){return"paused"==e.status}},actions:{setStatusPlaying(){this.status="playing"},setStatusStopped(){this.status="stopped"},setStatusPaused(){this.status="paused"}}})},7891:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ct});a(9665);var l=a(9835),n=a(499),s=a(6970),i=a(8339),r=a(1569),o=a(5253),u=a(9302),c=a(7712),d=a(4537),m=a(4958),p=a(1320),v=a(2719),g=a(1957);const k="background: url(images/vinyl.png) no-repeat; background-size: cover;",b={__name:"SidebarPlayerAlbumCover",props:{rotateVinyl:Boolean,smallVinylImage:String,coverImage:String},setup(e){const t=e,a=(0,n.iH)(null),i=(0,n.iH)(null),r=(0,l.Fl)((()=>t.smallVinylImage)),o=(0,l.Fl)((()=>t.coverImage));(0,l.YP)(r,(e=>{a.value=e})),(0,l.YP)(o,(e=>{i.value=e})),a.value=r.value,i.value=o.value;const u=(0,n.iH)(!1);function c(){u.value=!u.value}return(t,n)=>{const r=(0,l.up)("q-img");return u.value?((0,l.wg)(),(0,l.iD)("div",{key:0,id:"vinyl_container",class:(0,s.C_)({rotation_enabled:e.rotateVinyl}),style:k,onClick:c},[a.value?((0,l.wg)(),(0,l.j4)(r,{key:0,src:a.value,onError:n[0]||(n[0]=e=>a.value=null),"img-class":"vinyl_mini_cover","no-spinner":""},null,8,["src"])):(0,l.kq)("",!0)],2)):((0,l.wg)(),(0,l.iD)("div",{key:1,id:"cover_container",onClick:c},[i.value?((0,l.wg)(),(0,l.j4)(r,{key:0,src:i.value,onError:n[1]||(n[1]=e=>i.value=null),alt:"Album cover",width:"400px",height:"400px","spinner-color":"pink"},null,8,["src"])):((0,l.wg)(),(0,l.j4)(r,{key:1,src:"images/vinyl.png",alt:"Vinyl",width:"400px",height:"400px"}))]))}}};var w=a(335),f=a(9984),_=a.n(f);const y=b,h=y;_()(b,"components",{QImg:w.Z});var S=a(6574);const x={__name:"SidebarPlayerSpectrumAnalyzer",setup(e){const t=(0,m.n)(),a=(0,n.iH)(t.getElement),s=(0,n.iH)(null),i=(0,n.iH)(4);function r(){if(!s.value){s.value=new S.Z(document.getElementById("analyzer-container"),{source:a.value,mode:i.value,height:40,ledBars:!1,showScaleX:!1,showScaleY:!1,stereo:!1,splitGradient:!1,start:!1,bgAlpha:1,overlay:!0,showBgColor:!0});const e={bgColor:"#fff",dir:"v",colorStops:["#d30320","#e399a3"]};s.value.registerGradient("my-grad",e),s.value.gradient="my-grad"}s.value.isOn||s.value.toggleAnalyzer()}function o(){i.value++,i.value>8&&(i.value=0),s.value.setOptions({mode:i.value})}return(0,l.bv)((()=>{r()})),(e,t)=>((0,l.wg)(),(0,l.iD)("div",{id:"analyzer-container",style:{height:"50px"},class:"cursor-pointer",onClick:o}))}},W=x,q=W,P={__name:"SidebarPlayerVolumeControl",props:{disabled:Boolean,defaultValue:Number},emits:["volumeChange"],setup(e,{emit:t}){const a=e,i=(0,n.iH)(0),r=(0,n.iH)(a.defaultValue||1),o=(0,n.iH)(!1);(0,l.YP)(r,((e,t)=>{e>0&&o.value&&(o.value=!1)}));const u=(0,l.Fl)((()=>0==r.value?"volume_off":r.value<.4?"volume_mute":r.value<.7?"volume_down":"volume_up")),c=(0,l.Fl)((()=>Math.round(100*r.value)));function d(){o.value?r.value=i.value:(i.value=r.value,r.value=0),o.value=!o.value,t("volumeChange",r.value)}function m(e){t("volumeChange",e)}return(t,a)=>{const n=(0,l.up)("q-icon"),i=(0,l.up)("q-item-section"),p=(0,l.up)("q-slider"),v=(0,l.up)("q-item"),k=(0,l.up)("q-list");return(0,l.wg)(),(0,l.j4)(k,null,{default:(0,l.w5)((()=>[(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(i,{side:""},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{class:(0,s.C_)(["cursor-pointer",{"text-pink":o.value}]),name:u.value,onClick:(0,g.iM)(d,["prevent"])},null,8,["name","onClick","class"])])),_:1}),(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p,{disable:e.disabled,modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=e=>r.value=e),min:0,max:1,step:.05,label:"","label-value":c.value+"%",onChange:a[1]||(a[1]=e=>m(r.value))},null,8,["disable","modelValue","label-value"])])),_:1}),(0,l.Wm)(i,{side:""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(c.value)+"% ",1)])),_:1})])),_:1})])),_:1})}}};var E=a(3246),I=a(490),C=a(1233),T=a(2857),z=a(8423);const Q=P,Z=Q;_()(P,"components",{QList:E.Z,QItem:I.Z,QItemSection:C.Z,QIcon:T.Z,QSlider:z.Z});const U={key:0,id:"song_info",class:"q-px-md",style:{"max-width":"400px"}},A=["title"],D=["title"],L={class:"song_info_artist text-center ellipsis"},H={key:1},N={key:1,id:"song_info"},V=["title"],F={class:"song_info_album text-center"},j={class:"song_info_artist text-center"},B=["href"],M=(0,l._)("span",null," ",-1),R={__name:"SidebarPlayerTrackInfo",props:{currentElement:Object},setup(e){return(t,a)=>{const n=(0,l.up)("router-link"),i=(0,l.up)("q-btn"),r=(0,l.up)("q-btn-group");return e.currentElement&&e.currentElement.track?((0,l.wg)(),(0,l.iD)("div",U,[(0,l._)("p",{class:"song_info_track text-center text-weight-bolder ellipsis",style:{color:"#d30320"},title:e.currentElement.track.title||" "},(0,s.zw)(e.currentElement.track.title||null),9,A),(0,l._)("p",{class:"song_info_album text-center ellipsis",title:e.currentElement.track.album.title||null},(0,s.zw)(e.currentElement.track.album.title||" "),9,D),(0,l._)("p",L,[e.currentElement.track.artist.name?((0,l.wg)(),(0,l.j4)(n,{key:0,style:{"text-decoration":"none"},to:{name:"artist",params:{name:e.currentElement.track.artist.name}},title:e.currentElement.track.artist.name},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.currentElement.track.artist.name),1)])),_:1},8,["to","title"])):((0,l.wg)(),(0,l.iD)("span",H," "))])])):e.currentElement&&e.currentElement.radioStation?((0,l.wg)(),(0,l.iD)("div",N,[(0,l._)("p",{class:"song_info_track text-center text-weight-bolder ellipsis",style:{color:"#d30320"},title:e.currentElement.radioStation.name},(0,s.zw)(e.currentElement.radioStation.name||" "),9,V),(0,l._)("p",F,[(0,l.Wm)(r,{outline:""},{default:(0,l.w5)((()=>[(0,l.Wm)(i,{outline:"",size:"sm",icon:"playlist_play",label:"playlist",disable:!e.currentElement.radioStation.playlist,href:e.currentElement.radioStation.playlist,target:"_new"},null,8,["disable","href"]),(0,l.Wm)(i,{outline:"",size:"sm",icon:"play_arrow",label:"direct stream",disable:!e.currentElement.radioStation.directStream,href:e.currentElement.radioStation.directStream,target:"_new"},null,8,["disable","href"])])),_:1})]),(0,l._)("p",j,[e.currentElement.radioStation.url?((0,l.wg)(),(0,l.iD)("a",{key:0,href:e.currentElement.radioStation.url,target:"_blank",style:{"text-decoration":"none"}},(0,s.zw)(e.currentElement.radioStation.url),9,B)):(0,l.kq)("",!0),M])])):(0,l.kq)("",!0)}}};var Y=a(7236),G=a(8879);const O=R,K=O;_()(R,"components",{QBtnGroup:Y.Z,QBtn:G.Z});const X={id:"player_controls"},$={class:"q-pa-md q-gutter-sm text-center"},J={__name:"SidebarPlayerMainControls",props:{disabled:Boolean,allowSkipPrevious:Boolean,allowPlay:Boolean,allowSkipNext:Boolean,isPlaying:Boolean},emits:["skipPrevious","play","skipNext"],setup(e,{emit:t}){function a(){t("play")}function n(){t("skipPrevious")}function i(){t("skipNext")}return(t,r)=>{const o=(0,l.up)("q-icon"),u=(0,l.up)("q-btn");return(0,l.wg)(),(0,l.iD)("div",X,[(0,l._)("div",$,[(0,l.Wm)(u,{round:"",dense:"",size:"md",disable:e.disabled||!e.allowSkipPrevious,onClick:n},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{name:"skip_previous",title:"Skip to previous track"})])),_:1},8,["disable"]),(0,l.Wm)(u,{round:"",dense:"",size:"lg",disable:e.disabled||!e.allowPlay,onClick:a,class:"q-mx-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{name:e.isPlaying?"pause":"play_arrow",title:"Play/Pause/Resume track",class:(0,s.C_)({"text-pink-6":e.isPlaying})},null,8,["name","class"])])),_:1},8,["disable"]),(0,l.Wm)(u,{round:"",dense:"",size:"md",disable:e.disabled||!e.allowSkipNext,onClick:i},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{name:"skip_next",title:"Skip to next track"})])),_:1},8,["disable"])])])}}},ee=J,te=ee;_()(J,"components",{QBtn:G.Z,QIcon:T.Z});const ae={__name:"SidebarPlayerSeekControl",props:{disabled:Boolean,currentElementTimeData:Object},emits:["seek"],setup(e,{emit:t}){const a=e,i=(0,l.Fl)((()=>a.currentElementTimeData.position));(0,l.YP)(i,(e=>{r.value=parseFloat(e)}));const r=(0,n.iH)(0);function o(){t("seek",r.value)}function u(e,t){if(e&&Number.isInteger(e)&&e>0){var a=Math.floor(e/3600),l=Math.floor((e-3600*a)/60),n=Math.floor(e-3600*a-60*l);return l<10&&(l="0"+l),n<10&&(n="0"+n),l+":"+n}return"00:00"}return(t,a)=>{const n=(0,l.up)("q-item-section"),i=(0,l.up)("q-slider"),c=(0,l.up)("q-item"),d=(0,l.up)("q-list");return(0,l.wg)(),(0,l.j4)(d,null,{default:(0,l.w5)((()=>[(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[(0,l.Wm)(n,{side:""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(u(e.currentElementTimeData.currentTime)),1)])),_:1}),(0,l.Wm)(n,null,{default:(0,l.w5)((()=>[(0,l.Wm)(i,{disable:e.disabled,modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=e=>r.value=e),min:0,max:1,step:.01,label:"","label-value":u(e.currentElementTimeData.currentTime),onChange:o},null,8,["disable","modelValue","label-value"])])),_:1}),(0,l.Wm)(n,{side:""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(u(e.currentElementTimeData.duration)),1)])),_:1})])),_:1})])),_:1})}}},le=ae,ne=le;_()(ae,"components",{QList:E.Z,QItem:I.Z,QItemSection:C.Z,QSlider:z.Z});var se=a(8106);const ie={id:"current_track_actions"},re={__name:"SidebarPlayerTrackActions",props:{id:String,disabled:Boolean,favorited:Number,downloadURL:String},emits:["toggleAnalyzer"],setup(e,{emit:t}){const a=e,s=(0,u.Z)(),{t:i}=(0,c.QT)(),r=(0,o.F)();r.load();const d=(0,n.iH)(r.getSingleLayoutMode||!1);function m(){t("toggleAnalyzer")}function p(){if(a.id){const e=a.favorited?se.dC.unSetFavorite:se.dC.setFavorite;e(a.id).then((e=>{})).catch((e=>{switch(e.response.status){default:s.notify({type:"negative",message:i("API Error: error when toggling favorite flag"),caption:i("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})});break}}))}}function v(){t("toggleTrackDetailsModal")}return(0,l.YP)(d,(e=>{r.saveSingleLayoutMode(e)})),(t,a)=>{const n=(0,l.up)("q-icon"),s=(0,l.up)("q-btn"),i=(0,l.up)("q-btn-group");return(0,l.wg)(),(0,l.iD)("div",ie,[(0,l.Wm)(i,{spread:""},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{dense:"",unelevated:"",size:"md",disable:e.disabled,title:"Toggle navigation menu"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{name:"reorder"})])),_:1},8,["disable"]),(0,l.Wm)(s,{dense:"",unelevated:"",size:"md",disable:e.disabled,title:"Toggle analyzer"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{name:"bar_chart",onClick:m})])),_:1},8,["disable"]),(0,l.Wm)(s,{dense:"",unelevated:"",size:"md",disable:e.disabled,title:"Love/unlove track"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{name:"favorite",color:e.favorited?"pink":"",onClick:p},null,8,["color"])])),_:1},8,["disable"]),(0,l.Wm)(s,{dense:"",unelevated:"",size:"md",disable:e.disabled,title:"Toggle random sort"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{name:"shuffle"})])),_:1},8,["disable"]),(0,l.Wm)(s,{dense:"",unelevated:"",size:"md",disable:e.disabled,title:"Toggle repeat mode"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{name:"replay"})])),_:1},8,["disable"]),e.downloadURL?((0,l.wg)(),(0,l.j4)(s,{key:0,dense:"",unelevated:"",size:"md",disable:e.disabled,title:"Download track",href:e.downloadURL},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{name:"file_download"})])),_:1},8,["disable","href"])):((0,l.wg)(),(0,l.j4)(s,{key:1,dense:"",unelevated:"",size:"md",disable:"",title:"Download track"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{name:"file_download"})])),_:1})),(0,l.Wm)(s,{dense:"",unelevated:"",size:"md",disable:e.disabled,onClick:a[0]||(a[0]=e=>d.value=!d.value)},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{name:"screenshot_monitor",title:"Toggle section details",color:d.value?"pink":""},null,8,["color"])])),_:1},8,["disable"]),(0,l.Wm)(s,{dense:"",unelevated:"",size:"md",disable:e.disabled,onClick:v},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{name:"tag",title:"Track tags details "})])),_:1},8,["disable"])])),_:1})])}}},oe=re,ue=oe;_()(re,"components",{QBtnGroup:Y.Z,QBtn:G.Z,QIcon:T.Z});var ce=a(4376);const de=(0,l._)("br",null,null,-1),me=(0,l._)("br",null,null,-1),pe={key:0},ve={__name:"SidebarPlayerTrackDetailsModal",props:{trackId:String,coverImage:String},emits:["hide"],setup(e,{emit:t}){const a=e,i=(0,u.Z)(),{t:o}=(0,c.QT)(),d=(0,n.iH)(!1),m=(0,n.iH)(!0);function p(){t("hide")}const v=(0,n.iH)(null);function g(){a.trackId&&(d.value=!0),r.api.track.get(a.trackId).then((e=>{d.value=!1,v.value=e.data.track,console.log(e)})).catch((e=>{d.value=!1,i.notify({type:"negative",message:"API Error: error loading track details",caption:"API Error: fatal error details: HTTP {"+e.response.status+"} ({"+e.response.statusText+"})"}),d.value=!1}))}return g(),(e,t)=>{const a=(0,l.up)("q-img"),i=(0,l.up)("q-btn"),r=(0,l.up)("q-card-section"),o=(0,l.up)("q-separator"),u=(0,l.up)("q-card"),c=(0,l.up)("q-dialog");return(0,l.wg)(),(0,l.j4)(c,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=e=>m.value=e),onHide:p},{default:(0,l.w5)((()=>[v.value?((0,l.wg)(),(0,l.j4)(u,{key:0,class:"my-card"},{default:(0,l.w5)((()=>[(0,l.Wm)(a,{src:v.value.covers.normal,width:"400px",height:"400px","spinner-color":"pink"},null,8,["src"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",null,[(0,l._)("p",null,"Title: "+(0,s.zw)(v.value.title),1),(0,l._)("p",null,[(0,l.Uk)("Artist: "+(0,s.zw)(v.value.artist.name),1),de,v.value.artist.mbId?((0,l.wg)(),(0,l.j4)(i,{key:0,size:"sm",outline:"",dense:"",icon:"link",label:"musicbrainz",href:"https://musicbrainz.org/artist/"+v.value.artist.mbId,target:"blank"},null,8,["href"])):(0,l.kq)("",!0)]),(0,l._)("p",null,[(0,l.Uk)("Album: "+(0,s.zw)(v.value.album.title),1),me,v.value.album.mbId?((0,l.wg)(),(0,l.j4)(i,{key:0,size:"sm",outline:"",dense:"",icon:"link",label:"musicbrainz",href:"https://musicbrainz.org/release/"+v.value.album.mbId,target:"blank"},null,8,["href"])):(0,l.kq)("",!0)]),(0,l._)("p",null,"Album track index: "+(0,s.zw)(v.value.trackNumber),1),(0,l._)("p",null,"Year: "+(0,s.zw)(v.value.album.year),1),v.value.favorited?((0,l.wg)(),(0,l.iD)("p",pe,"Favorited at: "+(0,s.zw)((0,n.SU)(ce.ZP).formatDate(1e3*v.value.favorited,"YYYY-MM-DD HH:mm:ss Z")),1)):(0,l.kq)("",!0)])])),_:1}),(0,l.Wm)(o)])),_:1})):(0,l.kq)("",!0)])),_:1},8,["modelValue"])}}};var ge=a(2074),ke=a(4458),be=a(3190),we=a(926);const fe=ve,_e=fe;_()(ve,"components",{QDialog:ge.Z,QCard:ke.Z,QImg:w.Z,QCardSection:be.Z,QBtn:G.Z,QSeparator:we.Z});const ye=(0,l._)("audio",{id:"audio",class:"is-hidden"},null,-1),he={__name:"SidebarPlayer",setup(e){const t=(0,u.Z)(),{t:a}=(0,c.QT)(),s=(0,o.F)();s.load();const i=(0,n.iH)(!1),d=s.getVolume||1,k=(0,m.n)(),b=(0,n.iH)(null),w=(0,n.iH)(!1),f=(0,n.iH)(!0),_=(0,v.d)(),y=(0,p.l)(),S=(0,l.Fl)((()=>{const e=_.getCurrentElement;return null!=e.track})),x=(0,l.Fl)((()=>{const e=_.getCurrentElement;return e&&e.track?e.track.id||null:e&&e.radioStation&&e.radioStation.id||null})),W=(0,l.Fl)((()=>{const e=_.getCurrentElement;return e&&e.track&&e.track.favorited||null})),P=(0,l.Fl)((()=>{const e=_.getCurrentElement;return e?e.track&&e.track.covers?e.track.covers.normal||null:e.radioStation&&e.radioStation.images&&e.radioStation.images.normal||null:null})),E=(0,l.Fl)((()=>{const e=_.getCurrentElement;return e?e.track&&e.track.covers?e.track.covers.small||null:e.radioStation&&e.radioStation.images&&e.radioStation.images.small||null:null})),I=(0,l.Fl)((()=>null==x.value)),C=(0,n.iH)({duration:0,currentTime:0,currentProgress:0,position:0});function T(e){r.api.track.increasePlayCount(e).then((e=>{})).catch((e=>{switch(i.value=!1,e.response.status){default:t.notify({type:"negative",message:a("API Error: fatal error"),caption:a("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})});break}}))}function z(){k.interact(),_.skipPrevious()}function Q(e){k.interact(),k.play(e)}function U(){k.interact(),_.skipNext()}function A(e){k.setVolume(e),s.saveVolume(e)}function D(e){e>=0&&e<1&&k.setCurrentTime(k.getDuration*e)}return(0,l.bv)((()=>{b.value=k.getElement,k.setVolume(d),b.value.addEventListener("ended",(e=>{console.debug("Audio is ended"),S.value&&T(x.value),_.allowSkipNext?U():y.setStatusStopped()})),b.value.addEventListener("error",(e=>{console.debug("Audio loading error"),console.log(e)})),b.value.addEventListener("timeupdate",(e=>{C.value.currentProgress=b.value.currentTime/b.value.duration,C.value.duration=Math.floor(b.value.duration),C.value.currentTime=Math.floor(b.value.currentTime),isNaN(C.value.currentProgress)?C.value.position=0:C.value.position=Number(C.value.currentProgress.toFixed(2))}))})),(e,t)=>((0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(h,{coverImage:P.value,smallVinylImage:E.value,rotateVinyl:(0,n.SU)(y).isPlaying},null,8,["coverImage","smallVinylImage","rotateVinyl"]),ye,(0,l.wy)((0,l.Wm)(q,null,null,512),[[g.F8,f.value]]),(0,l.Wm)(Z,{disabled:I.value,defaultValue:(0,n.SU)(d),onVolumeChange:A},null,8,["disabled","defaultValue"]),(0,l.Wm)(K,{currentElement:(0,n.SU)(_).getCurrentElement},null,8,["currentElement"]),(0,l.Wm)(te,{disabled:I.value,allowSkipPrevious:(0,n.SU)(_).allowSkipPrevious,allowPlay:!0,allowSkipNext:(0,n.SU)(_).allowSkipNext,isPlaying:(0,n.SU)(y).isPlaying,onSkipPrevious:z,onPlay:Q,onSkipNext:U},null,8,["disabled","allowSkipPrevious","allowSkipNext","isPlaying"]),(0,l.Wm)(ne,{disabled:I.value||!S.value,currentElementTimeData:C.value,onSeek:D},null,8,["disabled","currentElementTimeData"]),(0,l.Wm)(ue,{disabled:I.value,id:x.value,downloadURL:(0,n.SU)(_).getCurrentElementURL,favorited:W.value,onToggleAnalyzer:t[0]||(t[0]=e=>f.value=!f.value),onToggleTrackDetailsModal:t[1]||(t[1]=e=>w.value=!0)},null,8,["disabled","id","downloadURL","favorited"]),w.value?((0,l.wg)(),(0,l.j4)(_e,{key:0,coverImage:P.value,trackId:x.value,onHide:t[2]||(t[2]=e=>w.value=!1)},null,8,["coverImage","trackId"])):(0,l.kq)("",!0)]))}},Se=he,xe=Se,We={style:{},class:"bg-white text-dark"},qe=(0,l._)("br",null,null,-1),Pe={__name:"SidebarPlaylist",setup(e){const t=(0,v.d)(),a=(0,n.iH)([]);return a.value=t.getElements,(e,t)=>{const n=(0,l.up)("q-item-label"),i=(0,l.up)("q-item-section"),r=(0,l.up)("q-icon"),o=(0,l.up)("q-item"),u=(0,l.up)("q-separator"),c=(0,l.up)("q-list");return(0,l.wg)(),(0,l.iD)("div",We,[(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.value,((e,t)=>((0,l.wg)(),(0,l.j4)(o,{key:e.track.id},{default:(0,l.w5)((()=>[(0,l.Wm)(i,null,{default:(0,l.w5)((()=>[(0,l.Wm)(n,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.track.title)+(0,s.zw)(t),1)])),_:2},1024),(0,l.Wm)(n,{caption:"",lines:"2"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.track.artist.name),1),qe,(0,l.Uk)((0,s.zw)(e.track.album.title)+" ("+(0,s.zw)(e.track.album.year)+").",1)])),_:2},1024)])),_:2},1024),(0,l.Wm)(i,{side:"",top:""},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{caption:""},{default:(0,l.w5)((()=>[(0,l.Uk)("4:34")])),_:1}),(0,l.Wm)(r,{name:"music_note",color:"pink"})])),_:1})])),_:2},1024)))),128)),(0,l.Wm)(u,{spaced:"",inset:""})])),_:1})])}}};var Ee=a(3115);_()(Pe,"components",{QList:E.Z,QItem:I.Z,QItemSection:C.Z,QItemLabel:Ee.Z,QIcon:T.Z,QSeparator:we.Z});const Ie={__name:"AppLeftSidebar",setup(e){const t=(0,u.Z)();return(e,a)=>{const i=(0,l.up)("q-card");return(0,l.wg)(),(0,l.j4)(i,{class:(0,s.C_)(["q-mb-md",{fixed:(0,n.SU)(t).screen.gt.md}])},{default:(0,l.w5)((()=>[(0,l.Wm)(xe)])),_:1},8,["class"])}}},Ce=Ie,Te=Ce;_()(Ie,"components",{QCard:ke.Z});const ze={class:"text-center"},Qe={class:"text-weight-medium"},Ze={class:"text-grey-8 q-gutter-xs"},Ue={class:"text-weight-medium"},Ae={class:"text-grey-8 q-gutter-xs"},De={class:"text-weight-medium"},Le={class:"text-grey-8 q-gutter-xs"},He={__name:"ToolbarSearch",setup(e){const{t}=(0,c.QT)(),a=(0,n.iH)(null),i=(0,n.iH)([]),o=(0,n.iH)(!1),u=(0,n.iH)([]);function d(e,a){e&&e.trim().length>0?o.value||(i.value=[],o.value=!0,a((()=>{r.api.globalSearch.search({text:e},1,3,!1,"","ASC").then((e=>{u.value=e.data.data,i.value=[],i.value=i.value.concat(u.value.tracks.map((e=>({isTrack:!0,id:e.id,label:e.title,caption:t("fastSearchResultCaption",{artistName:e.artist.name,albumTitle:e.album.title,albumYear:e.album.year})})))),i.value=i.value.concat(u.value.albums.map((e=>({isAlbum:!0,id:e.mbId,label:e.title,caption:"by  "+e.artist.name+" ("+e.year+")",albumArtist:e.artist.name,year:e.year,image:e.covers.small})))),i.value=i.value.concat(u.value.artists.map((e=>({isArtist:!0,id:e.mbId,label:e.name,caption:"total tracks: "+e.totalTracks})))),o.value=!1})).catch((e=>{o.value=!1,$q.notify({type:"negative",message:t("API Error: fatal error"),caption:t("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})})}))}))):a((()=>{i.value=[]}))}function m(e){const t=u.value.tracks.find((t=>t.id==e));t&&se.dC.play(t)}function p(e){const t=u.value.tracks.find((t=>t.id==e));t&&se.dC.enqueue(t)}function v(e,t,a,l){let n={};n=e?{albumMbId:e}:{albumTitle:t||null,artistName:a||null,year:l||null},r.api.track.search(n,1,0,!1,"trackNumber","ASC").then((e=>{se.dC.play(e.data.data.items.map((e=>({track:e}))))})).catch((e=>{}))}function g(e,t,a,l){let n={};n=e?{albumMbId:e}:{albumTitle:t||null,artistName:a||null,year:l||null},r.api.track.search(n,1,0,!1,"trackNumber","ASC").then((e=>{se.dC.enqueue(e.data.data.items.map((e=>({track:e}))))})).catch((e=>{}))}return(e,r)=>{const u=(0,l.up)("q-spinner"),c=(0,l.up)("q-item-section"),k=(0,l.up)("q-item"),b=(0,l.up)("q-icon"),w=(0,l.up)("q-item-label"),f=(0,l.up)("q-btn"),_=(0,l.up)("q-separator"),y=(0,l.up)("q-img"),h=(0,l.up)("q-list"),S=(0,l.up)("q-select");return(0,l.wg)(),(0,l.j4)(S,{ref:"search",dense:"",standout:"","use-input":"","hide-selected":"",class:"q-mx-md",filled:"",color:"pink","stack-label":!1,label:(0,n.SU)(t)("Search..."),modelValue:a.value,"onUpdate:modelValue":r[0]||(r[0]=e=>a.value=e),options:i.value,onFilter:d,style:{"min-width":"24%"}},(0,l.Nv)({option:(0,l.w5)((e=>[(0,l.Wm)(h,{class:"bg-grey-2 text-dark"},{default:(0,l.w5)((()=>[e.opt.isTrack?((0,l.wg)(),(0,l.j4)(k,{key:0},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{avatar:"",top:""},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{name:"music_note",color:"black",size:"34px"})])),_:1}),(0,l.Wm)(c,{top:"",class:"col-1 gt-sm"},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{class:"q-mt-sm"},{default:(0,l.w5)((()=>[(0,l.Uk)("Track")])),_:1})])),_:1}),(0,l.Wm)(c,{top:""},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{lines:"1"},{default:(0,l.w5)((()=>[(0,l._)("span",Qe,(0,s.zw)(e.opt.label),1)])),_:2},1024),(0,l.Wm)(w,{caption:"",lines:"1"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.opt.caption),1)])),_:2},1024)])),_:2},1024),(0,l.Wm)(c,{top:"",side:""},{default:(0,l.w5)((()=>[(0,l._)("div",Ze,[(0,l.Wm)(f,{class:"gt-xs",size:"12px",flat:"",dense:"",round:"",icon:"play_arrow",title:(0,n.SU)(t)("play track"),onClick:t=>m(e.opt.id)},null,8,["title","onClick"]),(0,l.Wm)(f,{class:"gt-xs",size:"12px",flat:"",dense:"",round:"",icon:"add_box",title:(0,n.SU)(t)("enqueue track"),onClick:t=>p(e.opt.id)},null,8,["title","onClick"])])])),_:2},1024),(0,l.Wm)(_)])),_:2},1024)):e.opt.isAlbum?((0,l.wg)(),(0,l.j4)(k,{key:1},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{avatar:"",top:""},{default:(0,l.w5)((()=>[e.opt.image?((0,l.wg)(),(0,l.j4)(y,{key:0,src:e.opt.image,style:{width:"34px",height:"34px"}},{error:(0,l.w5)((()=>[(0,l.Wm)(b,{name:"album",color:"black",size:"34px"})])),_:2},1032,["src"])):((0,l.wg)(),(0,l.j4)(b,{key:1,name:"album",color:"black",size:"34px"}))])),_:2},1024),(0,l.Wm)(c,{top:"",class:"col-1 gt-sm"},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{class:"q-mt-sm"},{default:(0,l.w5)((()=>[(0,l.Uk)("Album")])),_:1})])),_:1}),(0,l.Wm)(c,{top:""},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{lines:"1"},{default:(0,l.w5)((()=>[(0,l._)("span",Ue,(0,s.zw)(e.opt.label),1)])),_:2},1024),(0,l.Wm)(w,{caption:"",lines:"1"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.opt.caption),1)])),_:2},1024)])),_:2},1024),(0,l.Wm)(c,{top:"",side:""},{default:(0,l.w5)((()=>[(0,l._)("div",Ae,[(0,l.Wm)(f,{class:"gt-xs",size:"12px",flat:"",dense:"",round:"",icon:"play_arrow",title:(0,n.SU)(t)("play album"),onClick:t=>v(e.opt.id,e.opt.label,e.opt.albumArtist,e.opt.year)},null,8,["title","onClick"]),(0,l.Wm)(f,{class:"gt-xs",size:"12px",flat:"",dense:"",round:"",icon:"add_box",title:(0,n.SU)(t)("enqueue album"),onClick:t=>g(e.opt.id,e.opt.label,e.opt.albumArtist,e.opt.year)},null,8,["title","onClick"])])])),_:2},1024)])),_:2},1024)):e.opt.isArtist?((0,l.wg)(),(0,l.j4)(k,{key:2,clickable:"",to:{name:"artist",params:{name:e.opt.label}}},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{avatar:"",top:""},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{name:"person",color:"black",size:"34px"})])),_:1}),(0,l.Wm)(c,{top:"",class:"col-1 gt-sm"},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{class:"q-mt-sm"},{default:(0,l.w5)((()=>[(0,l.Uk)("Artist")])),_:1})])),_:1}),(0,l.Wm)(c,{top:""},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{lines:"1"},{default:(0,l.w5)((()=>[(0,l._)("span",De,(0,s.zw)(e.opt.label),1)])),_:2},1024),(0,l.Wm)(w,{caption:"",lines:"1"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.opt.caption),1)])),_:2},1024)])),_:2},1024),(0,l.Wm)(c,{top:"",side:""},{default:(0,l.w5)((()=>[(0,l._)("div",Le,[(0,l.Wm)(b,{class:"gt-xs",size:"sm",flat:"",dense:"",round:"",name:"link"})])])),_:1})])),_:2},1032,["to"])):(0,l.kq)("",!0)])),_:2},1024)])),_:2},[o.value?{name:"no-option",fn:(0,l.w5)((()=>[(0,l.Wm)(k,null,{default:(0,l.w5)((()=>[(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[(0,l._)("div",ze,[(0,l.Wm)(u,{color:"pink",size:"32px"})])])),_:1})])),_:1})])),key:"0"}:void 0]),1032,["label","modelValue","options"])}}};var Ne=a(6384),Ve=a(3902);const Fe=He,je=Fe;_()(He,"components",{QSelect:Ne.Z,QItem:I.Z,QItemSection:C.Z,QSpinner:Ve.Z,QList:E.Z,QIcon:T.Z,QItemLabel:Ee.Z,QBtn:G.Z,QSeparator:we.Z,QImg:w.Z});const Be=(0,l._)("img",{src:"icons/favicon-96x96.png"},null,-1),Me={class:"row"},Re={class:"items-center q-px-md q-mb-none q-mx-auto",style:{width:"431px","max-width":"431px"}},Ye={key:0,class:"q-pr-md col-xl col-lg col-md col-sm-12 col-xs-12 q-mb-none q-mx-auto"},Ge={__name:"MainLayout",setup(e){const{t}=(0,c.QT)(),a=(0,u.Z)(),g=(0,i.tv)(),k=(0,p.l)(),b=(0,m.n)(),w=(0,v.d)(),f=(0,n.iH)(null),_=(0,o.F)(),y=(0,n.iH)([{shortLabel:"EN",label:"English",value:"en-US"},{shortLabel:"ES",label:"Español",value:"es-ES"},{shortLabel:"GL",label:"Galego",value:"gl-GL"}]),h=y.value.find((e=>e.value==d.defaultLocale)),S=(0,n.iH)(h||y.value[0]);function x(e,t){S.value=e,d.i18n.global.locale.value=e.value,t&&_.saveLocale(e.value)}const W=[{name:"dashboard",text:"Dashboard",icon:"analytics",linkRouteName:"dashboard"},{name:"current_playlist",text:"Current playlist",icon:"list_alt",linkRouteName:"currentPlaylist"},{name:"browse_artists",text:"Browse artists",icon:"person",linkRouteName:"artists"},{name:"browse_albums",text:"Browse albums",icon:"album",linkRouteName:"albums"},{name:"browse_paths",text:"Browse paths",icon:"folder_open",linkRouteName:"paths"},{name:"browse_playlists",text:"Browse playlists",icon:"list",linkRouteName:"playlists"},{name:"browse_radio_stations",text:"Browse radio stations",icon:"radio",linkRouteName:"radioStations"}],q=(0,l.Fl)((()=>{const e=w.getCurrentElement;return e?e.track&&e.track.url?e.track.url:e.radioStation&&e.radioStation.directStream?e.radioStation.directStream:null:null}));function P(){b.stop(),r.api.user.signOut().then((e=>{_.signOut(),g.push({name:"signIn"})})).catch((e=>{a.notify({type:"negative",message:t("API Error: fatal error"),caption:t("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})})}))}return(0,l.YP)(q,(e=>{f.value&&(f.value.src=e,b.hasPreviousUserInteractions&&b.play(!0))})),b.create(),f.value=b.getElement,w.load(),b.hasPreviousUserInteractions&&(k.isPlaying||b.play(!0)),(e,i)=>{const r=(0,l.up)("q-avatar"),o=(0,l.up)("q-toolbar-title"),u=(0,l.up)("q-space"),c=(0,l.up)("q-route-tab"),d=(0,l.up)("q-item-section"),m=(0,l.up)("q-item"),p=(0,l.up)("q-separator"),v=(0,l.up)("q-list"),g=(0,l.up)("q-btn-dropdown"),k=(0,l.up)("q-btn"),b=(0,l.up)("q-tabs"),w=(0,l.up)("q-toolbar"),f=(0,l.up)("q-header"),h=(0,l.up)("q-ajax-bar"),q=(0,l.up)("router-view"),E=(0,l.up)("q-page"),I=(0,l.up)("q-page-container"),C=(0,l.up)("q-layout"),T=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.j4)(C,{view:"hHh Lpr lff"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,null,{default:(0,l.w5)((()=>[(0,l.Wm)(w,{class:"bg-grey-3 text-black shadow-1"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{square:"",size:"42px",class:"q-mr-sm"},{default:(0,l.w5)((()=>[Be])),_:1}),(0,l.Wm)(o,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Spieldose")])),_:1}),(0,l.Wm)(u),(0,l.Wm)(je),(0,l.Wm)(b,{shrink:"",dense:"","no-caps":""},{default:(0,l.w5)((()=>[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(W,(e=>(0,l.Wm)(c,{key:e.name,to:{name:e.linkRouteName},name:e.name,icon:e.icon,label:(0,n.SU)(a).screen.gt.md?(0,n.SU)(t)(e.text):"",title:(0,n.SU)(t)(e.text),"no-caps":"","inline-label":"",exact:""},null,8,["to","name","icon","label","title"]))),64)),(0,l.Wm)(g,{icon:"language","auto-close":"",stretch:"",flat:"",label:S.value.shortLabel,stack:""},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{dense:"",style:{"min-width":"200px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{class:"GL__menu-link-signed-in"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l._)("div",null,[(0,l.Uk)((0,s.zw)((0,n.SU)(t)("Selected language"))+": ",1),(0,l._)("strong",null,(0,s.zw)(S.value.label),1)])])),_:1})])),_:1}),(0,l.Wm)(p),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(y.value,(e=>(0,l.wy)(((0,l.wg)(),(0,l.j4)(m,{clickable:"",disable:S.value.value==e.value,key:e.value,onClick:t=>x(e,!0)},{default:(0,l.w5)((()=>[(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l._)("div",null,(0,s.zw)(e.label),1)])),_:2},1024)])),_:2},1032,["disable","onClick"])),[[T]]))),128))])),_:1})])),_:1},8,["label"]),(0,l.Wm)(k,{stretch:"",icon:"logout",label:(0,n.SU)(a).screen.xl?(0,n.SU)(t)("Signout"):"",title:(0,n.SU)(t)("Signout"),flat:"","no-caps":"",stack:"",onClick:P},null,8,["label","title"])])),_:1})])),_:1})])),_:1}),(0,l.Wm)(I,{class:"bg-grey-3 q-mt-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(E,null,{default:(0,l.w5)((()=>[(0,l.Wm)(h),(0,l._)("div",Me,[(0,l._)("div",Re,[(0,l.Wm)(Te)]),(0,n.SU)(_).getSingleLayoutMode?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",Ye,[(0,l.Wm)(q)]))])])),_:1})])),_:1})])),_:1})}}};var Oe=a(7605),Ke=a(6602),Xe=a(1663),$e=a(1357),Je=a(1973),et=a(136),tt=a(7817),at=a(3333),lt=a(2045),nt=a(906),st=a(2133),it=a(9885),rt=a(1602),ot=a(2146);const ut=Ge,ct=ut;_()(Ge,"components",{QLayout:Oe.Z,QHeader:Ke.Z,QToolbar:Xe.Z,QAvatar:$e.Z,QToolbarTitle:Je.Z,QSpace:et.Z,QTabs:tt.Z,QRouteTab:at.Z,QBtnDropdown:lt.Z,QList:E.Z,QItem:I.Z,QItemSection:C.Z,QSeparator:we.Z,QBtn:G.Z,QDrawer:nt.Z,QPageContainer:st.Z,QPage:it.Z,QAjaxBar:rt.Z}),_()(Ge,"directives",{ClosePopup:ot.Z})}}]);
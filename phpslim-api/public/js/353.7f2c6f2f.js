"use strict";(globalThis["webpackChunkspieldose"]=globalThis["webpackChunkspieldose"]||[]).push([[353],{2719:(e,t,l)=>{l.d(t,{d:()=>o});var a=l(1809),s=l(8612),n=l.n(s);const i={namespace:"spieldose",storages:["local","cookie","session","memory"],storage:"local",expireDays:3650},o=(0,a.Q_)("currentPlaylist",{state:()=>({elements:[],currentIndex:-1,elementsLastChangeTimestamp:null}),getters:{hasElements:e=>e.elements&&e.elements.length>0,getElements:e=>e.elements,getElementsLastChangeTimestamp:e=>e.elementsLastChangeTimestamp,getCurrentIndex:e=>e.currentIndex,getCurrentElement:e=>e.currentIndex>=0&&e.elements.length>0?e.elements[e.currentIndex]:null,getCurrentElementURL:e=>e.currentIndex>=0&&e.elements.length>0?e.elements[e.currentIndex].url:null,allowSkipPrevious:e=>e.currentIndex>0&&e.elements.length>0,allowSkipNext:e=>e.currentIndex>=0&&e.elements.length>0&&e.currentIndex<e.elements.length-1,allowPlay:e=>!0,allowPause:e=>!0,allowResume:e=>!0,allowStop:e=>!0},actions:{load(){const e=n()(i),t=e.get("currentPlaylistElements");t&&(this.elements=t);const l=e.get("currentPlaylistElementIndex");l>=0&&(this.currentIndex=l)},saveElements(e){this.elements=e,this.currentIndex=e&&e.length>0?0:-1;const t=n()(i);t.set("currentPlaylistElements",e),t.set("currentPlaylistElementIndex",e&&e.length>0?0:-1),this.elementsLastChangeTimestamp=Date.now()},appendElements(e){this.elements=this.elements.concat(e);const t=n()(i);t.set("currentPlaylistElements",this.elements),t.set("currentPlaylistElementIndex",this.currentIndex),this.elementsLastChangeTimestamp=Date.now()},saveCurrentTrackIndex(e){this.currentIndex=e>=0?e:-1;const t=n()(i);t.set("currentPlaylistElementIndex",this.currentIndex)},skipPrevious(){this.currentIndex--},skipNext(){this.currentIndex++}}})},4958:(e,t,l)=>{l.d(t,{n:()=>i});var a=l(1809),s=l(1320);const n=(0,s.l)(),i=(0,a.Q_)("player",{state:()=>({element:null,hasPreviousUserInteractions:!1}),getters:{getElement:e=>e.element,getDuration:e=>e.element.duration},actions:{interact(){this.hasPreviousUserInteractions=!0},create(){this.element=document.createElement("audio"),this.element.id="audio_player",this.element.crossOrigin="anonymous"},setVolume(e){this.element.volume=e},setCurrentTime(e){this.element.currentTime=e},stop(){this.element.pause(),n.setStatusStopped()},load(){},play(e){e?(this.element.play(),n.setStatusPlaying()):n.isPlaying?(this.element.pause(),n.setStatusPaused()):n.isPaused?(this.element.play(),n.setStatusPlaying()):(this.element.load(),this.element.play(),n.setStatusPlaying())}}})},1320:(e,t,l)=>{l.d(t,{l:()=>s});var a=l(1809);const s=(0,a.Q_)("playerStatus",{state:()=>({status:"stopped"}),getters:{getStatus(e){return e.status},isPlaying(e){return"playing"==e.status},isStopped(e){return"stopped"==e.status},isPaused(e){return"paused"==e.status}},actions:{setStatusPlaying(){this.status="playing"},setStatusStopped(){this.status="stopped"},setStatusPaused(){this.status="paused"}}})},353:(e,t,l)=>{l.r(t),l.d(t,{default:()=>oe});var a=l(9835),s=l(499),n=l(6970),i=l(1957),o=l(9302),r=l(796),u=l(7712),c=l(1569),d=l(4958),m=l(1320),p=l(2719);const g={class:"text-left"},b={class:"text-left gt-lg"},v={class:"text-left"},k=(0,a._)("span",{class:"is-clickable"},[(0,a._)("i",{class:"fas fa-link ml-1"})],-1),h={class:"text-right gt-lg"},x={class:"text-right"},w={class:"text-center"},y=(0,a._)("td",{class:"gt-lg"},null,-1),S=(0,a._)("td",null,null,-1),f=(0,a._)("td",{class:"gt-lg"},null,-1),_=(0,a._)("td",null,null,-1),P={class:"text-center"},U={__name:"CurrentPlaylistTableRow",props:{disabled:Boolean,index:Number,lastIndex:Number,selected:Boolean,isPlaying:Boolean,isPaused:Boolean,isStopped:Boolean,element:Object},emits:["setcurrentIndex","up","down","toggleFavorite","remove"],setup(e,{emit:t}){const l=e,{t:i}=(0,u.QT)(),o=(0,a.Fl)((()=>l.isPlaying?"play_arrow":l.isPaused?"pause":l.isStopped?"stop":"play_arrow"));function r(){t("setcurrentIndex",l.index)}function c(){t("up",l.index)}function d(){t("down",l.index)}function m(){t("toggleFavorite",l.index)}function p(){t("remove",l.index)}return(t,l)=>{const u=(0,a.up)("q-icon"),U=(0,a.up)("router-link"),C=(0,a.up)("q-btn"),I=(0,a.up)("q-btn-group");return e.element.track?((0,a.wg)(),(0,a.iD)("tr",{key:0,class:(0,n.C_)(["non-selectable",{"bg-pink text-white":e.selected}])},[(0,a._)("td",{class:"text-right cursor-pointer",onClick:r},[e.selected?((0,a.wg)(),(0,a.j4)(u,{key:0,name:o.value,size:"sm",class:"q-mr-sm"},null,8,["name"])):(0,a.kq)("",!0),(0,a.Uk)((0,n.zw)(e.index+1)+"/32 ",1)]),(0,a._)("td",{class:"text-left cursor-pointer",onClick:r},(0,n.zw)(e.element.track.title),1),(0,a._)("td",g,[e.element.track.artist&&e.element.track.artist.name?((0,a.wg)(),(0,a.j4)(U,{key:0,class:(0,n.C_)({"text-white text-bold":e.selected}),to:{name:"artist",params:{name:e.element.track.artist.name}}},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{name:"link",class:"q-mr-sm"}),(0,a.Uk)((0,n.zw)(e.element.track.artist.name),1)])),_:1},8,["class","to"])):(0,a.kq)("",!0)]),(0,a._)("td",b,[e.element.track.album&&e.element.track.album.artist.name?((0,a.wg)(),(0,a.j4)(U,{key:0,class:(0,n.C_)({"text-white text-bold":e.selected}),to:{name:"artist",params:{name:e.element.track.album.artist.name}}},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{name:"link",class:"q-mr-sm"}),(0,a.Uk)((0,n.zw)(e.element.track.album.artist.name),1)])),_:1},8,["class","to"])):(0,a.kq)("",!0)]),(0,a._)("td",v,[(0,a.Uk)((0,n.zw)(e.element.track.album?e.element.track.album.title:null),1),k]),(0,a._)("td",h,(0,n.zw)(e.element.track.trackNumber),1),(0,a._)("td",x,(0,n.zw)(e.element.track.album?e.element.track.album.year:null),1),(0,a._)("td",w,[(0,a.Wm)(I,{outline:""},{default:(0,a.w5)((()=>[(0,a.Wm)(C,{size:"sm",color:"white","text-color":"grey-5",icon:"north",title:(0,s.SU)(i)("Up"),disable:e.disabled||0==e.index,onClick:c},null,8,["title","disable"]),(0,a.Wm)(C,{size:"sm",color:"white","text-color":"grey-5",icon:"south",title:(0,s.SU)(i)("Down"),disable:e.disabled||e.index==e.lastIndex-1,onClick:d},null,8,["title","disable"]),(0,a.Wm)(C,{size:"sm",color:"white","text-color":e.element.favorited?"pink":"grey-5",icon:"favorite",title:(0,s.SU)(i)("Toggle favorite"),disable:e.disabled,onClick:m},null,8,["text-color","title","disable"]),(0,a.Wm)(C,{size:"sm",color:"white","text-color":"grey-5",icon:"download",title:(0,s.SU)(i)("Download"),disable:e.disabled,href:e.element.track.url},null,8,["title","disable","href"]),(0,a.Wm)(C,{size:"sm",color:"white","text-color":"grey-5",icon:"delete",title:(0,s.SU)(i)("Remove"),disable:e.disabled||e.isPlaying&&e.selected,onClick:p},null,8,["title","disable"])])),_:1})])],2)):e.element.radioStation?((0,a.wg)(),(0,a.iD)("tr",{key:1,class:(0,n.C_)(["non-selectable",{"bg-pink text-white":e.selected}])},[(0,a._)("td",{class:"text-right cursor-pointer",onClick:r},[e.selected?((0,a.wg)(),(0,a.j4)(u,{key:0,name:o.value,size:"sm",class:"q-mr-sm"},null,8,["name"])):(0,a.kq)("",!0),(0,a.Uk)((0,n.zw)(e.index+1)+"/32 ",1)]),(0,a._)("td",{colspan:"2",class:"text-left cursor-pointer",onClick:r},(0,n.zw)(e.element.radioStation.name),1),y,S,f,_,(0,a._)("td",P,[(0,a.Wm)(I,{outline:""},{default:(0,a.w5)((()=>[(0,a.Wm)(C,{size:"sm",color:"white","text-color":"grey-5",icon:"north",title:(0,s.SU)(i)("Up"),disable:e.disabled||0==e.index,onClick:c},null,8,["title","disable"]),(0,a.Wm)(C,{size:"sm",color:"white","text-color":"grey-5",icon:"south",title:(0,s.SU)(i)("Down"),disable:e.disabled||e.index==e.lastIndex-1,onClick:d},null,8,["title","disable"]),(0,a.Wm)(C,{size:"sm",color:"white","text-color":"grey-5",icon:"favorite",title:(0,s.SU)(i)("Toggle favorite"),disable:!0},null,8,["title"]),(0,a.Wm)(C,{size:"sm",color:"white","text-color":"grey-5",icon:"link",title:(0,s.SU)(i)("View url"),disable:e.disabled,href:e.element.radioStation.url,target:"_blank"},null,8,["title","disable","href"]),(0,a.Wm)(C,{size:"sm",color:"white","text-color":"grey-5",icon:"delete",title:(0,s.SU)(i)("Remove"),disable:e.disabled||e.isPlaying&&e.selected,onClick:p},null,8,["title","disable"])])),_:1})])],2)):(0,a.kq)("",!0)}}};var C=l(2857),I=l(7236),W=l(8879),E=l(9984),q=l.n(E);const z=U,T=z;q()(U,"components",{QIcon:C.Z,QBtnGroup:I.Z,QBtn:W.Z});const Q={class:"bg-grey-2 text-grey-10"},Z={class:"text-right"},D={class:"text-left"},A={class:"text-left"},B={class:"text-left gt-lg"},R={class:"text-left"},V={class:"text-right gt-lg"},j={class:"text-right"},F={class:"text-center"},L={key:0},N={key:1},H={colspan:"8",class:"text-center"},Y=(0,a._)("div",{class:"text-h6"},"Save current playlist",-1),G={__name:"CurrentPlaylistPage",setup(e){const t=(0,o.Z)(),{t:l}=(0,u.QT)(),g=(0,d.n)(),b=(0,p.d)(),v=(0,a.Fl)((()=>b.getElementsLastChangeTimestamp));(0,a.YP)(v,(e=>{h.value=b.getElements,x.value=b.getCurrentIndex}));const k=(0,m.l)(),h=(0,s.iH)([]),x=(0,s.iH)(0),w=(0,s.iH)(!1),y=(0,s.iH)(!1),S=(0,s.iH)(null),f=(0,s.iH)(!1);function _(){g.stop(),h.value=[],b.saveElements([])}function P(e){g.interact(),b.saveCurrentTrackIndex(e),k.isPlaying||g.play()}function U(e){const t=h.value[e];h.value.splice(e,1),h.value.splice(e-1,0,t)}function C(e){const t=h.value[e];h.value.splice(e,1),h.value.splice(e+1,0,t)}function I(e){const a=h.value[e];if(a){const e=a.favorited?c.api.track.unSetFavorite:c.api.track.setFavorite;e(a.id).then((e=>{a.favorited=e.data.favorited,b.saveElements(h.value)})).catch((e=>{switch(e.response.status){default:t.notify({type:"negative",message:l("API Error: fatal error"),caption:l("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})});break}}))}}function W(e){h.value.splice(e,1),b.saveElements(h.value)}function E(){g.interact(),w.value=!0,x.value=0,c.api.track.search({},1,32,!0,null,null).then((e=>{h.value=e.data.data.items.map((e=>({track:e}))),b.saveElements(h.value),w.value=!1})).catch((e=>{t.notify({type:"negative",message:l("API Error: error loading random tracks"),caption:l("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})}),w.value=!1}))}const q=(0,a.Fl)((()=>b.getCurrentIndex));function z(){g.stop(),E()}function G(){g.interact(),b.skipPrevious()}function K(){g.interact(),g.play()}function O(){g.interact(),g.play()}function M(){g.interact(),g.play()}function J(){g.stop(),g.setCurrentTime(0)}function X(){g.interact(),b.skipNext()}function $(){S.value=null,y.value=!0}function ee(){g.interact(),w.value=!0,x.value=0,c.api.playlist.add((0,r.Z)(),S.value,h.value.filter((e=>e.track)).map((e=>e.track.id)),f.value).then((e=>{w.value=!1,y.value=!1})).catch((e=>{t.notify({type:"negative",message:l("API Error: error loading random tracks"),caption:l("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})}),w.value=!1}))}return(0,a.YP)(q,(e=>{x.value=e})),h.value=b.getElements,x.value=b.getCurrentIndex,(e,t)=>{const o=(0,a.up)("q-breadcrumbs-el"),r=(0,a.up)("q-breadcrumbs"),u=(0,a.up)("q-btn"),c=(0,a.up)("q-btn-group"),d=(0,a.up)("q-spinner"),m=(0,a.up)("q-markup-table"),p=(0,a.up)("q-card"),g=(0,a.up)("q-card-section"),v=(0,a.up)("q-input"),E=(0,a.up)("q-toggle"),q=(0,a.up)("q-card-actions"),te=(0,a.up)("q-dialog"),le=(0,a.up)("q-page"),ae=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(le,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"q-pa-lg"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{class:"q-mb-lg"},{default:(0,a.w5)((()=>[(0,a.Wm)(o,{icon:"home",label:"Spieldose"}),(0,a.Wm)(o,{icon:"list_alt",label:(0,s.SU)(l)("Current playlist")},null,8,["label"])])),_:1}),(0,a.Wm)(c,{spread:"",class:"q-mb-md"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{outline:"",color:"dark",label:(0,s.SU)(l)("Clear"),icon:"clear",onClick:_,disable:w.value||!(h.value&&h.value.length>0)},null,8,["label","disable"]),(0,a.Wm)(u,{outline:"",color:"dark",label:(0,s.SU)(l)("Randomize"),icon:"bolt",onClick:z,disable:w.value},null,8,["label","disable"]),(0,a.Wm)(u,{outline:"",color:"dark",label:(0,s.SU)(l)("Previous"),icon:"skip_previous",onClick:G,disable:w.value||!(0,s.SU)(b).allowSkipPrevious},null,8,["label","disable"]),(0,s.SU)(k).isStopped?((0,a.wg)(),(0,a.j4)(u,{key:0,outline:"",color:"dark",label:(0,s.SU)(l)("Play"),icon:"play_arrow",onClick:K,disable:w.value||!(0,s.SU)(b).hasElements},null,8,["label","disable"])):(0,s.SU)(k).isPlaying?((0,a.wg)(),(0,a.j4)(u,{key:1,outline:"",color:"dark",label:(0,s.SU)(l)("Pause"),icon:"pause",onClick:O,disable:w.value||!(h.value&&h.value.length>0)},null,8,["label","disable"])):(0,s.SU)(k).isPaused?((0,a.wg)(),(0,a.j4)(u,{key:2,outline:"",color:"dark",label:(0,s.SU)(l)("Resume"),icon:"play_arrow",onClick:M,disable:w.value||!(h.value&&h.value.length>0)},null,8,["label","disable"])):(0,a.kq)("",!0),(0,a.Wm)(u,{outline:"",color:"dark",label:(0,s.SU)(l)("Stop"),icon:"stop",onClick:J,disable:w.value||(0,s.SU)(k).isStopped||!(h.value&&h.value.length>0)},null,8,["label","disable"]),(0,a.Wm)(u,{outline:"",color:"dark",label:(0,s.SU)(l)("Next"),icon:"skip_next",onClick:X,disable:w.value||!(0,s.SU)(b).allowSkipNext},null,8,["label","disable"]),(0,a.Wm)(u,{outline:"",color:"dark",label:(0,s.SU)(l)("Download"),icon:"save_alt",disable:w.value||!(0,s.SU)(b).getCurrentElementURL,href:(0,s.SU)(b).getCurrentElementURL},null,8,["label","disable","href"]),(0,a.Wm)(u,{outline:"",color:"dark",label:(0,s.SU)(l)("Save as"),icon:"save_alt",disable:w.value||!(h.value&&h.value.length>0),onClick:$},null,8,["label","disable"])])),_:1}),(0,a.Wm)(m,{flat:"",bordered:""},{default:(0,a.w5)((()=>[(0,a._)("thead",null,[(0,a._)("tr",Q,[(0,a._)("th",Z,(0,n.zw)((0,s.SU)(l)("Index")),1),(0,a._)("th",D,(0,n.zw)((0,s.SU)(l)("Title")),1),(0,a._)("th",A,(0,n.zw)((0,s.SU)(l)("Artist")),1),(0,a._)("th",B,(0,n.zw)((0,s.SU)(l)("Album Artist")),1),(0,a._)("th",R,(0,n.zw)((0,s.SU)(l)("Album")),1),(0,a._)("th",V,(0,n.zw)((0,s.SU)(l)("Album Track nÂº")),1),(0,a._)("th",j,(0,n.zw)((0,s.SU)(l)("Year")),1),(0,a._)("th",F,(0,n.zw)((0,s.SU)(l)("Actions")),1)])]),w.value?((0,a.wg)(),(0,a.iD)("tbody",N,[(0,a._)("tr",null,[(0,a._)("td",H,[(0,a.wy)((0,a.Wm)(d,{color:"pink",size:"xl",class:"q-ml-sm",thickness:10},null,512),[[i.F8,w.value]])])])])):((0,a.wg)(),(0,a.iD)("tbody",L,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(h.value,((e,t)=>((0,a.wg)(),(0,a.j4)(T,{key:e.id,element:e,index:t,lastIndex:h.value.length,selected:x.value==t,onSetcurrentIndex:e=>P(t),onUp:e=>U(t),onDown:e=>C(t),onToggleFavorite:e=>I(t),onRemove:e=>W(t),disabled:w.value,isPlaying:(0,s.SU)(k).isPlaying,isPaused:(0,s.SU)(k).isPaused,isStopped:(0,s.SU)(k).isStopped},null,8,["element","index","lastIndex","selected","onSetcurrentIndex","onUp","onDown","onToggleFavorite","onRemove","disabled","isPlaying","isPaused","isStopped"])))),128))]))])),_:1})])),_:1}),(0,a.Wm)(te,{modelValue:y.value,"onUpdate:modelValue":t[3]||(t[3]=e=>y.value=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{style:{"min-width":"350px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[Y])),_:1}),(0,a.Wm)(g,{class:"q-pt-none"},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{outlined:"",dense:"",modelValue:S.value,"onUpdate:modelValue":t[0]||(t[0]=e=>S.value=e),autofocus:"",onKeyup:t[1]||(t[1]=(0,i.D2)((e=>y.value=!1),["enter"])),label:"Playlist name"},null,8,["modelValue"])])),_:1}),(0,a.Wm)(g,{class:"q-pt-none"},{default:(0,a.w5)((()=>[(0,a.Wm)(E,{label:"Public",color:"pink",modelValue:f.value,"onUpdate:modelValue":t[2]||(t[2]=e=>f.value=e)},null,8,["modelValue"])])),_:1}),(0,a.Wm)(q,{align:"right",class:""},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(u,{outline:"",label:"Cancel"},null,512),[[ae]]),(0,a.Wm)(u,{outline:"",label:"Save",disable:!S.value,onClick:ee},null,8,["disable"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}}};var K=l(9885),O=l(4458),M=l(2605),J=l(8052),X=l(6933),$=l(3902),ee=l(2074),te=l(3190),le=l(6611),ae=l(3175),se=l(1821),ne=l(2146);const ie=G,oe=ie;q()(G,"components",{QPage:K.Z,QCard:O.Z,QBreadcrumbs:M.Z,QBreadcrumbsEl:J.Z,QBtnGroup:I.Z,QBtn:W.Z,QMarkupTable:X.Z,QSpinner:$.Z,QDialog:ee.Z,QCardSection:te.Z,QInput:le.Z,QToggle:ae.Z,QCardActions:se.Z}),q()(G,"directives",{ClosePopup:ne.Z})}}]);
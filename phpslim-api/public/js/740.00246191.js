"use strict";(globalThis["webpackChunkspieldose"]=globalThis["webpackChunkspieldose"]||[]).push([[740],{8740:(e,l,a)=>{a.r(l),a.d(l,{default:()=>A});var t=a(9835),r=a(499),i=a(6970),o=a(1957),n=a(9302),s=a(796),u=a(6647),c=a(1569),d=a(5090),m=a(8106);const p=(0,t._)("div",{class:"text-h6"},"Save current playlist",-1),b={__name:"CurrentPlaylistPage",setup(e){const l=(0,n.Z)(),{t:a}=(0,u.QT)(),b=(0,d.H)(),v=(0,t.Fl)((()=>b.getCurrentPlaylistLastChangedTimestamp)),k=(0,r.iH)(null),g=(0,r.iH)([]),w=[{name:"index",required:!0,label:"Index",align:"right",field:e=>e.index,sortable:!1},{name:"title",required:!0,label:"Title",align:"left",field:e=>e.title,sortable:!0},{name:"artist",required:!0,label:"Artist",align:"left",field:e=>e.artist.name,sortable:!0},{name:"albumArtist",required:!1,label:"Album artist",align:"left",field:e=>e.album.artist.name,sortable:!0},{name:"albumTitle",required:!1,label:"Album",align:"left",field:e=>e.album.title,sortable:!0},{name:"albumTrackIndex",required:!1,label:"Album Track nÂº",align:"right",field:e=>e.trackNumber,sortable:!0},{name:"year",required:!1,label:"Year",align:"right",field:e=>e.album.year,sortable:!0},{name:"actions",required:!0,label:"Actions",align:"center",favorited:e=>e.favorited}],f=(0,r.iH)(w.map((e=>e.name))),y=((0,r.iH)({descending:!1,page:1,rowsPerPage:64}),(0,t.Fl)((()=>b.isPlaying?"play_arrow":b.isPaused?"pause":b.isStopped?"stop":"play_arrow")));(0,t.YP)(v,(e=>{S.value=b.getCurrentPlaylist.elements,g.value=S.value.map(((e,l)=>(e.track.index=l+1,e.track))),U.value=b.getCurrentPlaylistIndex}));const S=(0,r.iH)([]),U=(0,r.iH)(0),C=(0,r.iH)(!1),h=(0,r.iH)(!1),x=(0,r.iH)(null),W=(0,r.iH)(!1);function _(){b.clearCurrentPlaylist()}function q(e){const l=S.value[e];S.value.splice(e,1),S.value.splice(e-1,0,l)}function P(e){const l=S.value[e];S.value.splice(e,1),S.value.splice(e+1,0,l)}function T(e,t){const r=t?m.dC.unSetFavorite:m.dC.setFavorite;r(e).then((e=>{})).catch((e=>{switch(e.response.status){default:l.notify({type:"negative",message:a("API Error: error when toggling favorite flag"),caption:a("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})});break}}))}function z(e){}function Z(e,l,a){"I"!=e.target.nodeName&&"BUTTON"!=e.target.nodeName&&(b.interact(),b.skipToIndex(a))}function Q(){b.interact(),C.value=!0,U.value=0,c.api.track.search({},1,32,!0,null,null).then((e=>{S.value=e.data.data.items.map((e=>({track:e}))),g.value=S.value.map(((e,l)=>(e.track.index=l+1,e.track))),b.sendElementsToCurrentPlaylist(S.value),k.value.scrollTo(0,"center-force"),C.value=!1})).catch((e=>{l.notify({type:"negative",message:a("API Error: error loading random tracks"),caption:a("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})}),C.value=!1}))}const I=(0,t.Fl)((()=>b.getShuffle?b.getShuffleCurrentPlaylistIndex:b.getShuffledCurrentPlaylistIndex));function A(){b.stop(),Q()}function H(){b.interact(),m.oS.skipPrevious()}function E(){b.interact(),b.play()}function V(){b.interact(),b.play()}function N(){b.interact(),b.play()}function j(){b.stop(),b.setCurrentTime(0)}function R(){b.interact(),b.skipNext()}function B(){x.value=null,h.value=!0}function D(){b.interact(),C.value=!0,U.value=0,c.api.playlist.add((0,s.Z)(),x.value,S.value.filter((e=>e.track)).map((e=>e.track.id)),W.value).then((e=>{C.value=!1,h.value=!1})).catch((e=>{l.notify({type:"negative",message:a("API Error: error loading random tracks"),caption:a("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})}),C.value=!1}))}return(0,t.YP)(I,(e=>{U.value=e,k.value.scrollTo(e,"center-force")})),S.value=b.getCurrentPlaylist.elements,g.value=S.value.map(((e,l)=>(e.track.index=l+1,e.track))),U.value=I.value,(0,t.bv)((()=>{U.value>0&&k.value.scrollTo(U.value,"center-force")})),(e,n)=>{const s=(0,t.up)("q-breadcrumbs-el"),u=(0,t.up)("q-breadcrumbs"),c=(0,t.up)("q-btn"),d=(0,t.up)("q-btn-group"),m=(0,t.up)("q-icon"),v=(0,t.up)("q-td"),Q=(0,t.up)("router-link"),I=(0,t.up)("q-tr"),F=(0,t.up)("q-table"),Y=(0,t.up)("q-card"),L=(0,t.up)("q-card-section"),G=(0,t.up)("q-input"),K=(0,t.up)("q-toggle"),M=(0,t.up)("q-card-actions"),O=(0,t.up)("q-dialog"),J=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(Y,{class:"q-pa-lg"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{class:"q-mb-lg"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{icon:"home",label:"Spieldose"}),(0,t.Wm)(s,{icon:"list_alt",label:(0,r.SU)(a)("Current playlist")},null,8,["label"])])),_:1}),(0,t.Wm)(d,{spread:"",class:"q-mb-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{size:"md",outline:"",color:"dark",label:(0,r.SU)(l).screen.gt.md?(0,r.SU)(a)("Clear"):"",icon:"clear",onClick:_,disable:C.value||!(S.value&&S.value.length>0)},null,8,["label","disable"]),(0,t.Wm)(c,{size:"md",outline:"",color:"dark",label:(0,r.SU)(l).screen.gt.md?(0,r.SU)(a)("Randomize"):"",icon:"bolt",onClick:A,disable:C.value},null,8,["label","disable"]),(0,t.Wm)(c,{size:"md",outline:"",color:"dark",label:(0,r.SU)(l).screen.gt.md?(0,r.SU)(a)("Previous"):"",icon:"skip_previous",onClick:H,disable:C.value||!(0,r.SU)(b).allowSkipPrevious},null,8,["label","disable"]),(0,r.SU)(b).isStopped?((0,t.wg)(),(0,t.j4)(c,{key:0,size:"md",outline:"",color:"dark",label:(0,r.SU)(l).screen.gt.md?(0,r.SU)(a)("Play"):"",icon:"play_arrow",onClick:E,disable:C.value||!(0,r.SU)(b).hasCurrentPlaylistElements},null,8,["label","disable"])):(0,r.SU)(b).isPlaying?((0,t.wg)(),(0,t.j4)(c,{key:1,size:"md",outline:"",color:"dark",label:(0,r.SU)(l).screen.gt.md?(0,r.SU)(a)("Pause"):"",icon:"pause",onClick:V,disable:C.value||!(S.value&&S.value.length>0)},null,8,["label","disable"])):(0,r.SU)(b).isPaused?((0,t.wg)(),(0,t.j4)(c,{key:2,size:"md",outline:"",color:"dark",label:(0,r.SU)(l).screen.gt.md?(0,r.SU)(a)("Resume"):"",icon:"play_arrow",onClick:N,disable:C.value||!(S.value&&S.value.length>0)},null,8,["label","disable"])):(0,t.kq)("",!0),(0,t.Wm)(c,{size:"md",outline:"",color:"dark",label:(0,r.SU)(l).screen.gt.md?(0,r.SU)(a)("Stop"):"",icon:"stop",onClick:j,disable:C.value||(0,r.SU)(b).isStopped||!(S.value&&S.value.length>0)},null,8,["label","disable"]),(0,t.Wm)(c,{size:"md",outline:"",color:"dark",label:(0,r.SU)(l).screen.gt.md?(0,r.SU)(a)("Next"):"",icon:"skip_next",onClick:R,disable:C.value||!(0,r.SU)(b).allowSkipNext},null,8,["label","disable"]),(0,t.Wm)(c,{size:"md",outline:"",color:"dark",label:(0,r.SU)(l).screen.gt.md?(0,r.SU)(a)("Download"):"",icon:"save_alt",disable:C.value||!(0,r.SU)(b).getCurrentElementURL,href:(0,r.SU)(b).getCurrentElementURL},null,8,["label","disable","href"]),(0,t.Wm)(c,{size:"md",outline:"",color:"dark",label:(0,r.SU)(l).screen.gt.md?(0,r.SU)(a)("Save as"):"",icon:"save_alt",disable:C.value||!(S.value&&S.value.length>0),onClick:B},null,8,["label","disable"])])),_:1}),(0,t.Wm)(F,{ref_key:"tableRef",ref:k,class:"my-sticky-header-table",style:{height:"46.8em"},title:"Current playlist",rows:g.value,columns:w,"row-key":"id","virtual-scroll":"","rows-per-page-options":[0],"visible-columns":f.value,"hide-bottom":!0},{body:(0,t.w5)((e=>[(0,t.Wm)(I,{class:(0,i.C_)(["cursor-pointer",{"selected-row":U.value+1==e.row.index}]),props:e,onClick:l=>Z(l,e.row,e.row.index-1)},{default:(0,t.w5)((()=>[(0,t.Wm)(v,{key:"index",props:e},{default:(0,t.w5)((()=>[U.value+1==e.row.index?((0,t.wg)(),(0,t.j4)(m,{key:0,name:y.value,color:"pink",size:"sm",class:"q-mr-sm"},null,8,["name"])):(0,t.kq)("",!0),(0,t.Uk)(" "+(0,i.zw)(e.row.index)+" / "+(0,i.zw)(g.value.length),1)])),_:2},1032,["props"]),(0,t.Wm)(v,{key:"title",props:e},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.row.title),1)])),_:2},1032,["props"]),(0,t.Wm)(v,{key:"artist",props:e},{default:(0,t.w5)((()=>[e.row.artist.name?((0,t.wg)(),(0,t.j4)(Q,{key:0,class:(0,i.C_)({"text-white text-bold":!1}),to:{name:"artist",params:{name:e.row.artist.name}}},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{name:"link",class:"q-mr-sm"}),(0,t.Uk)((0,i.zw)(e.row.artist.name),1)])),_:2},1032,["to"])):(0,t.kq)("",!0)])),_:2},1032,["props"]),(0,t.Wm)(v,{key:"albumArtist",props:e},{default:(0,t.w5)((()=>[e.row.album.artist.name?((0,t.wg)(),(0,t.j4)(Q,{key:0,class:(0,i.C_)({"text-white text-bold":!1}),to:{name:"artist",params:{name:e.row.album.artist.name}}},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{name:"link",class:"q-mr-sm"}),(0,t.Uk)((0,i.zw)(e.row.album.artist.name),1)])),_:2},1032,["to"])):(0,t.kq)("",!0)])),_:2},1032,["props"]),(0,t.Wm)(v,{key:"albumTitle",props:e},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.row.album.title),1)])),_:2},1032,["props"]),(0,t.Wm)(v,{key:"albumTrackIndex",props:e},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.row.trackNumber),1)])),_:2},1032,["props"]),(0,t.Wm)(v,{key:"year",props:e},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.row.album.year),1)])),_:2},1032,["props"]),(0,t.Wm)(v,{key:"actions",props:e},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{outline:""},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{size:"sm",color:"white","text-color":"grey-5",icon:"north",title:(0,r.SU)(a)("Up"),disable:"",onClick:q},null,8,["title"]),(0,t.Wm)(c,{size:"sm",color:"white","text-color":"grey-5",icon:"south",title:(0,r.SU)(a)("Down"),disable:"",onClick:P},null,8,["title"]),(0,t.Wm)(c,{size:"sm",color:"white","text-color":e.row.favorited?"pink":"grey-5",icon:"favorite",title:(0,r.SU)(a)("Toggle favorite"),onClick:l=>T(e.row.id,e.row.favorited)},null,8,["text-color","title","onClick"]),(0,t.Wm)(c,{size:"sm",color:"white","text-color":"grey-5",icon:"delete",title:(0,r.SU)(a)("Remove"),onClick:(0,o.iM)((l=>z(e.row.index-1)),["stop","prevent"])},null,8,["title","onClick"])])),_:2},1024)])),_:2},1032,["props"])])),_:2},1032,["props","onClick","class"])])),_:1},8,["rows","visible-columns"])])),_:1}),(0,t.Wm)(O,{modelValue:h.value,"onUpdate:modelValue":n[3]||(n[3]=e=>h.value=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(Y,{style:{"min-width":"350px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(L,null,{default:(0,t.w5)((()=>[p])),_:1}),(0,t.Wm)(L,{class:"q-pt-none"},{default:(0,t.w5)((()=>[(0,t.Wm)(G,{outlined:"",dense:"",modelValue:x.value,"onUpdate:modelValue":n[0]||(n[0]=e=>x.value=e),autofocus:"",onKeyup:n[1]||(n[1]=(0,o.D2)((e=>h.value=!1),["enter"])),label:"Playlist name"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(L,{class:"q-pt-none"},{default:(0,t.w5)((()=>[(0,t.Wm)(K,{label:"Public",color:"pink",modelValue:W.value,"onUpdate:modelValue":n[2]||(n[2]=e=>W.value=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(M,{align:"right",class:""},{default:(0,t.w5)((()=>[(0,t.wy)((0,t.Wm)(c,{outline:"",label:"Cancel"},null,512),[[J]]),(0,t.Wm)(c,{outline:"",label:"Save",disable:!x.value,onClick:D},null,8,["disable"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}}};var v=a(4458),k=a(2605),g=a(8052),w=a(7236),f=a(8879),y=a(9994),S=a(136),U=a(6384),C=a(3532),h=a(7220),x=a(2857),W=a(2074),_=a(3190),q=a(6611),P=a(3175),T=a(1821),z=a(2146),Z=a(9984),Q=a.n(Z);const I=b,A=I;Q()(b,"components",{QCard:v.Z,QBreadcrumbs:k.Z,QBreadcrumbsEl:g.Z,QBtnGroup:w.Z,QBtn:f.Z,QTable:y.Z,QSpace:S.Z,QSelect:U.Z,QTr:C.Z,QTd:h.Z,QIcon:x.Z,QDialog:W.Z,QCardSection:_.Z,QInput:q.Z,QToggle:P.Z,QCardActions:T.Z}),Q()(b,"directives",{ClosePopup:z.Z})}}]);
"use strict";(globalThis["webpackChunkspieldose"]=globalThis["webpackChunkspieldose"]||[]).push([[451],{8417:(e,a,l)=>{l.r(a),l.d(a,{default:()=>k});l(2879);var t=l(9835),u=l(499),s=l(8339),r=l(1569),o=l(9302),n=l(6647),i=l(8330),v=l(7618),d=l(5919),c=l(8077),m=l(5226),b=l(8106);const p={class:"row q-gutter-xs q-mb-md"},g={class:"col-xl-2 col-lg-2 col-md-3 col-sm-4 col-xs-4"},y={class:"col"},h={class:"col-xl-1 col-lg-2 col-md-3 col-sm-4 col-xs-4"},f={class:"col-xl-1 col-lg-2 col-md-3 col-sm-4 col-xs-4"},q={__name:"BrowseAlbumsPage",setup(e){const a=(0,o.Z)(),{t:l}=(0,n.QT)(),q=(0,s.yj)(),x=(0,s.tv)(),I=(0,u.iH)(null),w=(0,u.iH)(q.query.text||null),A=[{label:"Title",value:"title"},{label:"Artist",value:"albumArtistName"},{label:"Title & Artist",value:"all"}],k=(0,u.iH)(A[0].value),P=[{label:"Title",value:"title"},{label:"Artist",value:"albumArtistName"},{label:"Year",value:"year"}],T=(0,u.iH)("totalTracks"==q.query.sortField?"totalTracks":"title"),E=(0,u.iH)("DESC"==q.query.sortOrder?"DESC":"ASC"),H=(0,u.iH)(!1),S=(0,u.iH)(!1),V=(0,u.iH)([]),C=(0,u.iH)(0),O=(0,u.iH)(0),_=(0,u.iH)(0),N=(0,u.iH)(parseInt(q.query.page||1));function Z(e,a,l,t,u){const s=Object.assign({},q.query||{});s.page=e||1,s.searchOn=a||"all",s.text=l||null,s.sortField=t||"title",s.sortOrder=u||"ASC",x.push({name:"albums",query:s})}function D(e){Z(e,k.value,w.value,T.value,E.value)}function F(){Z(1,k.value,w.value,T.value,E.value)}function M(e){Z(1,e,w.value,T.value,E.value)}function R(e){Z(N.value,k.value,w.value,e,E.value)}function U(e){Z(N.value,k.value,w.value,T.value,e)}function W(){H.value=!1,S.value=!0;const e={title:"title"==k.value?w.value:null,albumArtistName:"albumArtistName"==k.value?w.value:null,text:"all"==k.value?w.value:null};r.api.album.search(e,N.value,32,T.value,E.value).then((e=>{V.value=e.data.data.items.map((e=>(e.image=e.covers.small,e))),O.value=e.data.data.pager.totalPages,_.value=e.data.data.pager.totalResults,H.value=e.data.data.pager.totalResults<1,S.value=!1,C.value=Date.now(),(0,t.Y3)((()=>{I.value&&I.value.focus()}))})).catch((e=>{V.value=[],O.value=0,_.value=0,a.notify({type:"negative",message:l("API Error: error loading albums"),caption:l("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})}),S.value=!1,C.value=Date.now()}))}function j(e){b.up.play(e.mbId||null,e.title||null,e.artist?e.artist.mbId:null,e.artist?e.artist.name:null,e.year||null).then((e=>{})).catch((e=>{switch(e.response.status){default:a.notify({type:"negative",message:l("API Error: error playing album"),caption:l("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})});break}}))}function Y(e){b.up.enqueue(e.mbId||null,e.title||null,e.artist?e.artist.mbId:null,e.artist?e.artist.name:null,e.year||null).then((e=>{})).catch((e=>{switch(e.response.status){default:a.notify({type:"negative",message:l("API Error: error enqueueing album"),caption:l("API Error: fatal error details",{status:e.response.status,statusText:e.response.statusText})});break}}))}return x.beforeEach((async(e,a)=>{if("albums"==a.name){switch(N.value=parseInt(e.query.page||1),k.value=e.query.searchOn||A[0].value,w.value=e.query.text||null,E.value="DESC"==e.query.sortOrder?"DESC":"ASC",e.query.sortField){case"title":T.value=P[0].value;break;case"albumArtistName":T.value=P[1].value;break;case"year":T.value=P[2].value;break;default:T.value=P[0].value;break}"albums"!=e.name||e.query.page==a.query.page&&e.query.searchOn==a.query.searchOn&&e.query.text==a.query.text&&e.query.sortOrder==a.query.sortOrder&&e.query.sortField==a.query.sortField||(0,t.Y3)((()=>{W()}))}})),(0,t.bv)((()=>{W()})),(e,a)=>{const s=(0,t.up)("q-breadcrumbs-el");return(0,t.wg)(),(0,t.j4)(i.Z,{disable:S.value,currentPageIndex:N.value,totalPages:O.value,totalResults:_.value,onPaginationChanged:D},{breacrumb:(0,t.w5)((()=>[(0,t.Wm)(s,{icon:"person",label:(0,u.SU)(l)("Browse albums")},null,8,["label"])])),filter:(0,t.w5)((()=>[(0,t._)("div",p,[(0,t._)("div",g,[(0,t.Wm)(d.Z,{disable:S.value,label:"Search on",options:A,modelValue:k.value,"onUpdate:modelValue":[a[0]||(a[0]=e=>k.value=e),M]},null,8,["disable","modelValue"])]),(0,t._)("div",y,[(0,t.Wm)(v.Z,{disable:S.value,loading:S.value&&w.value?.length>0,hint:"Search albums with specified condition",placeholder:"Text condition",error:H.value&&w.value?.length>0,errorMessage:"No albums found with specified condition",modelValue:w.value,"onUpdate:modelValue":a[1]||(a[1]=e=>w.value=e),onSubmit:F,onClear:F,ref_key:"autoFocusRef",ref:I},null,8,["disable","loading","error","modelValue"])]),(0,t._)("div",h,[(0,t.Wm)(d.Z,{disable:S.value,label:"Sort field",options:P,modelValue:T.value,"onUpdate:modelValue":[a[2]||(a[2]=e=>T.value=e),R]},null,8,["disable","modelValue"])]),(0,t._)("div",f,[(0,t.Wm)(c.Z,{disable:S.value,modelValue:E.value,"onUpdate:modelValue":[a[3]||(a[3]=e=>E.value=e),U]},null,8,["disable","modelValue"])])])])),items:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(V.value,((e,a,l,u)=>{const s=[C.value];if(u&&u.key===e.hash&&(0,t.nQ)(u,s))return u;const r=((0,t.wg)(),(0,t.j4)(m.Z,{key:e.hash,image:e.image,title:e.title,albumMbId:e.mbId,artistMbId:e.artist.mbId,artistName:e.artist.name,year:e.year,onPlay:a=>j(e),onEnqueue:a=>Y(e)},null,8,["image","title","albumMbId","artistMbId","artistName","year","onPlay","onEnqueue"]));return r.memo=s,r}),a,4),128))])),_:1},8,["disable","currentPageIndex","totalPages","totalResults"])}}};var x=l(8052),I=l(9984),w=l.n(I);const A=q,k=A;w()(q,"components",{QBreadcrumbsEl:x.Z})}}]);
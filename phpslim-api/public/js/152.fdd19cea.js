"use strict";(globalThis["webpackChunkspieldose"]=globalThis["webpackChunkspieldose"]||[]).push([[152],{152:(l,e,a)=>{a.r(e),a.d(e,{default:()=>ml});a(2879);var s=a(9835),t=a(499),u=a(8339),o=a(1569),i=a(9302),r=a(6647),n=a(8330),c=a(7618),d=a(5919),v=a(8077),p=a(6970),y=a(1957),m=a(8442);const _={class:"row"},g={class:"col-4"},b=["src"],w={class:"col-4"},f=["src"],q={class:"col-4"},h=["src"],P={class:"row"},k={class:"col-4"},W=["src"],x={class:"col-4"},C=["src"],S={class:"col-4"},Z=["src"],H={class:"row"},V={class:"col-4"},D=["src"],I={class:"col-4"},Q=["src"],U={class:"col-4"},A=["src"],E={class:"row"},j={class:"col-12",style:{height:"100px"}},F=["src"],T="images/vinyl-small.png",B={__name:"BrowsePlaylistItem",props:["playlist","mode"],emits:["play","delete"],setup(l,{emit:e}){const a=(0,u.yj)(),{t:o}=(0,r.QT)(),i=l,n=e,c=(0,s.Fl)((()=>"mosaic"==i.mode));function d(){n("play",i.playlist.id)}function v(){n("delete",i.playlist.id)}function B(){const l="ABCDEF0123456789";let e="#";while(e.length<7)e+=l.charAt(Math.floor(16*Math.random()+1));return e}const M=(0,t.iH)(Object.assign({},a.query||{}));return M.value.userId=i.playlist.owner.id,M.value.type="userPlaylists",(e,a)=>{const u=(0,s.up)("q-card-section"),i=(0,s.up)("q-separator"),r=(0,s.up)("q-avatar"),n=(0,s.up)("q-btn"),O=(0,s.up)("q-btn-group"),z=(0,s.up)("router-link"),R=(0,s.up)("q-card");return(0,s.wg)(),(0,s.j4)(R,{class:"shadow-box shadow-10",bordered:""},{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,p.zw)("00000000-0000-0000-0000-000000000000"!=l.playlist.id?l.playlist.name:(0,t.SU)(o)("My favourite tracks")),1)])),_:1}),(0,s.Wm)(i),c.value?((0,s.wg)(),(0,s.j4)(u,{key:0,style:{width:"350px"}},{default:(0,s.w5)((()=>[(0,s._)("div",_,[(0,s._)("div",g,[(0,s._)("img",{class:"mosaic_cover_element",src:l.playlist.covers[0]||T},null,8,b)]),(0,s._)("div",w,[(0,s._)("img",{class:"mosaic_cover_element",src:l.playlist.covers[1]||T},null,8,f)]),(0,s._)("div",q,[(0,s._)("img",{class:"mosaic_cover_element",src:l.playlist.covers[2]||T},null,8,h)])]),(0,s._)("div",P,[(0,s._)("div",k,[(0,s._)("img",{class:"mosaic_cover_element",src:l.playlist.covers[3]||T},null,8,W)]),(0,s._)("div",x,[(0,s._)("img",{class:"mosaic_cover_element",src:l.playlist.covers[4]||T},null,8,C)]),(0,s._)("div",S,[(0,s._)("img",{class:"mosaic_cover_element",src:l.playlist.covers[5]||T},null,8,Z)])]),(0,s._)("div",H,[(0,s._)("div",V,[(0,s._)("img",{class:"mosaic_cover_element",src:l.playlist.covers[6]||T},null,8,D)]),(0,s._)("div",I,[(0,s._)("img",{class:"mosaic_cover_element",src:l.playlist.covers[7]||T},null,8,Q)]),(0,s._)("div",U,[(0,s._)("img",{class:"mosaic_cover_element",src:l.playlist.covers[8]||T},null,8,A)])])])),_:1})):((0,s.wg)(),(0,s.j4)(u,{key:1,style:{width:"350px",height:"140px"}},{default:(0,s.w5)((()=>[(0,s._)("div",E,[(0,s._)("div",j,[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)([5,4,3,2,1,0],((e,a)=>(0,s.Wm)(r,{key:e,size:"100px",class:"overlapping",style:(0,p.j5)(`left: ${49*a}px`)},{default:(0,s.w5)((()=>[l.playlist.covers[e]?((0,s.wg)(),(0,s.iD)("img",{key:0,src:l.playlist.covers[e],class:(0,p.C_)("mosaic_cover_element rotate-"+45*e)},null,10,F)):((0,s.wg)(),(0,s.iD)("div",{key:1,class:"no_cover",style:(0,p.j5)("background: "+B())},null,4))])),_:2},1032,["style"]))),64))])])])),_:1})),(0,s.Wm)(i),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(O,{spread:"",outline:""},{default:(0,s.w5)((()=>[(0,s.Wm)(n,{label:(0,t.SU)(o)("Play"),stack:"",icon:"play_arrow",onClick:(0,y.iM)(d,["prevent"])},null,8,["label"]),(0,s.Wm)(n,{label:(0,t.SU)(o)("Remove"),stack:"",icon:"delete",onClick:(0,y.iM)(v,["prevent"]),disable:!l.playlist.allowDelete},null,8,["label","disable"])])),_:1})])),_:1}),(0,s.Wm)(i),(0,s.Wm)(u,{class:"text-right"},{default:(0,s.w5)((()=>[(0,s._)("span",null,(0,p.zw)(l.playlist.trackCount)+" "+(0,p.zw)((0,t.SU)(o)(l.playlist.trackCount>1?"tracks":"track")),1),(0,s.Uk)(" "+(0,p.zw)((0,t.SU)(o)("by"))+" ",1),(0,s.Wm)(z,{to:{name:"playlists",query:M.value}},{default:(0,s.w5)((()=>[(0,s.Uk)((0,p.zw)(l.playlist.owner.name),1)])),_:1},8,["to"]),(0,s.Wm)(m.Z,{className:"q-ml-xs",timestamp:1e3*l.playlist.updated},null,8,["timestamp"])])),_:1})])),_:1})}}};var M=a(4458),O=a(3190),z=a(926),R=a(1357),Y=a(7236),N=a(8879),K=a(9984),G=a.n(K);const L=B,$=L;G()(B,"components",{QCard:M.Z,QCardSection:O.Z,QSeparator:z.Z,QAvatar:R.Z,QBtnGroup:Y.Z,QBtn:N.Z});var J=a(8106),X=a(5090),ll=a(4867);const el={class:"row q-gutter-xs q-mb-md"},al={class:"col"},sl={class:"col-xl-2 col-lg-2 col-md-3 col-sm-4 col-xs-4"},tl={class:"col-xl-1 col-lg-2 col-md-3 col-sm-4 col-xs-4"},ul={class:"col-xl-1 col-lg-2 col-md-3 col-sm-4 col-xs-4"},ol={class:"col-xl-1 col-lg-2 col-md-3 col-sm-4 col-xs-4"},il=(0,s._)("span",{class:"q-ml-sm"},"Delete playlist",-1),rl=(0,s._)("p",null,"Are you sure ?",-1),nl={__name:"BrowsePlaylistsPage",setup(l){const e=(0,i.Z)(),{t:a}=(0,r.QT)(),p=(0,u.yj)(),y=(0,u.tv)(),m=(0,X.H)(),_=(0,t.iH)(null),g=(0,t.iH)(p.query.name||null),b=[{label:"All playlists",value:"allPlaylists",disable:!1},{label:"My playlists",value:"myPlaylists",disable:!1},{label:"User playlists",value:"userPlaylists",disable:!0}],w=[{label:"Name",value:"name"},{label:"Last update",value:"updated"}],f=[{label:"Mosaic",value:"mosaic"},{label:"Vinyls",value:"vinyls"}];let q=null;q=p.query.userId?b[2].value:p.query.type&&b.find((l=>l.value==p.query.type))?p.query.type:b[0].value;const h=(0,t.iH)(q),P=(0,t.iH)("userPlaylists"==q&&p.query.userId||null),k=(0,t.iH)("updated"==p.query.sortField?"updated":"name"),W=(0,t.iH)("DESC"==p.query.sortOrder?"DESC":"ASC"),x=(0,t.iH)("vinyls"==p.query.style?"vinyls":"mosaic"),C=(0,t.iH)(!1),S=(0,t.iH)(!1),Z=(0,t.iH)([]),H=(0,t.iH)(0),V=(0,t.iH)(0),D=(0,t.iH)(0),I=(0,t.iH)(parseInt(p.query.page||1));function Q(l,e,a,s,t){const u=Object.assign({},p.query||{});u.page=l||1,u.type=e||"allPlaylists",u.userId="userPlaylists"==u.type&&P.value||null,u.name=a||null,u.sortField=s||"title",u.sortOrder=t||"ASC",u.style=f["vinyls"==x.value?1:0].value,y.push({name:"playlists",query:u})}function U(l){Q(l,h.value,g.value,k.value,W.value)}function A(){Q(1,h.value,g.value,k.value,W.value)}function E(l){Q(1,l,g.value,k.value,W.value)}function j(l){Q(I.value,h.value,g.value,l,W.value)}function F(l){Q(I.value,h.value,g.value,k.value,l)}function T(l){Q(I.value,h.value,g.value,k.value,W.value)}y.beforeEach((async(l,e)=>{"playlists"==e.name&&(I.value=parseInt(l.query.page||1),h.value=l.query.type||b[0].value,P.value="userPlaylists"==h.value&&l.query.userId||null,g.value=l.query.name||null,W.value="DESC"==l.query.sortOrder?"DESC":"ASC",k.value=w["updated"==l.query.sortField?1:0].value,x.value=f["vinyls"==l.query.style?1:0].value,"playlists"!=l.name||l.query.page==e.query.page&&l.query.type==e.query.type&&l.query.userId==e.query.userId&&l.query.name==e.query.name&&l.query.sortOrder==e.query.sortOrder&&l.query.sortField==e.query.sortField||(0,s.Y3)((()=>{O()})))}));const B=(0,t.iH)(!1),M=(0,t.iH)(null);function O(){C.value=!1,S.value=!0,S.value=!0,o.api.playlist.search({name:g.value,userId:P.value,type:h.value},I.value,32,k.value,W.value).then((l=>{Z.value=l.data.data.items,V.value=l.data.data.pager.totalPages,D.value=l.data.data.pager.totalResults,C.value=l.data.data.pager.totalResults<1,S.value=!1,H.value=Date.now(),(0,s.Y3)((()=>{_.value&&_.value.focus()}))})).catch((l=>{Z.value=[],V.value=0,D.value=0,e.notify({type:"negative",message:"API Error: error loading playlists",caption:a("API Error: fatal error details",{status:l.response.status,statusText:l.response.statusText})}),S.value=!1,H.value=Date.now()}))}function z(l){m.interact(),J.oS.play(l).then((l=>{})).catch((l=>{e.notify({type:"negative",message:a("API Error: error loading playlist"),caption:a("API Error: fatal error details",{status:l.response.status,statusText:l.response.statusText})})}))}function R(l){B.value=!0,M.value=l}function Y(){S.value=!0,o.api.playlist.delete(M.value).then((l=>{S.value=!1,B.value=!1,M.value=null,m.data.currentPlaylist.playlist=null,e.notify({type:"positive",message:"Playlist deleted"}),S.value=!1,O(!0)})).catch((l=>{S.value=!1}))}const N=(0,s.f3)("bus");return N.on(ll.spieldoseEventNames.track.setFavorite,(l=>{O(!0)})),N.on(ll.spieldoseEventNames.track.unSetFavorite,(l=>{O(!0)})),(0,s.bv)((()=>{O()})),(l,e)=>{const u=(0,s.up)("q-breadcrumbs-el"),o=(0,s.up)("q-avatar"),i=(0,s.up)("q-card-section"),r=(0,s.up)("q-btn"),p=(0,s.up)("q-card-actions"),y=(0,s.up)("q-card"),m=(0,s.up)("q-dialog"),q=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(n.Z,{disable:S.value,currentPageIndex:I.value,totalPages:V.value,totalResults:D.value,onPaginationChanged:U},{breacrumb:(0,s.w5)((()=>[(0,s.Wm)(u,{icon:"person",label:(0,t.SU)(a)("Browse playlists")},null,8,["label"])])),filter:(0,s.w5)((()=>[(0,s._)("div",el,[(0,s._)("div",al,[(0,s.Wm)(c.Z,{disable:S.value,loading:S.value&&g.value?.length>0,hint:"Search playlists with specified condition",placeholder:"Text condition",error:C.value&&g.value?.length>0,errorMessage:"No playlists found with specified condition",modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=l=>g.value=l),onSubmit:A,onClear:A,ref_key:"autoFocusRef",ref:_},null,8,["disable","loading","error","modelValue"])]),(0,s._)("div",sl,[(0,s.Wm)(d.Z,{disable:S.value,label:"Playlist type",options:b,modelValue:h.value,"onUpdate:modelValue":[e[1]||(e[1]=l=>h.value=l),E]},null,8,["disable","modelValue"])]),(0,s._)("div",tl,[(0,s.Wm)(d.Z,{disable:S.value,label:"Sort field",options:w,modelValue:k.value,"onUpdate:modelValue":[e[2]||(e[2]=l=>k.value=l),j]},null,8,["disable","modelValue"])]),(0,s._)("div",ul,[(0,s.Wm)(v.Z,{disable:S.value,modelValue:W.value,"onUpdate:modelValue":[e[3]||(e[3]=l=>W.value=l),F]},null,8,["disable","modelValue"])]),(0,s._)("div",ol,[(0,s.Wm)(d.Z,{disable:S.value,label:"Playlist style",options:f,modelValue:x.value,"onUpdate:modelValue":[e[4]||(e[4]=l=>x.value=l),T]},null,8,["disable","modelValue"])])])])),items:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(Z.value,(l=>((0,s.wg)(),(0,s.j4)($,{key:l.id,playlist:l,mode:x.value,onPlay:e=>z(l.id),onDelete:e=>R(l.id)},null,8,["playlist","mode","onPlay","onDelete"])))),128))])),_:1},8,["disable","currentPageIndex","totalPages","totalResults"]),(0,s.Wm)(m,{modelValue:B.value,"onUpdate:modelValue":e[5]||(e[5]=l=>B.value=l),persistent:""},{default:(0,s.w5)((()=>[(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{class:"row items-center"},{default:(0,s.w5)((()=>[(0,s.Wm)(o,{icon:"info"}),il])),_:1}),(0,s.Wm)(i,null,{default:(0,s.w5)((()=>[rl])),_:1}),(0,s.Wm)(p,{align:"right"},{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(r,{flat:"",label:"Cancel",color:"primary"},null,512),[[q]]),(0,s.Wm)(r,{flat:"",label:"YES",color:"primary",onClick:Y})])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}}};var cl=a(8052),dl=a(7743),vl=a(1821),pl=a(2146);const yl=nl,ml=yl;G()(nl,"components",{QBreadcrumbsEl:cl.Z,QDialog:dl.Z,QCard:M.Z,QCardSection:O.Z,QAvatar:R.Z,QCardActions:vl.Z,QBtn:N.Z}),G()(nl,"directives",{ClosePopup:pl.Z})}}]);